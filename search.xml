<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CAN总线学习——底层逻辑</title>
    <url>/2023/08/08/CAN%E6%80%BB%E7%BA%BF%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%BA%95%E5%B1%82%E9%80%BB%E8%BE%91/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>记录学习CAN的历程，主要是CAN的底层逻辑。</p>
<p>highly
comment直接看References中的文章，在此仅作回顾总结，并就其中一些内容进行修改和补充(见Tips和Bonus)。</p>
<p>感谢CAN总线学习笔记系列，让人受益匪浅。</p>
<p>下一步学习CAN上层应用主要书CAN过滤器和API的使用</p>
<span id="more"></span>
<h1 id="can基础知识">CAN基础知识</h1>
<h3 id="can的一些基本概念">CAN的一些基本概念</h3>
<p>CAN(controller area
network)是串行通信协议；CAN总线就是一种传输数据的线</p>
<ul>
<li>高速CAN通信标准，闭环总线</li>
<li>低俗CAN通信标准，开环总线</li>
</ul>
<blockquote>
<p>Tips:总线传输速率：位速率or比特率</p>
</blockquote>
<h3 id="can的拓扑结构">CAN的拓扑结构</h3>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230807000301535.png" alt="image-20230807000301535">
<figcaption aria-hidden="true">image-20230807000301535</figcaption>
</figure>
<h3 id="can信号表示">CAN信号表示</h3>
<p>CAN总线上，利用CAN_H and
CAN_L两根线的电位差来表示CAN信号，显性电平（逻辑0），隐性电平（逻辑1）</p>
<h3 id="can信号传输">CAN信号传输</h3>
<ul>
<li>发送方是总线电平发生变化</li>
<li>接收方监听总线电平，读入自己的接收器</li>
</ul>
<h1 id="can通信的特点">CAN通信的特点</h1>
<h3 id="多主工作方式">多主工作方式</h3>
<p>结点无主从之分，只要总线空闲则均可发消息，最先发消息的结点获得总线的发送权（一起发则看优先权）</p>
<blockquote>
<p>Tips:&lt;总线空闲状态&gt;：连续的11位隐性电平（结合CAN协议的帧结构）</p>
</blockquote>
<h3 id="非破坏性位仲裁机制">非破坏性位仲裁机制</h3>
<p>一起发消息的节点会进行逐位仲裁，不会造成已发送数据的延迟，也不会破坏已经发送的数据</p>
<h3 id="系统的柔性">系统的柔性</h3>
<p>节点无“地址”概念，因此增加节点对已有节点的软硬件及应用层造成影响</p>
<h3 id="通信速度">通信速度</h3>
<p>同一条CAN线，节点通信速度必须相同，如果两条不同通信速度总线上的节点想要实现信息交互，必须通过网关</p>
<blockquote>
<p>Tips:网关实质上是<strong>一个网络通向其他网络的IP地址</strong>。</p>
</blockquote>
<h3 id="数据传输方式">数据传输方式</h3>
<p>可实现一对一，一对多以及广播的数据传输方式，依赖于验收滤波技术</p>
<h3 id="远程数据请求">远程数据请求</h3>
<p>Node_A可以通过发送“遥控帧”到总线上来请求Node_B发送由该遥控帧所指定的报文</p>
<h3 id="错误检测错误通知错误恢复functions">错误检测、错误通知、错误恢复functions</h3>
<ul>
<li>所有nodes都可以检测出错误（错误检测）</li>
<li>检测出错误的node会立即通知总线上其它nodes(错误通知)</li>
<li>正在发送消息的节点，if检测到错误，会立即停止当前的发送，并待总线空闲时不断重复发送此消息，知道改消息发送成功为止(错误恢复)</li>
</ul>
<h3 id="故障封闭">故障封闭</h3>
<p>node能够判断错误的类型：暂时性地数据错误（如噪声干扰）还是持续性地数据错误（如节点内部故障），如果判断时严重的持续性错误，节点就会切断自己与总线地练习，避免影响其他nodes</p>
<h1 id="can通信网络结构">CAN通信网络结构</h1>
<p>理解每个结构中的作用就理解了CAN</p>
<h3 id="osi基本参照模型">OSI基本参照模型</h3>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230807003930039.png" alt="image-20230807003930039">
<figcaption aria-hidden="true">image-20230807003930039</figcaption>
</figure>
<h3 id="can协议网络层次">CAN协议网络层次</h3>
<p>ISO标准只对数据链路层和物理层做了规定</p>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230807004043599.png" alt="image-20230807004043599">
<figcaption aria-hidden="true">image-20230807004043599</figcaption>
</figure>
<h1 id="can协议中的帧">CAN协议中的帧</h1>
<p>CAN中有5中帧结构</p>
<ul>
<li>数据帧：用于通讯节点向外传送数据。</li>
<li>遥控帧：用于向远端节点请求数据。</li>
<li>错误帧：用于向远端节点通知校验错误，请求重新发送上一个数据。</li>
<li>过载帧：用于通知远端节点：本节点尚未做好接受准备。</li>
<li>间隔帧：用于将数据帧及遥控帧与前面的帧分离开来的帧</li>
</ul>
<h2 id="数据帧与遥控帧">数据帧与遥控帧</h2>
<ul>
<li>数据帧：包含我们要传输的数据的帧，承载发送节点要传递的数据</li>
<li>遥控帧：请求其它节点发出与本遥控帧具有相同ID号的数据帧</li>
</ul>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230807180622274.png" alt="image-20230807180622274">
<figcaption aria-hidden="true">image-20230807180622274</figcaption>
</figure>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230807180646925.png" alt="image-20230807180646925">
<figcaption aria-hidden="true">image-20230807180646925</figcaption>
</figure>
<p>遥控帧相比于数据帧缺少数据段，且遥控帧RTR位恒为隐性1，数据帧RTR位恒为显性0</p>
<blockquote>
<p>Tips:数据帧和遥控帧都分为标准帧（CAN2.0A）和扩展帧（CAN2.0B）</p>
</blockquote>
<h4 id="帧起始">帧起始</h4>
<p>帧的最开始一位是帧起始，SOF(start of frame)，恒为显性0</p>
<p>即CAN_H and CAN_L有电位差就表示SOF，总线上开始有报文了</p>
<h4 id="仲裁段">仲裁段</h4>
<p>判定报文优先级，ID号也是实现报文过滤机制的基础</p>
<p>数据帧仲裁段：</p>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230807181639943.png" alt="image-20230807181639943">
<figcaption aria-hidden="true">image-20230807181639943</figcaption>
</figure>
<p>遥控帧仲裁段：</p>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230807181705793.png" alt="image-20230807181705793">
<figcaption aria-hidden="true">image-20230807181705793</figcaption>
</figure>
<p>遥控帧RTR位恒为隐性1，数据帧RTR位恒为显性0</p>
<h4 id="仲裁过程">仲裁过程</h4>
<ul>
<li><strong>回读机制：</strong>节点在向总线上发送报文的过程中，同时也对总线上的二进制位进行“回读”。通过这种机制，节点就可以判断出本节点发出的二进制位与总线上当前的二进制位是否一致。<br>
</li>
<li><strong>线与机制：</strong>在总线上，显性位0能够覆盖隐性位1。</li>
</ul>
<p>当两个节点同时发送消息时会进行逐位仲裁直至分出胜负</p>
<ul>
<li><p>在Node_A获取总线的发送权之后，Node_A接着发送自己的Msg_A，因此在竞争总线的过程中不会对Msg_A的传输造成延时；</p></li>
<li><p>在两个节点竞争总线的过程中，不会破坏Msg_A;</p></li>
</ul>
<h4 id="仲裁段中的rtrsrr和ide位">仲裁段中的RTR，SRR和IDE位</h4>
<ul>
<li><p>RTR位：Tranmission Request Bit
（远程发送请求位）。在数据帧中，RTR位恒为显性位0，在遥控帧中，恒为隐性1。</p>
<p>在ID号相同的情况下， 保证数据帧优先级高于遥控帧</p></li>
<li><p>SRR位：Substitutes for Remote Requests
Bit（替代远程请求位），在扩展帧（数据帧或遥控帧）中，SRR恒为隐性位1，并且可以发现，扩展帧的隐性SRR位正好对应标准帧的显性RTR位，所以</p>
<p>在前11位ID号相同的情况下，保证标准数据帧的优先级高于扩展数据帧；</p></li>
<li><p>IDE位：Identifier Extension
Bit（标识符扩展位）。在扩展帧中恒为隐性1，在标准帧中，IDE位于控制段，且恒为显性0。且扩展帧IDE位和标准帧IDE位位置对应</p>
<p>在前11位ID号相同的情况下，保证标准遥控帧的优先级一定高于扩展遥控帧。</p></li>
</ul>
<h4 id="报文过滤">报文过滤</h4>
<p>在CAN总线中没有地址的概念，CAN总线是通过报文ID来实现收发数据的。CAN节点上都会有一个验收滤波ID表，其位于CAN节点的验收滤波器中，如果总线上的报文的ID号在某个节点的验收滤波ID表中，那么这一帧报文就能通过该节点验收滤波器的验收，该节点就会接收这一帧报文。</p>
<p>比如：Node_A发送了一帧ID号为ID_1的报文Msg_1，Node_B的验收滤波ID表中恰好有ID_1，于是乎Msg_1就会被Node_B接收。</p>
<p>报文过滤机制体现了CAN通信的两条特点：</p>
<ol type="1">
<li><p>一对一、组播和广播</p></li>
<li><p>系统的柔性：正是因为CAN总线上收发报文是基于报文ID实现的，所以总线上添加节点时不会对总线上已有的节点造成影响。</p></li>
</ol>
<h4 id="控制段">控制段</h4>
<p>数据帧和遥控帧的控制段结构相同：</p>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230807195944269.png" alt="image-20230807195944269">
<figcaption aria-hidden="true">image-20230807195944269</figcaption>
</figure>
<p>4位的DLC（DLC3、DLC2、DLC1、DLC0）代表<strong>数据长度</strong>，指示了数据段中的字节数。对于没有数据段的遥控帧，DLC表示该遥控帧对应的数据帧的数据段的字节数</p>
<h4 id="数据段">数据段</h4>
<p>数据段可以包含0~8个字节的数据，从MSB（最高位）开始输出。</p>
<h4 id="crc段">CRC段</h4>
<p>CRC校验序列是根据多项式生成的CRC值，其计算范围包括：帧起始、仲裁段、控制段和数据段。</p>
<p>CRC界定符恒为隐性1</p>
<h4 id="ack段">ACK段</h4>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230807200359857.png" alt="image-20230807200359857">
<figcaption aria-hidden="true">image-20230807200359857</figcaption>
</figure>
<ul>
<li><p>发送节点在ACK段发送两个隐性位，即发送方发出的报文中ACK槽为隐性1</p></li>
<li><p>接收节点在接收到正确的报文之后会在ACK槽发送显性位0（在ACK槽中填充显性位0使总线电平变为显性0），通知发送节点正常接收结束。</p></li>
</ul>
<h4 id="帧结束">帧结束</h4>
<p>帧结束段表示该帧报文的结束，由7个隐性位构成。</p>
<h2 id="错误帧">错误帧</h2>
<p>在发送和接收报文时，Nodes如果检测出错误则会发送错误帧，通知其他节点，自己出错了</p>
<h3 id="错误帧的帧结构">错误帧的帧结构</h3>
<p>错误帧 = 错误标志+错误界定符</p>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230807222925553.png" alt="image-20230807222925553">
<figcaption aria-hidden="true">image-20230807222925553</figcaption>
</figure>
<ul>
<li>主动错误标志：6个连续的显性位</li>
<li>被动错误标志：6个连续的隐性位</li>
<li>错误界定符：8个连续的隐性位</li>
</ul>
<h3 id="错误检测">错误检测</h3>
<h4 id="位填充原则">位填充原则</h4>
<p>CAN协议中规定，当相同极性的电平持续五位时，则添加一个极性相反的位（接收时自动删除下一位）——均由Nodes完成</p>
<p>位填充的作用域：SOF--CRC(除去CRC界定符)之间的位流</p>
<h4 id="错误的种类">错误的种类</h4>
<p>共有五种错误</p>
<ul>
<li><p>位错误 (Bit Check Error)：自己发出的和回读的不一致</p>
<blockquote>
<p>Tips:有三种例外不是位错误</p>
<ul>
<li>在仲裁区，节点向bus发送隐性位却读到显性，表示该节点仲裁失败</li>
<li>在ACK槽，表示有节点正确接收</li>
<li>该节点发送被动错误标志（发送6个连续的隐性位），可能被其他节点发送的显性电平“吃掉”了</li>
</ul>
</blockquote></li>
<li><p>ACK错误 (Acknowledge
Error)：节点在ACK槽没有回读到显性位，即没有节点正确接收。产生ACK应答错误</p></li>
<li><p>填充错误 (FIll
Error)：在位填充作用域中检测到连续六个同性位</p></li>
<li><p>CRC错误 (CRC
Error)：节点发送和接收时都会计算CRC序列，不一致检测为CRC Error</p></li>
<li><p>格式错误：在一帧报文发送时，如果在必须发送预定值的区域内检测到了非法值，那么就检测到了一个格式错误</p>
<blockquote>
<p>Tips:CAN报文中，有预定值的区域：</p>
<ul>
<li>数据帧和遥控帧的CRC界定符、ACK界定符、EOF</li>
<li>错误帧界定符</li>
<li>过载帧界定符</li>
</ul>
</blockquote></li>
</ul>
<h3 id="错误通知">错误通知</h3>
<h4 id="节点错误状态">节点错误状态</h4>
<ul>
<li><p>主动错误状态（有说服力，较可靠）：可以正常通信；在检测到错误时，发出带有主动错误标志的错误帧（6个连续的显性位），会“覆盖”总线上其它节点的发送，于是正在发送的报文就被破坏掉了</p>
<blockquote>
<p>大家都相信主动错误状态的节点，“我发现错误了，你们收到的不算数”</p>
</blockquote></li>
<li><p>被动错误状态（无说服力）：可以正常通信；在检测到错误时，发出带有被动错误标志的错误帧（6个连续的隐性位），所以这个时候总线上正在传输的报文位流不会受到该被动错误帧的影响
，没人搭理。</p>
<p>如果发出被动错误帧的节点Node_A为报文的发送节点，那么在发送被动错误帧之后，刚刚正在发送的报文被破坏，并且Node_A不能在错误帧之后随着连续发送刚刚发送失败的那个报文。随之而来的是帧间隔，并且连带着8位隐性住的
“延迟传送”
段（即暂停段，见帧间隔）；这样总线电平就呈现出连续11位隐性位，总线上的其它节点就能判定总线处于空闲状态，就能参与总线竞争。此时如果Node_A能够竞争成功，那么它就能接着发送，如果竞争不能成功，那么就接着等待下一次竞争。这种机制的目的正是为了<strong>让其它正常节点
(处于主动错误) 优先使用总线</strong></p>
<blockquote>
<p>Tips:
处于被动错误状态，说明这个节点目前是不太可靠的，出现错误的原因可能是它本身的问题，即刚刚检测到的错误可能仅仅只有它自己遇到，正是因为这一点，整个总线才不信任它报告的错误，从而只允许它发送六个连续的隐性位，这样它才不会拖累别人</p>
</blockquote></li>
<li><p>总关闭状态：整个节点脱离总线。等到检测到128次11个连续的隐性位时，TEC和REC置0，重新回到主动错误状态（冷静一段时间）</p></li>
</ul>
<h4 id="错误状态的转换">错误状态的转换</h4>
<p>CAN节点内，有两个计数器：<strong>发送错误计数器（TEC）and
接受错误计数器（REC）</strong></p>
<blockquote>
<p>Tips:计数器的变化有个表格规定，而不是错一次+1</p>
</blockquote>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808104018271.png" alt="image-20230808104018271">
<figcaption aria-hidden="true">image-20230808104018271</figcaption>
</figure>
<p>节点错误状态的转换就是一个量变到质变的过程</p>
<h3 id="错误帧的发送">错误帧的发送</h3>
<ul>
<li><p>位错误、填充错误、格式错误、ACK措误在错误产生的那一位的下一位开始发送错误帧。</p></li>
<li><p>CRC错误：紧随ACK界定符后的位发送错误帧。</p></li>
</ul>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808105739885.png" alt="image-20230808105739885">
<figcaption aria-hidden="true">image-20230808105739885</figcaption>
</figure>
<h2 id="过载帧">过载帧</h2>
<p>过载帧是接收节点向总线上其它节点报告自身接收能力达到极限的帧（我已经没有能力来处理你们发来的报文了）</p>
<p>过载帧包括：过载标志+过载界定符</p>
<ul>
<li><p>过载标志：连续6个显性位；</p></li>
<li><p>过载界定符：连续8个隐性位；</p></li>
<li><p>与错误帧类似，过载帧中有过载帧重整部分，且形成过载重叠标志的原因与形成措误帧中的错误重慢标志的原因是相同的</p></li>
</ul>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808110424756.png" alt="image-20230808110424756">
<figcaption aria-hidden="true">image-20230808110424756</figcaption>
</figure>
<blockquote>
<p>Tips:接收节点Node_A达到接收极限时，就会发出过载帧到总线上，显然，过载标志的6个连续显性位会屏蔽掉总线上其它节点的发送，也就是说这个时候Node_A通过发送过载帧的方式来破坏其它节点的发送，这样在Node_A发送过载帧期间，其它节点就不能成功发送报文，于是就相当于把其它节点的发送推迟了，也就是说Node_A在其发送过载帧的这段时间得以<strong>“休息”</strong>。</p>
</blockquote>
<p>有三种情况会引起过载帧：</p>
<ul>
<li><p>接收节点自身原因。接收节点由于某种原因需要延迟接收下一个数据帧或者遥控帧。</p></li>
<li><p>在帧间隔的间歇段的第一位和第二位检测到一个显性位（正常的间歇段都是隐性位）</p>
<p>帧间隔的间隔段本应是三个连续的隐性位，如果接收节点Node_A在间隔段检测到显性位，那么就意味着此时有报文发向接收节点Node_A,
但这个时候是不应该有报文发来的，于是Node_A发送过载帧。</p></li>
<li><p>CAN节点在错误界定符或过载界定符的第八位（最后一位）听到一个显性位0,
节点会发送一个过载帧，且错误计数器不会增加。</p>
<p>接收节点Node_A在错误界定符和过载界定符的最后一位听到显性位，也意味着有报文发向Node_A,
但这个时候是不应该有报文发来的，于是Node_A发送过载帧。</p></li>
</ul>
<h2 id="帧间隔">帧间隔</h2>
<p>帧间隔是用来隔离数据帧（或者遥控帧）的，也就是说，数据帧（或者遥控帧）通过插入帧间隔可以将本帧与先行帧（数据帧、遥控帧、错误帧、过载帧）分隔开来。</p>
<blockquote>
<p>Tips: 过载帧和错误帧的前面不能插入帧间隔。</p>
</blockquote>
<p>帧间隔有两种不同的状态：</p>
<p>主动错误状态的帧间隔： <img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808111701098.png" alt="image-20230808111701098"></p>
<p>被动错误状态的帧间隔：</p>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808111723987.png" alt="image-20230808111723987">
<figcaption aria-hidden="true">image-20230808111723987</figcaption>
</figure>
<ul>
<li><p>间隔段：连续三个隐性位；间隔段期间，所有节点不允许发送数据这或遥控帧，只要在这期间监听到显性位，接收节点就会发送过载帧。</p></li>
<li><p>空闲段：连续隐性位，个数不一定，个或者多个都可以。总线空闲的时间是任意长的，只要总线空闲，节点就可以竞争总线。</p></li>
<li><p>暂停段：只有处于被动错误状态的节点在发送帧间隔的时候，才会在帧间隔中插入8个连续隐性位的暂停段。</p>
<p>暂停段，又叫做延迟传送段，为什么节点处于被动状态时会有这样一段呢？原因如下：首先，考虑主动错误状态的节点Node_A,
发送主动错误标志之后，随之就要重新发送刚刚发送失败的报文，但是为了间隔开与前面刚刚发送的错误帧，总线在错误帧之后就会插入3个隐形位的帧间隔，在这3个隐形位期间，其它的节点不足以判定总线空闲（需要连续11个隐性位才能判定），所以Node_A仍然占据着总线的控制权，于是在帧间隔之后，Node_A能够接着发送报文。现在Node_A转入到被动错误状态了，说明它已经不是很可靠了，这个时候如果没有延迟传送段，在Node_A发出被动错误标志之后，它仍然能够在3位的帧间隔之后立即重新发送报文，这是不符合我们对被动错误状态的处理要求的当然也是不符合CAN协议的，于是乎对于发送出被动错误标志的节点，总线在帧间隔中加入了8
个连续隐性位的延迟传送段，这样的3+8=11个连续隐性位。<strong>就能让Node_A在这个帧间隔期间失去对总线的控制权，从而优先保证其它正常（处于主动错误状态）节点能够使用总线，而不必等着一个已经不可靠的Node_A占据总线。</strong></p></li>
</ul>
<h1 id="can通信的位定时与同步">CAN通信的位定时与同步</h1>
<h2 id="位定位">位定位</h2>
<p>CAN总线是两项调制，即此时数值上波特率和比特率（见Bonus）是一样的。</p>
<h3 id="位时间">位时间</h3>
<h4 id="位时间的基本概念">位时间的基本概念</h4>
<p>表示一个二进制位在总线上传输时所需要的时间。 <span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -2.059ex;" xmlns="http://www.w3.org/2000/svg" width="17.587ex" height="5.095ex" role="img" focusable="false" viewBox="0 -1342 7773.6 2252"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">速</text></g><g data-mml-node="mi" transform="translate(2000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">率</text></g><g data-mml-node="mo" transform="translate(3277.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(4333.6,0)"><g data-mml-node="mn" transform="translate(1470,676)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mrow" transform="translate(220,-710)"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">时</text></g><g data-mml-node="mi" transform="translate(2000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">间</text></g></g><rect width="3200" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></span> CAN总线中的两个时钟：晶振时钟周期+CAN时钟周期</p>
<ul>
<li><p>晶振时钟周期：是由单片机振荡器的晶振频率决定的，指的是振荡器每震荡一次所消耗的时间长度，也是整个系统中最小的时间单位。</p></li>
<li><p>CAN时钟周期：CAN时钟是由系统时钟分频而来的一个时间长度值，实际上就是一个时间份额Tq。
<span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.452ex;" xmlns="http://www.w3.org/2000/svg" width="40.852ex" height="2.149ex" role="img" focusable="false" viewBox="0 -750 18056.6 950"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mi" transform="translate(760,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(1510,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mi" transform="translate(2398,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">时</text></g><g data-mml-node="mi" transform="translate(3398,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">钟</text></g><g data-mml-node="mi" transform="translate(4398,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">周</text></g><g data-mml-node="mi" transform="translate(5398,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">期</text></g><g data-mml-node="mo" transform="translate(6675.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(7731.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(8231.6,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(9009.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">晶</text></g><g data-mml-node="mi" transform="translate(10009.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">振</text></g><g data-mml-node="mi" transform="translate(11009.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">时</text></g><g data-mml-node="mi" transform="translate(12009.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">钟</text></g><g data-mml-node="mi" transform="translate(13009.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">周</text></g><g data-mml-node="mi" transform="translate(14009.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">期</text></g><g data-mml-node="mi" transform="translate(15009.6,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(15787.6,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(16546.6,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mi" transform="translate(17305.6,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g></g></g></svg></mjx-container></span></p>
<blockquote>
<p>BRP即波特率预分频值（baudrate
prescaler）:它的作用是将晶振频率进行预分频，以满足CAN总线波特率的要求。
在CAN协议中，BRP的取值范围是<strong>1~64</strong>，它决定了一个时间单元（Time
Quantum，Tq）的长度。</p>
</blockquote></li>
</ul>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808135508935.png" alt="image-20230808135508935">
<figcaption aria-hidden="true">image-20230808135508935</figcaption>
</figure>
<h4 id="位时间的分段">位时间的分段</h4>
<p>在CAN的位定时中，一个CAN时钟周期称为一个时间量子一Tq（Time
Quantum）</p>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808135931239.png" alt="image-20230808135931239">
<figcaption aria-hidden="true">image-20230808135931239</figcaption>
</figure>
<ul>
<li>同步段 (Synchronization Segment) :
<ul>
<li>长度固定，1个时间量子Tq；</li>
<li>一个位的传输从同步段开始；</li>
<li>同步段用于同步总线上的各个节点，一个位的跳边沿在此时间段内。</li>
</ul></li>
<li>传播段 (Propagation Segment)：
<ul>
<li>传播段用于补偿报文在总线和节点上传输时所产生的时间延迟；</li>
<li>传播段时长<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.312ex;" xmlns="http://www.w3.org/2000/svg" width="5.28ex" height="1.819ex" role="img" focusable="false" viewBox="0 -666 2333.8 804"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="mn" transform="translate(1055.8,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(1555.8,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g></g></g></svg></mjx-container></span>报文在总线和节点上传输时产生的时间延迟；</li>
<li>传播段时长可编程 (1~8个时间量子Tq)。</li>
</ul></li>
<li>相位缓冲段1 (Phase Buffer Segment)：
<ul>
<li>用于补偿节点间的晶振误差；</li>
<li>允许通过重同步对该段加长；</li>
<li>在这个时间段的末端进行总线状态的采样；</li>
<li>长度可编程 (1~8个时间量子Tq)。</li>
</ul></li>
<li>相位冲段2 (Phase Buffer Segment2) :
<ul>
<li>用于补偿节点间的晶振误差；</li>
<li>允许通过重同步对该段缩短；</li>
<li>长度可编程 (1~8个时间量子Tq)。</li>
</ul></li>
</ul>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="36.803ex" height="1.781ex" role="img" focusable="false" viewBox="0 -705 16266.9 787"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(361,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(1120,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1465,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(2103.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(3159.6,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(3520.6,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(4165.6,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mo" transform="translate(5032.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(6033,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(6394,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(7145,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mo" transform="translate(8012.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(9012.4,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(9373.4,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(10124.4,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(10883.4,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(11528.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(12250.7,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(13250.9,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(13611.9,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(14362.9,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(15121.9,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(15766.9,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></svg></mjx-container></span></p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.452ex;" xmlns="http://www.w3.org/2000/svg" width="109.199ex" height="2.149ex" role="img" focusable="false" viewBox="0 -750 48266 950"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(361,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(1120,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1465,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(1826,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">：</text></g><g data-mml-node="mi" transform="translate(2826,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mi" transform="translate(3826,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">时</text></g><g data-mml-node="mi" transform="translate(4826,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">间</text></g><g data-mml-node="mi" transform="translate(5826,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">，</text></g><g data-mml-node="mi" transform="translate(6826,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(7187,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(7832,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(8477,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">：</text></g><g data-mml-node="mi" transform="translate(9477,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">同</text></g><g data-mml-node="mi" transform="translate(10477,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">步</text></g><g data-mml-node="mi" transform="translate(11477,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">段</text></g><g data-mml-node="mi" transform="translate(12477,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">时</text></g><g data-mml-node="mi" transform="translate(13477,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">间</text></g><g data-mml-node="mi" transform="translate(14477,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">，</text></g><g data-mml-node="mi" transform="translate(15477,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(15838,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(16589,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(17234,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">：</text></g><g data-mml-node="mi" transform="translate(18234,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">传</text></g><g data-mml-node="mi" transform="translate(19234,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">播</text></g><g data-mml-node="mi" transform="translate(20234,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">段</text></g><g data-mml-node="mi" transform="translate(21234,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">时</text></g><g data-mml-node="mi" transform="translate(22234,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">间</text></g><g data-mml-node="mi" transform="translate(23234,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">，</text></g><g data-mml-node="mi" transform="translate(24234,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(24595,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(25346,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(26105,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(26750,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(27250,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">：</text></g><g data-mml-node="mi" transform="translate(28250,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">相</text></g><g data-mml-node="mi" transform="translate(29250,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mi" transform="translate(30250,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">缓</text></g><g data-mml-node="mi" transform="translate(31250,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">冲</text></g><g data-mml-node="mi" transform="translate(32250,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">时</text></g><g data-mml-node="mi" transform="translate(33250,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">间</text></g><g data-mml-node="mi" transform="translate(34250,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">段</text></g><g data-mml-node="mn" transform="translate(35250,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(35750,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">，</text></g><g data-mml-node="mi" transform="translate(36750,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(37111,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(37862,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(38621,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(39266,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(39766,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">：</text></g><g data-mml-node="mi" transform="translate(40766,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">相</text></g><g data-mml-node="mi" transform="translate(41766,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mi" transform="translate(42766,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">缓</text></g><g data-mml-node="mi" transform="translate(43766,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">冲</text></g><g data-mml-node="mi" transform="translate(44766,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">时</text></g><g data-mml-node="mi" transform="translate(45766,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">间</text></g><g data-mml-node="mi" transform="translate(46766,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">段</text></g><g data-mml-node="mn" transform="translate(47766,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></svg></mjx-container></span></p>
<h2 id="can的同步机制">CAN的同步机制</h2>
<p>CAN有两种同步机制：<strong>硬同步+重同步</strong></p>
<ul>
<li>一个位时间内只允许一种同步方式，要么硬同步要么重同步；</li>
<li>任何一个从 "隐性" 到 "显性"的下降沿都可以用于同步；</li>
<li>硬同步发生在报文的SOF位，所有接收节点调整各自当前位的同步段，使其位于发送的SOF位内；</li>
<li>重同步发生在一个报文SOF位之外的其它段，当下降沿落在了同步段之外时发生重同步；</li>
<li>在SOF到仲裁场发送的时间段内，如果有多个节点同时发送报文，那么这些发送节点对跳变沿不进行重同步。</li>
</ul>
<h3 id="硬同步">硬同步</h3>
<p>硬同步发生在SOF位，所有接收节点调整各自当前位的同步段，调整宽度不限</p>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808141854318.png" alt="image-20230808141854318">
<figcaption aria-hidden="true">image-20230808141854318</figcaption>
</figure>
<h3 id="重同步">重同步</h3>
<p>在两个缓冲段中间的位置，即使读取总线电平的采样点位置，当检测到总线上存在相位差的时候，通过延长PBS1或缩短PBS2来获得同步。这两个相位缓冲段的延长or缩短时间上限再有同步跳转宽度SJW给定。</p>
<blockquote>
<p>Tips:CAN是异步通信，需要通过不断地重新同步才能保证收发节点的采样准确。所以SJW决定了接收节点是否能有比较好的兼容性。</p>
</blockquote>
<h4 id="pbs1延长">PBS1延长</h4>
<p>发的晚，收的早，导致PBS1延长</p>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808142134094.png" alt="image-20230808142134094">
<figcaption aria-hidden="true">image-20230808142134094</figcaption>
</figure>
<h4 id="pbs2缩短">PBS2缩短</h4>
<p>发的早，收的晚，导致PBS2缩短</p>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808142317458.png" alt="image-20230808142317458">
<figcaption aria-hidden="true">image-20230808142317458</figcaption>
</figure>
<h4 id="同步跳转宽度">同步跳转宽度</h4>
<p>在重同步时，有个同步跳转宽度 (SJW,Synchro Jump Width)
的概念，表示的是PBS1和PBS2重同步时允许跳转的最大宽度，SJW决定了接收节点是否能有比较好的兼容性。同步跳转宽度必须满足以下几个条件：</p>
<ul>
<li><p>SJW必须小于PBS1和PBS2的最小值</p></li>
<li><p>SJW最大值不能超过4</p></li>
</ul>
<h2 id="位定时参数">位定时参数</h2>
<ul>
<li><p>位速率：bps、kbps、Mbps</p></li>
<li><p>位时间：tBit，单位一般为纳秒ns</p></li>
<li><p>时间量子Tq： <span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -1.552ex;" xmlns="http://www.w3.org/2000/svg" width="48.073ex" height="4.588ex" role="img" focusable="false" viewBox="0 -1342 21248.2 2028"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(704,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(1441.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(2497.6,0)"><g data-mml-node="mn" transform="translate(1145.5,676)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mrow" transform="translate(220,-686)"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mi" transform="translate(888,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(1647,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><rect width="2551" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(5288.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(5733.2,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mi" transform="translate(6621.2,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(7380.2,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(8084.2,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">：</text></g><g data-mml-node="mi" transform="translate(9084.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">一</text></g><g data-mml-node="mi" transform="translate(10084.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">个</text></g><g data-mml-node="mi" transform="translate(11084.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mi" transform="translate(12084.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">时</text></g><g data-mml-node="mi" transform="translate(13084.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">间</text></g><g data-mml-node="mi" transform="translate(14084.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">内</text></g><g data-mml-node="mi" transform="translate(15084.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">包</text></g><g data-mml-node="mi" transform="translate(16084.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">含</text></g><g data-mml-node="mi" transform="translate(17084.2,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(17788.2,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(18248.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">的</text></g><g data-mml-node="mi" transform="translate(19248.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">个</text></g><g data-mml-node="mi" transform="translate(20248.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">数</text></g></g></g></svg></mjx-container></span></p></li>
<li><p>传输延迟时间tPTS</p>
<p>CAN报文在CAN总线上的传输时，物理延迟包括两个部分：</p>
<ul>
<li>在CAN-BUS上传输造成的延迟</li>
<li>在节点上传输造成延迟</li>
</ul></li>
</ul>
<figure>
<img src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230808144634176.png" alt="image-20230808144634176">
<figcaption aria-hidden="true">image-20230808144634176</figcaption>
</figure>
<p>按照CAN通信协议的规定，补偿给传播延迟的时间长度要至少等于实际实际传播延迟时长的2倍，即:
<span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="31.08ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 13737.5 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(361,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(1112,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(1816,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mo" transform="translate(2738.8,0)"><path data-c="2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="mn" transform="translate(3794.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(4294.6,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="msub" transform="translate(5072.6,0)"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="TeXAtom" transform="translate(394,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(520,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(986,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g></g></g><g data-mml-node="mo" transform="translate(6702.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(7758,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(8258,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mo" transform="translate(9036,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(9425,0)"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="TeXAtom" transform="translate(394,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(466,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g></g></g><g data-mml-node="mo" transform="translate(10631.5,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msub" transform="translate(11631.7,0)"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="TeXAtom" transform="translate(394,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(759,0)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1331,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g></g></g><g data-mml-node="mo" transform="translate(13348.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></span></p>
<blockquote>
<p>Tips：在CAN总线通信系统中是以时间量子Tq来度量时间的，所以如果延迟补偿时间tPTS=3.1Tq,
那么这个时候要取：tPTS= 4Tq。</p>
</blockquote>
<ul>
<li><p>相位缓冲段：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (NBT-1-tPTS_Tq)/2==偶数</span><br><span class="line">	PBSl_Tq = PBS2_Tq = (NBT-1-tPTS_Tq)/2</span><br><span class="line">else</span><br><span class="line">	PBSl_Tq = (NBT-1-tPTS_Tq)/2</span><br><span class="line">	PBS2_Tq = PBSl_Tq + 1</span><br></pre></td></tr></table></figure></li>
<li><p>同步跳转宽度： <span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="36.85ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 16287.9 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(645,0)"><path data-c="1D43D" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z"></path></g><g data-mml-node="mi" transform="translate(1278,0)"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="mo" transform="translate(2603.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(3659.6,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(4537.6,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(4882.6,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(5482.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5871.6,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(6622.6,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(7381.6,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(8026.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(8526.6,0)"><path data-c="5F" d="M0 -62V-25H499V-62H0Z"></path></g><g data-mml-node="mi" transform="translate(9026.6,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(9730.6,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(10190.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(10635.2,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(11386.2,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(12145.2,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(12790.2,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(13290.2,0)"><path data-c="5F" d="M0 -62V-25H499V-62H0Z"></path></g><g data-mml-node="mi" transform="translate(13790.2,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(14494.2,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(14954.2,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mn" transform="translate(15398.9,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path></g><g data-mml-node="mo" transform="translate(15898.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></span></p></li>
<li><p>验证晶振误差Df</p></li>
</ul>
<p>晶振误差必须满足三个条件</p>
<ul>
<li><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -2.172ex;" xmlns="http://www.w3.org/2000/svg" width="23.637ex" height="5.296ex" role="img" focusable="false" viewBox="0 -1381 10447.4 2341"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mi" transform="translate(828,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(1655.8,0)"><g data-mml-node="text"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="text" transform="translate(778,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g></g><g data-mml-node="mfrac" transform="translate(3489.6,0)"><g data-mml-node="mrow" transform="translate(2315.9,676)"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(645,0)"><path data-c="1D43D" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z"></path></g><g data-mml-node="mi" transform="translate(1278,0)"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g></g><g data-mml-node="mrow" transform="translate(220,-710)"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mn" transform="translate(389,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mo" transform="translate(1111.2,0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mn" transform="translate(1833.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path></g><g data-mml-node="mo" transform="translate(3055.7,0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mi" transform="translate(3777.9,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mi" transform="translate(4665.9,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(5424.9,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mo" transform="translate(6128.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g><rect width="6717.9" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></span></p></li>
<li><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -2.172ex;" xmlns="http://www.w3.org/2000/svg" width="36.174ex" height="5.475ex" role="img" focusable="false" viewBox="0 -1460 15988.9 2420"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mi" transform="translate(828,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(1655.8,0)"><g data-mml-node="text"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="text" transform="translate(778,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g></g><g data-mml-node="mfrac" transform="translate(3489.6,0)"><g data-mml-node="mrow" transform="translate(407.8,710)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1223,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1823,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2212,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(2963,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(3722,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(4367,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(4867,0)"><path data-c="5F" d="M0 -62V-25H499V-62H0Z"></path></g><g data-mml-node="mi" transform="translate(5367,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(6071,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(6531,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(6975.7,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(7726.7,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(8485.7,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(9130.7,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(9630.7,0)"><path data-c="5F" d="M0 -62V-25H499V-62H0Z"></path></g><g data-mml-node="mi" transform="translate(10130.7,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(10834.7,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(11294.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g><g data-mml-node="mrow" transform="translate(220,-710)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mo" transform="translate(722.2,0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mo" transform="translate(1444.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mn" transform="translate(1833.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(500,0)"></path></g><g data-mml-node="mo" transform="translate(3055.7,0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mi" transform="translate(3777.9,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mi" transform="translate(4665.9,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(5424.9,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mo" transform="translate(6351.1,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(7351.3,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(8102.3,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(8861.3,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mn" transform="translate(9506.3,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(10006.3,0)"><path data-c="5F" d="M0 -62V-25H499V-62H0Z"></path></g><g data-mml-node="mi" transform="translate(10506.3,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mi" transform="translate(11210.3,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(11670.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g><rect width="12259.3" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></span></p></li>
<li><p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="13.802ex" height="2.161ex" role="img" focusable="false" viewBox="0 -750 6100.6 955"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mi" transform="translate(828,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(1655.8,0)"><g data-mml-node="text"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="text" transform="translate(778,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g></g><g data-mml-node="mn" transform="translate(3489.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(778,0)"></path><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z" transform="translate(1278,0)"></path></g><g data-mml-node="mi" transform="translate(5267.6,0)"><path data-c="25" d="M465 605Q428 605 394 614T340 632T319 641Q332 608 332 548Q332 458 293 403T202 347Q145 347 101 402T56 548Q56 637 101 693T202 750Q241 750 272 719Q359 642 464 642Q580 642 650 732Q662 748 668 749Q670 750 673 750Q682 750 688 743T693 726Q178 -47 170 -52Q166 -56 160 -56Q147 -56 142 -45Q137 -36 142 -27Q143 -24 363 304Q469 462 525 546T581 630Q528 605 465 605ZM207 385Q235 385 263 427T292 548Q292 617 267 664T200 712Q193 712 186 709T167 698T147 668T134 615Q132 595 132 548V527Q132 436 165 403Q183 385 203 385H207ZM500 146Q500 234 544 290T647 347Q699 347 737 292T776 146T737 0T646 -56Q590 -56 545 0T500 146ZM651 -18Q679 -18 707 24T736 146Q736 215 711 262T644 309Q637 309 630 306T611 295T591 265T578 212Q577 200 577 146V124Q577 -18 647 -18H651Z"></path></g></g></g></svg></mjx-container></span></p></li>
</ul>
<h1 id="bonus">Bonus</h1>
<h3 id="比特率波特率和频率带宽">比特率、波特率和频率带宽</h3>
<ul>
<li>比特率（bit
rate）：每秒传送的比特数量，又称为传信率，信息传输率，位速率。比特率基本单位为bit/s或bps，全称为bit
per second</li>
<li>波特率（Baud）：每秒钟传送的符号（码元）数量，又称为传码率，信号传输率，单位是波特（Baud、B，即symbol/s）。在通信系统中，携带数据信息的信号单元称为码元，也称为符号（symbol）。</li>
</ul>
<table style="width:100%;">
<colgroup>
<col style="width: 16%">
<col style="width: 46%">
<col style="width: 17%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>码元类型</th>
<th>码元状态</th>
<th>码元状态总数量</th>
<th>码元所需比特位数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2种状态的码元</td>
<td>0、1</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<td>4种状态的码元</td>
<td>00、01、10、11</td>
<td>4</td>
<td>2</td>
</tr>
<tr class="odd">
<td>8种状态的码元</td>
<td>000、001、010、100、011、101、110、111</td>
<td>8</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="34.504ex" height="2.161ex" role="img" focusable="false" viewBox="0 -750 15250.8 955"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">比</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">特</text></g><g data-mml-node="mi" transform="translate(2000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">位</text></g><g data-mml-node="mi" transform="translate(3000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">数</text></g><g data-mml-node="mo" transform="translate(4277.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(5333.6,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(5631.6,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="msub" transform="translate(6116.6,0)"><g data-mml-node="mi"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mn" transform="translate(510,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mi" transform="translate(7030.1,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(7918.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(8362.8,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mi" transform="translate(9250.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">为</text></g><g data-mml-node="mi" transform="translate(10250.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">码</text></g><g data-mml-node="mi" transform="translate(11250.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">元</text></g><g data-mml-node="mi" transform="translate(12250.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">状</text></g><g data-mml-node="mi" transform="translate(13250.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">态</text></g><g data-mml-node="mi" transform="translate(14250.8,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">数</text></g></g></g></svg></mjx-container></span></p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="47.639ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 21056.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">比</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">特</text></g><g data-mml-node="mi" transform="translate(2000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">率</text></g><g data-mml-node="mi" transform="translate(3000,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mi" transform="translate(3759,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></g><g data-mml-node="mo" transform="translate(4465.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(5521.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">波</text></g><g data-mml-node="mi" transform="translate(6521.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">特</text></g><g data-mml-node="mi" transform="translate(7521.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">率</text></g><g data-mml-node="mi" transform="translate(8521.6,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></g><g data-mml-node="mi" transform="translate(9280.6,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(9971.8,0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></g><g data-mml-node="mi" transform="translate(10694,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path></g><g data-mml-node="mi" transform="translate(10992,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="msub" transform="translate(11477,0)"><g data-mml-node="mi"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path></g><g data-mml-node="mn" transform="translate(510,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mi" transform="translate(12390.6,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(13278.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(13667.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">仅</text></g><g data-mml-node="mi" transform="translate(14667.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">考</text></g><g data-mml-node="mi" transform="translate(15667.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">虑</text></g><g data-mml-node="mi" transform="translate(16667.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">信</text></g><g data-mml-node="mi" transform="translate(17667.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">息</text></g><g data-mml-node="mi" transform="translate(18667.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">净</text></g><g data-mml-node="mi" transform="translate(19667.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">荷</text></g><g data-mml-node="mo" transform="translate(20667.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></span></p>
<p>频谱带宽其实是通信信号的最高频率与最低频率的差值。</p>
<p>波特率越高，比特率越高，所占用的信道频谱带宽也越大</p>
<h3 id="网关">网关</h3>
<p>网关(Gateway)又称网间连接器、协议转换器。就是一个网络连接到另一个网咯的“关口”。</p>
<p>网关实质上是<strong>一个网络通向其他网络的IP地址</strong>。</p>
<h3 id="ocr识别">OCR识别</h3>
<p>OCR （Optical Character
Recognition，光学字符识别）是指电子设备（例如扫描仪或数码相机）检查纸上打印的字符，通过检测暗、亮的模式确定其形状，然后用字符识别方法将形状翻译成计算机文字的过程。</p>
<p>福昕PDF阅读器自带的快速识别功能（可秒杀一众OCR专业工具），墙裂推荐</p>
<blockquote>
<p>但实际使用并不是完全好，有意思的是我遇到 “一位” 被识别为
“T立”，“。”被识别为“0”。特别是对数学公式的识别一言难尽。。。</p>
</blockquote>
<h1 id="references">References</h1>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/630588317">一文搞懂比特率和波特率 -
知乎 (zhihu.com)</a></li>
<li><a href="https://blog.csdn.net/weixin_40528417/article/details/79476186">CAN总线学习笔记（1）-
CAN基础知识_关于can通讯的重点和难点_weixin_40528417的博客-CSDN博客</a></li>
<li><a href="https://blog.csdn.net/weixin_40528417/article/details/79534483?spm=1001.2014.3001.5502">CAN总线学习笔记（2）-
CAN协议数据帧与遥控帧_weixin_40528417的博客-CSDN博客</a></li>
<li><a href="https://blog.csdn.net/weixin_40528417/article/details/79771270?spm=1001.2014.3001.5502">CAN总线学习笔记（3）-
CAN协议错误帧_weixin_40528417的博客-CSDN博客</a></li>
<li><a href="https://blog.csdn.net/weixin_40528417/article/details/79871311?spm=1001.2014.3001.5502">CAN总线学习笔记（4）-
CAN协议过载帧和帧间隔_weixin_40528417的博客-CSDN博客</a></li>
<li><a href="https://blog.csdn.net/weixin_40528417/article/details/79936476?spm=1001.2014.3001.5502">CAN总线学习笔记（5）-
CAN通信的位定时与同步_weixin_40528417的博客-CSDN博客</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/165142303">什么是网关，网关的作用是什么？
- 知乎 (zhihu.com)</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/65226634">一文搞懂网络知识，IP、子网掩码、网关、DNS、端口号
- 知乎 (zhihu.com)</a></li>
<li><a href="https://www.dianyuan.com/article/46751.html">CAN总线同步跳转宽度的作用-电源网
(dianyuan.com)</a></li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>robomaster</tag>
        <tag>CAN</tag>
      </tags>
  </entry>
  <entry>
    <title>EXTI入门</title>
    <url>/2023/08/21/EXTI%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following
哈工深上传到B站的电控组培训来入门robomaster电控组，我购买了普中科技玄武套餐开发板作为硬件。</p>
<p>本篇介绍我学习EXIT的见闻</p>
<span id="more"></span>
<h1 id="exti">EXTI</h1>
<h2 id="中断简介">中断简介</h2>
<p>中断指计算机运行过程中，出现某些意外情况需要主机干预时，机器能自动停止正在运行的程序并转入处理新情况的程序，处理完毕后又返回原被暂停的程序继续运行。<strong>中断是实现多线程设计的必要条件</strong>。</p>
<p>EXTI：（External interrupt/event controller）外部中断/事件控制器</p>
<h2 id="nvic">NVIC</h2>
<p>NVIC的全称是Nested vectoredinterrupt
controller，即嵌套向量中断控制器</p>
<p>能够打断当前代码执行流程的事件分为<strong>异常(exception)</strong>和<strong>中断(interrupt)</strong>，他们都被编排在中断向量表（在stm32中文参考手册中可查找，在stm32的启动文件中也能找到eg:startup_stm32f103xe.s）里面。</p>
<ul>
<li>编号为负的内核异常不能被设置优先级，如复位(Reset)、不可屏蔽中断
(NMI)、硬错误(Hardfault)。从编号 7
开始的为外部中断，这些中断的优先级都是可以自行设置的。</li>
<li>NVIC的核心功能是中断优先级分组、中断优先级的配置、读中断请求标志、清除中断请求标志、使能中断、清除中断等.</li>
<li>外部中断信号从核外发出，信号最终要传递到NVIC(嵌套向量中断控制器)。</li>
<li>NVIC跟内核紧密耦合，它控制着整个芯片中断的相关功能。</li>
</ul>
<h2 id="中断优先级分组">中断优先级分组</h2>
<p>STM32 的中断向量具有两个属性：抢占，响应</p>
<ul>
<li><p>抢占（编号越小，优先级越高），是指打断其它中断的属性，即因为具有这个属性，会出现嵌套中断(在执行中断服务函数
A 的过程中被中断 B 打断，执行完中断服务函数 B 再继续执行中断服务函数
A)。</p></li>
<li><p>响应（编号越小，优先级越高）属性则应用在抢占属性相同的情况下，当两个中断向量的抢占优先级相同时，如果两个中断同时到达，则先处理响应优先级高的中断。（不能打断其他中断）</p></li>
<li><p>在STM32中，抢占优先级和响应优先级的数量由一个 4
位的数字来决定，把这个 4
位数字的位数分配成抢占优先级部分和响应优先级部分。（都写在寄存器内）</p></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230607154202250.png"
alt="image-20230607154202250" />
<figcaption aria-hidden="true">image-20230607154202250</figcaption>
</figure>
<blockquote>
<p>Tips:两个中断不可能同时来，所以响应优先级主要给出了一种响应的优先队列，当多个中断向量的抢占优先级相同时，它们不会互相打断，后续的排队会按照响应优先级排队。</p>
</blockquote>
<h2 id="exti介绍">EXTI介绍</h2>
<p>中断引脚的序号需要不一样才能配置不停的中断（F1系列的硬件实现）</p>
<blockquote>
<p>Tips:F1系列中断是共用的eg:中断/事件线EXTI0，输入源PX0（X可为A,B,...I）PA0用了则PB0就用不了。</p>
</blockquote>
<p>EXTI有两大模式;中断模式和事件模式</p>
<ul>
<li>中断模式产生中断：把输入信号输入到NVIC中，进一步执行中断服务函数，实现功能，这是软件级别的。</li>
<li>事件模式产生事件：传输一个脉冲信号给其他外设使用，并且这是电路级别的信号传输，不需要软件处理，硬件直接触发</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230821013658350.png"
alt="image-20230821013658350" />
<figcaption aria-hidden="true">image-20230821013658350</figcaption>
</figure>
<ul>
<li>23：并行传输数据，和这个寄存器一样的有23个</li>
<li>边沿检测电路：一个符合则输出1</li>
</ul>
<p>每一种模式都可配置为上升沿触发、下降沿触发，以及上升下降沿触发三种触发方式</p>
<h2 id="中断函数的实现">中断函数的实现</h2>
<p>要产生中断，必须先配置好并使能中断线。根据需要的边沿检测设置2个触发寄存器，同时在中断屏蔽寄存器的相应位写’1’允许中断请求。当外部中断线上发生了期待的边沿时，将产生一个中断请求，对应的挂起位也随之被置’1’。在挂起寄存器的对应位写’1’，将清除该中断请求。</p>
<p>如果需要产生事件，必须先配置好并使能事件线。根据需要的边沿检测通过设置2个触发寄存器，同时在事件屏蔽寄存器的相应位写’1’允许事件请求。当事件线上发生了需要的边沿时，将产生一个事件请求脉冲，对应的挂起位不被置’1’。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230607154902377.png"
alt="image-20230607154902377" />
<figcaption aria-hidden="true">image-20230607154902377</figcaption>
</figure>
<p>通过在软件中断/事件寄存器写’1’，也可以通过软件产生中断/事件请求。</p>
<ul>
<li><p>一般来说单片机的中断发生有两个条件，一是<strong>中断标志位置位</strong>，二是<strong>中断允许</strong>（中断屏蔽寄存器），如果这两个条件都满足则进入中断，因为正常情况下中断一直是允许的，那么只能通过标志位来区分是否有中断挂起</p></li>
<li><p>中断标志位：挂起请求寄存器设置。</p>
<p>PRx:挂起为（pending bit）：</p>
<p>0没有发生触发请求，1发生了选择触发请求</p>
<p>当在外部中断线上发生了选择的边沿事件，该位被置1。在该位写入1可以清楚它，也可以通过改变边沿检测的极性清除。</p></li>
<li><p>如果进入中断不清除标志位，那么这一中断服务程序结束后由于标志位还是置位的并且中断是允许的，那么还会再次进入该中断，就会发生一直在执行中断程序的情况</p></li>
<li><p>周期性中断是由定时器辅助完成的，只要定时时间到，硬件就会自动置位标志位，这时中断发生，定时器还在运行，<strong>与中断处理是并行的没有冲突</strong>，因此周期性的中断不是从中断标志位清零开始的。</p>
<blockquote>
<p>Tips:MCU和定时器是并行的，互不影响</p>
</blockquote></li>
<li><p>如果中断程序没有执行完并且一下个中断又来了，那么硬件还是会自动置位标志位的，如果在这之前已经清零标志位那么中断结束后会再进入一次该中断，如果这时还没有清除中断标志位，则第二个中断无效。</p>
<blockquote>
<p>Tips:有中断，中断标志位变为1,不清0，则不能响应新的中断。</p>
</blockquote></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * @brief EXTI line detection callbacks.</span><br><span class="line"> * @param GPIO_Pin: Specifies the pins connected EXTI line</span><br><span class="line"> * @retval None</span><br><span class="line"> *外部中断的回调函数,hal库</span><br><span class="line"> */ </span><br><span class="line">__weak void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin) </span><br><span class="line">&#123;</span><br><span class="line"> /* Prevent unused argument(s) compilation warning */</span><br><span class="line"> UNUSED(GPIO_Pin);</span><br><span class="line"> /* NOTE: This function Should not be modified, when the callback is needed, the HAL_GPIO_EXTI_Callback could be implemented in the user file */ </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:
<code>_weak</code>在其他地方重新定义该函数此_weak定义的函数会被覆盖,即我们要重写void
HAL_GPIO_EXTI_Callback(uin16_t,GPIO_Pin);函数</p>
</blockquote>
<h2 id="实验">实验</h2>
<h3 id="按键扫描">按键扫描</h3>
<p>根据需要确定GPIO模式：选择下拉输入还是上拉输入or浮空输入，通过反复读取按键状态是否为高电平判断按键是否被触发</p>
<p><strong>按键扫描的原理</strong>：
按键的两个引脚的一端通过下拉电阻拉倒低电平，另一端接着电源。当按下开关时，输入引脚为高电平。通过反复读取按键状态是否为高电平判断按键是否被触发。</p>
<p><strong>notes:</strong></p>
<ul>
<li><p>记得在cubeMX的GPIO把NVIC设置为enable</p></li>
<li><p>在keil
5中添加新文件：先将文件放在同一目录下，右键add添加.c文件/双击add即可，.h文件用#include包含即可</p></li>
<li><p>机械按键的抖动，毛刺，延时再判断，hal_delay是用systick实现的</p>
<blockquote>
<p>Tips:设置中断优先级（比时钟低，不然不能HAL_Delay(),会陷入死循环）</p>
</blockquote></li>
</ul>
<p>如下图：数码管8位一般定义为：DP G F E D C B A</p>
<p>B C亮表示1，即00000110=0x06;</p>
<p>A B G E D亮表示2 即01011011=0x5b；</p>
<p>依次类推</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/a1ec08fa513d26975dfc13c055fbb2fb4316d87b.jpg"
alt="a1ec08fa513d26975dfc13c055fbb2fb4316d87b" />
<figcaption
aria-hidden="true">a1ec08fa513d26975dfc13c055fbb2fb4316d87b</figcaption>
</figure>
<h1 id="references">References</h1>
<ul>
<li>哈工深电控内训</li>
<li><a
href="https://zhidao.baidu.com/question/1959763145635584700.html">单片机的中断标志位是有什么作用？_百度知道
(baidu.com)</a></li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>robomaster</tag>
        <tag>嵌入式</tag>
      </tags>
  </entry>
  <entry>
    <title>Environment_variables</title>
    <url>/2023/08/14/Environment-variables/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>最近调整自己的workflow，遇到很多配置环境变量（environment
variable）的问题，借此机会了解一下</p>
<span id="more"></span>
<h1 id="introduction">Introduction</h1>
<p>环境变量是一种<strong>在操作系统中</strong>用来指定操作系统运行环境的参数，例如临时文件夹的位置，系统文件夹的位置，可执行文件的搜索路径等。</p>
<p>环境变量的作用是<strong>让操作系统或者应用程序能够找到所需要的资源或者设置</strong>。</p>
<h1 id="diffenent-systems">diffenent systems</h1>
<h2 id="在windows中">在Windows中</h2>
<p>可以通过“控制面板”-“系统”-“高级系统设置”-“环境变量”来查看和编辑环境变量。通过可视化的窗口模式展现出来的.</p>
<h2 id="在linux中">在Linux中</h2>
<p>可以通过命令行工具或者编辑配置文件来查看和编辑环境变量。</p>
<h3 id="设置">设置：</h3>
<p>在
/etc/profile文件中设置，export的意思就是将局部变量设置为环境变量。现有的变量是被这样一行代码设置的：</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE HISTCONTROL</span><br></pre></td></tr></table></figure>
<p>这几个环境变量已经有一些默认值了，不过我们可以追加内容，比如修改PATH：</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># : 的意思是并列</span><br><span class="line">PATH = /abc/def:$PATH</span><br></pre></td></tr></table></figure>
<h3 id="查看">查看：</h3>
<p>查看全部，使用<code>env</code>命令即可。</p>
<p>查看单个，可以使用<code>echo：如echo $JAVA_HOME。</code></p>
<h1 id="一些常见的环境变量有">一些常见的环境变量有</h1>
<ul>
<li><p>PATH：指定可执行文件的搜索路径，当你在命令行中输入一个程序名而没有指定完整路径时，系统会在PATH中指定的目录下寻找该程序。（一般为bin文件姐）</p></li>
<li><p>JAVA_HOME：指定JDK（Java开发工具包）的安装目录，一些Java开发工具或者应用程序会使用这个变量来找到JDK。</p></li>
<li><p>TEMP或TMP：指定临时文件夹的位置，一些应用程序会在这个目录下存储临时数据或者缓存文件。</p></li>
<li><p>USERPROFILE：指定当前用户的配置文件的位置，一些应用程序会在这个目录下存储用户相关的数据或者设置。</p></li>
</ul>
<h1 id="references">References</h1>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/82011100">看懂什么是环境变量!
- 知乎 (zhihu.com)</a></li>
</ul>
]]></content>
      <categories>
        <category>CS</category>
      </categories>
      <tags>
        <tag>CS</tag>
      </tags>
  </entry>
  <entry>
    <title>Git入门</title>
    <url>/2023/08/05/Git%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>following <a
href="https://missing-semester-cn.github.io/2020/version-control/">版本控制(Git)
· the missing semester of your cs education
(missing-semester-cn.github.io)</a>来学习git的相关知识</p>
<p>希望通过<a href="https://git-scm.com/book/zh/v2">Git - Book
(git-scm.com)</a>+<a
href="https://learngitbranching.js.org/?locale=zh_CN">Learn Git
Branching</a>来进一步掌握Git</p>
<p><strong>Learn to love the command line. Leave the IDE
behind.</strong></p>
<span id="more"></span>
<h1 id="version-controlgit">Version control(Git)</h1>
<p>版本控制系统version control
system(VCS)是一类用于追踪源代码（或其他文件、文件夹）改动的工具</p>
<h4 id="好处">好处：</h4>
<ul>
<li>这些工具可以帮助我们管理代码的修改历史</li>
<li>可以让协作编码变得更方便</li>
</ul>
<h4 id="工作方式">工作方式</h4>
<p>VCS通过一系列的快照将某个文件夹及其内容保存了起来，每个快照都包含了文件或文件夹的完整状态。同时它还维护了快照创建者的信息以及每个快照的相关信息等等。</p>
<figure>
<img
src="https://cdn.jsdelivr.net/gh/Immortal-Fates/figure_Bed@main/blog/git.png"
alt="git" />
<figcaption aria-hidden="true">git</figcaption>
</figure>
<h4 id="dvcs">DVCS</h4>
<p>分布式版本控制系统（Distributed Version Control System，简称
DVCS）</p>
<p>客户端并不只提取最新版本的文件快照，
而是把代码仓库完整地镜像下来，包括完整的历史记录。
这么一来，任何一处协同工作用的服务器发生故障，事后都可以用任何一个镜像出来的本地仓库恢复。
因为每一次的克隆操作，实际上都是一次对代码仓库的完整备份。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/distributed.png"
alt="distributed" />
<figcaption aria-hidden="true">distributed</figcaption>
</figure>
<p>许多这类系统都可以指定和若干不同的远端代码仓库进行交互。籍此，你就可以在同一个项目中，分别和不同工作小组的人相互协作。
你可以根据需要设定不同的协作流程，比如层次模型式的工作流，而这在以前的集中式系统中是无法实现的。</p>
<h1 id="git-的数据模型">Git 的数据模型</h1>
<p>进行版本控制的方法很多。Git
拥有一个经过精心设计的模型，这使其能够支持版本控制所需的所有特性，例如维护历史记录、支持分支和促进协作。</p>
<h4 id="快照snapshots">快照（snapshots）</h4>
<p>Git
将顶级目录中的文件和文件夹作为集合，并通过一系列快照来管理其历史记录。在Git的术语里，文件被称作Blob对象（数据对象），也就是一组数据。目录则被称之为“树”，它将名字与
Blob
对象或树对象进行映射（使得目录中可以包含其他目录）。快照则是被追踪的最顶层的树。例如，一个树看起来可能是这样的：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;root&gt; (tree)</span><br><span class="line">|</span><br><span class="line">+- foo (tree)</span><br><span class="line">|  |</span><br><span class="line">|  + bar.txt (blob, contents = &quot;hello world&quot;)</span><br><span class="line">|</span><br><span class="line">+- baz.txt (blob, contents = &quot;git is wonderful&quot;)</span><br></pre></td></tr></table></figure>
<p>这个顶层的树包含了两个元素，一个名为 “foo”
的tree（它本身包含了一个blob对象 “bar.txt”），以及一个 blob 对象
“baz.txt”。</p>
<h4 id="历史记录建模关联快照">历史记录建模：关联快照</h4>
<p>版本控制系统和快照有什么关系呢？线性历史记录是一种最简单的模型，它包含了一组按照时间顺序线性排列的快照。</p>
<p>在 Git 中，历史记录是一个由快照组成的有向无环图(directed acyclic
graph (DAG))。有向无环图，这代表 Git
中的每个快照都有一系列的“父辈”，也就是其之前的一系列快照。</p>
<blockquote>
<p>notes：快照具有多个“父辈”而非一个，因为某个快照可能由多个父辈而来。例如，经过合并后的两条分支。</p>
</blockquote>
<p>在 Git
中，这些快照被称为“提交commit”。通过可视化的方式来表示这些历史提交记录时，看起来差不多是这样的：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">o &lt;-- o &lt;-- o &lt;-- o</span><br><span class="line">            ^  </span><br><span class="line">             \</span><br><span class="line">              --- o &lt;-- o</span><br></pre></td></tr></table></figure>
<p>其中的 <code>o</code> 表示一次提交（快照）。</p>
<p>箭头指向了当前提交的父辈（这是一种“在…之前”，而不是“在…之后”的关系）。在第三次提交之后，历史记录分岔成了两条独立的分支。这可能因为此时需要同时开发两个不同的特性，它们之间是相互独立的。开发完成后，这些分支可能会被合并并创建一个新的提交，这个新的提交会同时包含这些特性。新的提交会创建一个新的历史记录，看上去像这样（最新的合并提交用粗体标记）：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">o &lt;-- o &lt;-- o &lt;-- o &lt;---- o</span><br><span class="line">            ^            /</span><br><span class="line">             \          v</span><br><span class="line">              --- o &lt;-- o</span><br></pre></td></tr></table></figure>
<p>Git
中的提交是不可改变的。但这并不代表错误不能被修改，只不过这种“修改”实际上是创建了一个全新的提交记录。而引用（参见下文）则被更新为指向这些新的提交。</p>
<h4 id="数据模型及其伪代码表示">数据模型及其伪代码表示</h4>
<p>以伪代码的形式来学习 Git 的数据模型，可能更加清晰：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 文件就是一组数据</span><br><span class="line">type blob = array&lt;byte&gt;</span><br><span class="line"></span><br><span class="line">// 一个包含文件和目录的目录</span><br><span class="line">type tree = map&lt;string, tree | blob&gt;</span><br><span class="line"></span><br><span class="line">// 每个提交都包含一个父辈，元数据和顶层树</span><br><span class="line">type commit = struct &#123;</span><br><span class="line">    parent: array&lt;commit&gt;</span><br><span class="line">    author: string</span><br><span class="line">    message: string</span><br><span class="line">    snapshot: tree</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是一种简洁的历史模型。</p>
<h4 id="对象和内存寻址">对象和内存寻址</h4>
<p>Git 中的对象可以是 blob、tree or commit：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">type object = blob | tree | commit</span><br></pre></td></tr></table></figure>
<p>Git 在储存数据时，所有的对象都会基于它们的 <a
href="https://en.wikipedia.org/wiki/SHA-1">SHA-1 哈希</a> 进行寻址。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">objects = map&lt;string, object&gt;</span><br><span class="line"></span><br><span class="line">def store(object):</span><br><span class="line">    id = sha1(object)</span><br><span class="line">    objects[id] = object</span><br><span class="line"></span><br><span class="line">def load(id):</span><br><span class="line">    return objects[id]</span><br></pre></td></tr></table></figure>
<p>Blobs、树和提交都一样，它们都是对象。当它们引用其他对象时，它们并没有真正的在硬盘上保存这些对象，而是仅仅保存了它们的哈希值作为引用。</p>
<p>例如，上面例子中的树（可以通过
<code>git cat-file -p 698281bc680d1995c5f4caaf3359721a5a58d48d</code>
来进行可视化），看上去是这样的：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">100644 blob 4448adbf7ecd394f42ae135bbeed9676e894af85    baz.txt</span><br><span class="line">040000 tree c68d233a33c5c06e0340e4c224f0afca87c8ce87    foo</span><br></pre></td></tr></table></figure>
<p>树本身会包含一些指向其他内容的指针，例如 <code>baz.txt</code> (blob)
和 <code>foo</code> (树)。如果我们用
<code>git cat-file -p 4448adbf7ecd394f42ae135bbeed9676e894af85</code>，即通过哈希值查看
baz.txt 的内容，会得到以下信息：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git is wonderful</span><br></pre></td></tr></table></figure>
<h4 id="引用references">引用(References)</h4>
<p>Git
给这些哈希值赋予人类可读的名字，也就是引用（references）。<strong>引用是指向提交的指针</strong>。与对象不同的是，它是可变的（引用可以被更新，指向新的提交）。例如，<code>master</code>
引用通常会指向主分支的最新一次提交。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">references = map&lt;string, string&gt;</span><br><span class="line"></span><br><span class="line">def update_reference(name, id):</span><br><span class="line">    references[name] = id</span><br><span class="line"></span><br><span class="line">def read_reference(name):</span><br><span class="line">    return references[name]</span><br><span class="line"></span><br><span class="line">def load_reference(name_or_id):</span><br><span class="line">    if name_or_id in references:</span><br><span class="line">        return load(references[name_or_id])</span><br><span class="line">    else:</span><br><span class="line">        return load(name_or_id)</span><br></pre></td></tr></table></figure>
<p>这样，Git 就可以使用诸如 “master”
这样人类可读的名称来表示历史记录中某个特定的提交，而不需要在使用一长串十六进制字符了。</p>
<p>有一个细节需要我们注意，
通常情况下，我们会想要知道“我们当前所在位置”，并将其标记下来。这样当我们创建新的快照的时候，我们就可以知道它的相对位置（如何设置它的“父辈”）。在
Git 中，我们当前的位置有一个特殊的索引，它就是 “HEAD”。</p>
<h4 id="仓库repositories">仓库(Repositories)</h4>
<p>最后，我们可以粗略地给出 Git 仓库的定义了：<code>对象</code> 和
<code>引用</code>。</p>
<p>在硬盘上，Git 仅存储对象和引用：因为其数据模型仅包含这些东西。所有的
<code>git</code>
命令都对应着对提交树的操作，例如增加对象，增加或删除引用。</p>
<p>当你输入某个指令时，请思考一下这条命令是如何对底层的图数据结构进行操作的。另一方面，如果您希望修改提交树，例如“丢弃未提交的修改和将
‘master’ 引用指向提交 <code>5d83f9e</code>
时，有什么命令可以完成该操作（针对这个具体问题，您可以使用
<code>git checkout master; git reset --hard 5d83f9e</code>）</p>
<h1 id="staging-area">staging area</h1>
<p>Git
中还包括一个和数据模型完全不相关的概念，但它确是创建提交的接口的一部分。</p>
<p>就上面介绍的快照系统来说，您也许会期望它的实现里包括一个 “创建快照”
的命令，该命令能够基于当前工作目录的当前状态创建一个全新的快照。有些版本控制系统确实是这样工作的，但
Git
不是。我们希望简洁的快照，而且每次从当前状态创建快照可能效果并不理想。例如，考虑如下场景，您开发了两个独立的特性，然后您希望创建两个独立的提交，其中第一个提交仅包含第一个特性，而第二个提交仅包含第二个特性。或者，假设您在调试代码时添加了很多打印语句，然后您仅仅希望提交和修复
bug 相关的代码而丢弃所有的打印语句。</p>
<p>Git 处理这些场景的方法是使用一种叫做 “暂存区（staging
area）”的机制，它允许您指定下次快照中要包括那些改动。</p>
<h1 id="git-的命令行接口">Git 的命令行接口</h1>
<p>为了避免重复信息，我们将不会详细解释以下命令行。强烈推荐您阅读 <a
href="https://git-scm.com/book/zh/v2">Pro Git
中文版</a>或可以观看本讲座的视频来学习。</p>
<h4 id="基础">基础</h4>
<ul>
<li><p><code>git help &lt;command&gt;</code>: 获取 git
命令的帮助信息</p></li>
<li><p><code>git init</code>: 创建一个新的 git
仓库，其数据会存放在一个名为 <code>.git</code> 的目录下</p></li>
<li><p><code>git status</code>: 显示当前的仓库状态</p></li>
<li><p><code>git add &lt;filename&gt;</code>: 添加文件到暂存区</p></li>
<li><p>```plaintext git commit <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  : 创建一个新的提交</span><br><span class="line"></span><br><span class="line">  - 如何编写 [良好的提交信息](https://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html)!</span><br><span class="line">  - 为何要 [编写良好的提交信息](https://chris.beams.io/posts/git-commit/)</span><br><span class="line"></span><br><span class="line">- `git log`: 显示历史日志</span><br><span class="line"></span><br><span class="line">- `git log --all --graph --decorate`: 可视化历史记录（有向无环图）</span><br><span class="line"></span><br><span class="line">- `git diff &lt;filename&gt;`: 显示与暂存区文件的差异</span><br><span class="line"></span><br><span class="line">- `git diff &lt;revision&gt; &lt;filename&gt;`: 显示某个文件两个版本之间的差异</span><br><span class="line"></span><br><span class="line">- `git checkout &lt;revision&gt;`: 更新 HEAD 和目前的分支</span><br><span class="line"></span><br><span class="line">#### 分支和合并</span><br><span class="line"></span><br><span class="line">- `git branch`: 显示分支</span><br><span class="line"></span><br><span class="line">- `git branch &lt;name&gt;`: 创建分支</span><br><span class="line"></span><br><span class="line">- ```plaintext</span><br><span class="line">  git checkout -b &lt;name&gt;</span><br></pre></td></tr></table></figure></p>
<p>: 创建分支并切换到该分支</p>
<ul>
<li>相当于
<code>git branch &lt;name&gt;; git checkout &lt;name&gt;</code></li>
</ul></li>
<li><p><code>git merge &lt;revision&gt;</code>: 合并到当前分支</p></li>
<li><p><code>git mergetool</code>: 使用工具来处理合并冲突</p></li>
<li><p><code>git rebase</code>:
将一系列补丁变基（rebase）为新的基线</p></li>
</ul>
<h4 id="远端操作">远端操作</h4>
<ul>
<li><code>git remote</code>: 列出远端</li>
<li><code>git remote add &lt;name&gt; &lt;url&gt;</code>:
添加一个远端</li>
<li><code>git push &lt;remote&gt; &lt;local branch&gt;:&lt;remote branch&gt;</code>:
将对象传送至远端并更新远端引用</li>
<li><code>git branch --set-upstream-to=&lt;remote&gt;/&lt;remote branch&gt;</code>:
创建本地和远端分支的关联关系</li>
<li><code>git fetch</code>: 从远端获取对象/索引</li>
<li><code>git pull</code>: 相当于 <code>git fetch; git merge</code></li>
<li><code>git clone</code>: 从远端下载仓库</li>
</ul>
<h4 id="撤销">撤销</h4>
<ul>
<li><code>git commit --amend</code>: 编辑提交的内容或信息</li>
<li><code>git reset HEAD &lt;file&gt;</code>: 恢复暂存的文件</li>
<li><code>git checkout -- &lt;file&gt;</code>: 丢弃修改</li>
<li><code>git restore</code>: git2.32版本后取代git reset
进行许多撤销操作</li>
</ul>
<h1 id="git-高级操作">Git 高级操作</h1>
<ul>
<li><code>git config</code>: Git 是一个 <a
href="https://git-scm.com/docs/git-config">高度可定制的</a> 工具</li>
<li><code>git clone --depth=1</code>: 浅克隆（shallow
clone），不包括完整的版本历史信息</li>
<li><code>git add -p</code>: 交互式暂存</li>
<li><code>git rebase -i</code>: 交互式变基</li>
<li><code>git blame</code>: 查看最后修改某行的人</li>
<li><code>git stash</code>: 暂时移除工作目录下的修改内容</li>
<li><code>git bisect</code>: 通过二分查找搜索历史记录</li>
<li><code>.gitignore</code>: <a
href="https://git-scm.com/docs/gitignore">指定</a> 故意不追踪的文件</li>
</ul>
<h1 id="bonus">Bonus</h1>
<ul>
<li><p><strong>图形用户界面</strong>: Git 的 <a
href="https://git-scm.com/downloads/guis">图形用户界面客户端</a>
有很多，但是我们自己并不使用这些图形用户界面的客户端，我们选择使用命令行接口</p></li>
<li><p><strong>Shell 集成</strong>: 将 Git 状态集成到您的 shell
中会非常方便。(<a
href="https://github.com/olivierverdier/zsh-git-prompt">zsh</a>, <a
href="https://github.com/magicmonty/bash-git-prompt">bash</a>)。<a
href="https://github.com/ohmyzsh/ohmyzsh">Oh My
Zsh</a>这样的框架中一般以及集成了这一功能</p></li>
<li><p><strong>编辑器集成</strong>: 和上面一条类似，将 Git
集成到编辑器中好处多多。<a
href="https://github.com/tpope/vim-fugitive">fugitive.vim</a> 是 Vim
中集成 GIt 的常用插件</p></li>
<li><p><strong>工作流</strong>:
我们已经讲解了数据模型与一些基础命令，但还没讨论到进行大型项目时的一些惯例
( 有<a
href="https://nvie.com/posts/a-successful-git-branching-model/">很多</a>
<a
href="https://www.endoflineblog.com/gitflow-considered-harmful">不同的</a>
<a
href="https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow">处理方法</a>)</p></li>
<li><p><strong>GitHub</strong>: Git 并不等同于 GitHub。 在 GitHub
中您需要使用一个被称作<a
href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests">拉取请求（pull
request）</a>的方法来向其他项目贡献代码</p></li>
<li><p><strong>其他 Git 提供商</strong>: GitHub 并不是唯一的。还有像 <a
href="https://about.gitlab.com/">GitLab</a> 和 <a
href="https://bitbucket.org/">BitBucket</a> 这样的平台。</p></li>
<li><p>良好的git提交消息(设置用于git的编辑器)</p>
<ul>
<li><p><a
href="https://cbea.ms/git-commit/#separate">用空行将主题与正文分开</a>:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git log --oneline #只打印出主题行</span><br><span class="line">git shortlog #按用户提交哪些组，再次仅显示主题行以简洁明了</span><br></pre></td></tr></table></figure></li>
<li><p><a href="https://cbea.ms/git-commit/#limit-50">将主题行限制为 50
个字符</a>（make sure less than 72 characters）</p></li>
<li><p><a
href="https://cbea.ms/git-commit/#capitalize">将主题行大写</a></p></li>
<li><p><a
href="https://cbea.ms/git-commit/#end">不要以句点结束主题行</a></p></li>
<li><p><a
href="https://cbea.ms/git-commit/#imperative">在主题行中使用命令式语气</a>:祈使句</p></li>
<li><p><a href="https://cbea.ms/git-commit/#wrap-72">将正文包装为 72
个字符</a>：It`s easy to configure Vim</p></li>
<li><p><a
href="https://cbea.ms/git-commit/#why-not-how">使用正文来解释什么和为什么与如何</a></p></li>
</ul></li>
</ul>
<h1 id="resources">Resources</h1>
<ul>
<li><a href="https://git-scm.com/book/en/v2">Pro Git</a>
，<strong>强烈推荐</strong>！学习前五章的内容可以教会您流畅使用 Git
的绝大多数技巧，因为您已经理解了 Git
的数据模型。后面的章节提供了很多有趣的高级主题。（<a
href="https://git-scm.com/book/zh/v2">Pro Git 中文版</a>）；</li>
<li><a href="https://ohshitgit.com/">Oh Shit, Git!?!</a>
，简短的介绍了如何从 Git 错误中恢复；</li>
<li><a
href="https://eagain.net/articles/git-for-computer-scientists/">Git for
Computer Scientists</a> ，简短的介绍了 Git
的数据模型，与本文相比包含较少量的伪代码以及大量的精美图片；</li>
<li><a href="https://jwiegley.github.io/git-from-the-bottom-up/">Git
from the Bottom Up</a>详细的介绍了 Git
的实现细节，而不仅仅局限于数据模型。好奇的同学可以看看；</li>
<li><a
href="https://smusamashah.github.io/blog/2017/10/14/explain-git-in-simple-words">How
to explain git in simple words</a>；</li>
<li><a href="https://learngitbranching.js.org/">Learn Git Branching</a>
通过基于浏览器的游戏来学习 Git ；</li>
</ul>
<h1 id="references">References</h1>
<ul>
<li><a
href="https://missing-semester-cn.github.io/2020/version-control/">版本控制(Git)
· the missing semester of your cs education
(missing-semester-cn.github.io)</a></li>
<li><a
href="https://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html">tbaggery
- A Note About Git Commit Messages</a></li>
<li><a href="https://cbea.ms/git-commit/">How to Write a Git Commit
Message (cbea.ms)</a></li>
<li><a href="https://learngitbranching.js.org/?locale=zh_CN">Learn Git
Branching</a></li>
</ul>
]]></content>
      <categories>
        <category>CS</category>
      </categories>
      <tags>
        <tag>CS</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>FreeRTOS（1）</title>
    <url>/2023/08/27/FreeRTOS%EF%BC%881%EF%BC%89/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following
哈工深上传到B站的电控组培训来入门robomaster电控组，我购买了普中科技玄武套餐开发板作为硬件。</p>
<p>本篇介绍我学习FreeRTOS的见闻，自己看FreeRTOS中文参考手册进行琢磨。</p>
<p>FreeRTOS(1)——任务管理</p>
<blockquote>
<p>Tips:抱歉托更，最近有点懒，检讨！</p>
</blockquote>
<span id="more"></span>
<h1 id="任务管理">任务管理</h1>
<h2 id="任务函数">任务函数</h2>
<p>任务是由 C 语言函数实现的。唯一特别的只是任务的函数原型，其必须返回
void，而且带有一个 void 指针参数。</p>
<p>任务函数原型：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void ATaskFunction( void *pvParametera);</span><br></pre></td></tr></table></figure>
<p>典型的任务函数结构：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void ATaskFunction( void *pvParametera)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">	/* 可以像普通函数一样定义变量。用这个函数创建的每个任务实例都有一个属于自己的iVarialbleExample变</span><br><span class="line">量。但如果iVariableExample被定义为static，这一点则不成立 – 这种情况下只存在一个变量，所有的任务实</span><br><span class="line">例将会共享这个变量。 */</span><br><span class="line">    int iVariableExample = 0;</span><br><span class="line">    /* 任务通常实现在一个死循环中。 */</span><br><span class="line">    for( ;; )</span><br><span class="line">    &#123;</span><br><span class="line">    /* 完成任务功能的代码将放在这里。 */</span><br><span class="line">    &#125;</span><br><span class="line">    /* 如果任务的具体实现会跳出上面的死循环，则此任务必须在函数运行完之前删除。传入NULL参数表示删除</span><br><span class="line">    的是当前任务 */</span><br><span class="line">    vTaskDelete( NULL );</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>每个任务都是在自己权限范围内的一个小程序。其具有程序入口，通常会运行在一个死循环中，也不会退出。</p>
<p>FreeRTOS 任务不允许以任何方式从实现函数中返回——它们绝不能有一条
”return”
语句，也不能执行到函数末尾。如果一个任务不再需要，可以显式地将其删除。</p>
<h2 id="顶层任务状态">顶层任务状态</h2>
<p>运行状态+非运行状态（有很多子状态，后面会介绍）</p>
<p>如果运行应用程序的微控制器只有一个核(core)，那么在任意给定时间，实际上只会有一个任务被执行。</p>
<ul>
<li><p>任务从非运行态转移到运行态被称为”切换入或切入(switched
in)”或”交换入(swapped in)”。</p></li>
<li><p>任务从运行态转移到非运行态被称为”切换出或切出(switched
out)”或”交换出(swapped out)”。</p></li>
</ul>
<blockquote>
<p>Notes:FreeRTOS 的调度器是能让任务切入切出的唯一实体。</p>
</blockquote>
<h2 id="创建任务">创建任务</h2>
<p>API：<code>xTaskCreate();</code></p>
<p>很复杂，参数很多</p>
<p>任务的实现放在任务函数中，main()函数只是简单地创建这两个任务，然后启动调度器执行任务。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int main( void )</span><br><span class="line">&#123;</span><br><span class="line">    /* 创建第一个任务。 需要说明的是一个实用的应用程序中应当检测函数xTaskCreate()的返回值，以确保任</span><br><span class="line">    务创建成功。 */</span><br><span class="line">    xTaskCreate( vTask1, /* 指向任务函数的指针 */</span><br><span class="line">        &quot;Task 1&quot;, /* 任务的文本名字，只会在调试中用到 */</span><br><span class="line">        1000, /* 栈深度 – 大多数小型微控制器会使用的值会比此值小得多 */</span><br><span class="line">        NULL, /* 没有任务参数 */</span><br><span class="line">        1, /* 此任务运行在优先级1上. */</span><br><span class="line">        NULL ); /* 不会用到任务句柄 */</span><br><span class="line">    /* Create the other task in exactly the same way and at the same priority. */</span><br><span class="line">    xTaskCreate( vTask2, &quot;Task 2&quot;, 1000, NULL, 1, NULL );</span><br><span class="line">    /* 启动调度器，任务开始执行 */</span><br><span class="line">    vTaskStartScheduler();</span><br><span class="line">    /* 如果一切正常， main()函数不应该会执行到这里。但如果执行到这里，很可能是内存堆空间不足导致空闲任务无法创建。第五章有讲述更多关于内存管理方面的信息 */</span><br><span class="line">    for( ;; );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:两个任务在同时运行，但实际上这两个任务运行在同一个处理器上，所以不可能会同时运行。事实上这两个任务都迅速地进入与退出运行态。由于这两个任务运行在同一个处理器上，所以会平等共享处理器时间(如果只有一个core的话)</p>
</blockquote>
<p>Note:也可以在main中创建task1，在task1中创建task2</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void vTask1( void *pvParameters )</span><br><span class="line">&#123;</span><br><span class="line">    const char *pcTaskName = &quot;Task 1 is running\r\n&quot;;</span><br><span class="line">    volatile unsigned long ul;</span><br><span class="line">    /* 如果已经执行到本任务的代码，表明调度器已经启动。在进入死循环之前创建另一个任务。 */</span><br><span class="line">    xTaskCreate( vTask2, &quot;Task 2&quot;, 1000, NULL, 1, NULL );</span><br><span class="line">    //后面代码省略</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Notes:也可以用相同任务函数，创建任务时不同的任务传递不同的参数即可</p>
</blockquote>
<h2 id="任务优先级">任务优先级</h2>
<p>xTaskCreate() API 函数的参数 uxPriority
为创建的任务赋予了一个初始优先级。这个侁先级可以在调度器启动后调用
vTaskPrioritySet() API 函数进行修改。</p>
<p>优先级数目由文件
FreeRTOSConfig.h中的常量<strong>configMAX_PRIORITIES</strong> 配置</p>
<blockquote>
<p>Tips:值越大占用内存越多，所以常设为满足需要的最小值。</p>
<p>保证最大设计弹性：让任务共享同一个优先级</p>
</blockquote>
<p>低优先级号表示任务的优先级低，优先级号 0
表示最低优先级。有效的优先级号范围从 0 到(configMAX_PRIORITES – 1)。</p>
<p><strong>时间片</strong>：</p>
<p>时间片由文件
FreeRTOSConfig.h中的常量<strong>configTICK_RATE_HZ</strong>配置</p>
<p>要能够选择下一个运行的任务，调度器需要在每个时间片的结束时刻运行自己本身。一个称为心跳(tick，or时钟滴答)中断的周期性中断用于此目的。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230827111603709.png"
alt="image-20230827111603709" />
<figcaption aria-hidden="true">image-20230827111603709</figcaption>
</figure>
<blockquote>
<p>Tips:FreeRTOS API 函数调用中指定的时间总是以ticks中断为单位。常量
portTICK_RATE_MS
用于将以心跳为单位的时间值转化为以毫秒为单位的时间值。有效精度依赖于系统心跳频率。</p>
</blockquote>
<h2 id="扩充非运行态">扩充“非运行态”</h2>
<p>事件驱动任务</p>
<ul>
<li>阻塞状态：一个任务正在等待某个事件——blocked阻塞态
<ul>
<li>定时(时间相关)事件——这类事件可以是延迟到期或是绝对时间到点。比如说某个任务可以进入阻塞态以延迟10ms。（利用blocked进行延时）</li>
<li>同步事件——源于其它任务或中断的事件。比如说，某个任务可以进入阻塞态以等待队列中有数据到来。同步事件囊括了所有板级范围内的事件类型。</li>
</ul></li>
</ul>
<blockquote>
<p>Tips:任务可以在进入阻塞态以等待同步事件时指定一个等待超时时间，这样可以有效地实现阻塞状态下同时等待两种类型的事件。</p>
</blockquote>
<ul>
<li>挂起状态：suspended,处于挂起状态的任务对调度器而言是不可见的。
<ul>
<li>vTaskSuspend() 进入挂起状态</li>
<li>vTaskResume() 或vTaskResumeFromISR() 唤醒挂起状态任务</li>
</ul></li>
<li>就绪状态：ready</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230827113353749.png"
alt="完整的状态转移图" />
<figcaption aria-hidden="true">完整的状态转移图</figcaption>
</figure>
<p><strong>延时：</strong></p>
<p><code>vTaskDelay()</code>：</p>
<p>使用空循环进行延时非常不好，可能将其他任务starved，也会造成MCU的浪费，我们用<code>vTaskDelay()</code>
API 函数来代替空循环。</p>
<p>调用该延迟函数的任务将进入阻塞态，经延迟指定的心跳周期数后，再转移到就绪态。（即调用改函数延时期间会执行其他任务）</p>
<blockquote>
<p>Tips:接收参数是ticks，我们用常数 portTICK_RATE_MS
将以毫秒为单位的时间值转换为以心跳周期为单位的时间值</p>
</blockquote>
<p>实现250ms的延时：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vTaskDelay( 250 / portTICK_RATE_MS );  </span><br></pre></td></tr></table></figure>
<p><code>vTaskDelayUntil</code>：</p>
<p>（假定用于实现某个任务以固定频率周期性执行）比调用
vTaskDelay()可以实现更精确的周期性,保证它们具有固定的执行频率</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void vTaskDelayUntil( portTickType * pxPreviousWakeTime, portTickType xTimeIncrement );  </span><br></pre></td></tr></table></figure>
<ul>
<li>pxPreviousWakeTime：保存了任务上一次离开阻塞态(被唤醒)的时刻。这个时刻被用作一个参考点来计算该任务下一次离开阻塞态的时刻。</li>
</ul>
<blockquote>
<p>Tips:只用一次初始化，该参数会在函数调用过程中自动更新。</p>
</blockquote>
<ul>
<li>xTimeIncrement：假定用于实现某个任务以固定频率周期性执行，该频率则由xTimeIncrement指定</li>
</ul>
<blockquote>
<p>Tips:接收参数是ticks，我们用常数 portTICK_RATE_MS
将以毫秒为单位的时间值转换为以心跳周期为单位的时间值</p>
</blockquote>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230827115149396.png"
alt="实例" />
<figcaption aria-hidden="true">实例</figcaption>
</figure>
<h2 id="空闲任务">空闲任务</h2>
<p>处理器总是需要代码来执行——所以至少要有一个任务处于运行态。为了保证这一点，当调用
vTaskStartScheduler()时，调度器会自动创建一个空闲任务（优先级0，最低）。
空闲任务是一个非常短小的循环，总是可以运行的。</p>
<p><strong>空闲任务钩子函数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void vApplicationIdleHook( void );</span><br></pre></td></tr></table></figure>
<p>空闲任务钩子函数(或称回调， hook, or
call-back)，可以直接在空闲任务中添加应用程序相关的功能。空闲任务钩子函数会被空闲任务每循环一次就自动调用一次。</p>
<p>FreeRTOSConfig.h 中的配置常量 configUSE_IDLE_HOOK 必须定义为
1，这样空闲任务钩子函数才会被调用。</p>
<p>常被用于：</p>
<ul>
<li><p>执行低优先级，后台或需要不停处理的功能代码。</p></li>
<li><p>测试处系统处理裕量(空闲任务只会在所有其它任务都不运行时才有机会执行，所以测出空闲任务占用的处理时间就可以清楚的知道系统有多少富余的处理时间)。</p></li>
<li><p>将处理器配置到低功耗模式——提供一种自动省电方法，使得在没有任何应用功能需要处理的时候，系统自动进入省电模式。</p></li>
</ul>
<p>hook实现限制：</p>
<ul>
<li><p>绝不能阻塞或挂起。</p>
<blockquote>
<p>Tips:空闲任务只会在其它任务都不运行时才会被执行(除非有应用任务共享空闲任务优先级)。以任何方式阻塞空闲任务都可能导致没有任务能够进入运行态！</p>
</blockquote></li>
<li><p>如果应用程序用到了 vTaskDelete() API
函数，则空闲钩子函数必须能够尽快返回。因为在任务被删除后，空闲任务负责回收内核资源。如果空闲任务一直运行在钩子函数中，则无法进行回收工作</p></li>
</ul>
<h2 id="改变任务优先级">改变任务优先级</h2>
<p><code>vTaskPrioritySet()</code>可以用于在调度器启动后改变任何任务的优先级</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void vTaskPrioritySet( xTaskHandle pxTask, unsigned portBASE_TYPE uxNewPriority );</span><br><span class="line">//pxTask是任务句柄，Tips：任务中可以传入Null来修改自己的优先级</span><br><span class="line">//uxNewPriority设置新的优先级</span><br></pre></td></tr></table></figure>
<p><code>uxTaskPriorityGet()</code> API 函数用于查询一个任务的优先级</p>
<blockquote>
<p>Tips:也可以在函数中传入null来查询自己的优先级</p>
</blockquote>
<h2 id="删除任务">删除任务</h2>
<p>任务可以使用API函数
<code>vTaskDelete()</code>删除自己或其它任务。空闲任务的责任是要将分配给已删除任务的内存释放掉。</p>
<blockquote>
<p>Tips:所以使用该API的任务不能让空闲任务starved</p>
</blockquote>
<blockquote>
<p>Notes:只有内核为任务分配的内存空间才会在任务被删除后自动回收。任务自己占用的内存或资源需要由应用程序自己显式地释放(有点不太理解)</p>
</blockquote>
<h2 id="调度算法">调度算法</h2>
<p>Notes:<通用规则>完成硬实时功能的任务优先级会高于完成软件时功能任务的优先级</p>
<ul>
<li><p><strong>固定优先级抢占式调度</strong>：之前介绍的即为这种调度方法</p></li>
<li><p><strong>选择任务优先级</strong></p>
<p>单调速率调度(Rate Monotonic Scheduling,
RMS)是一种常用的优先级分配技术。其根据任务周期性执行的速率来分配一个唯一的优先级。具有最高周期执行频率的任务赋予高最优先级；具有最低周期执行频率的任务赋予最低优先级。这种优先级分配方式被证明了可以最大化整个应用程序的可调度性(schedulability)</p>
<blockquote>
<p>TIps:但是运行时间不定以及并非所有任务都具有周期性，会使得对这种方式的全面计算变得相当复杂。</p>
</blockquote></li>
<li><p><strong>协作式调度</strong></p>
<p>采用一个纯粹的协作式调度器，只可能在运行态任务进入阻塞态或是运行态任务显式调用
taskYIELD()时，才会进行上下文切换。任务永远不会被抢占，而具有相同优先级的任务也不会自动共享处理器时间。</p>
<blockquote>
<p>Tips:simple but slow</p>
</blockquote></li>
<li><p><strong>混合调度</strong></p>
<p>这需要在中断服务例程中显式地进行上下文切换，从而允许同步事件产生抢占行为，但时间事件却不行。这样做的结果是得到了一个没有时间片机制的抢占式系统。或许这正是所期望的，因为获得了效率，并且这也是一种常用的调度器配置。</p></li>
</ul>
<h1 id="references">References</h1>
<ul>
<li>哈工深电控内训</li>
<li>FreeRTOS中文参考手册</li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>robomaster</tag>
        <tag>嵌入式</tag>
      </tags>
  </entry>
  <entry>
    <title>Flash入门</title>
    <url>/2023/08/24/Flash%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following
哈工深上传到B站的电控组培训来入门robomaster电控组，我购买了普中科技玄武套餐开发板作为硬件。</p>
<p>本篇介绍我学习Flash的见闻</p>
<span id="more"></span>
<h1 id="flash">FLASH</h1>
<p>不需配置任何东西，只需要时钟即可</p>
<p>RS232-----TTL</p>
<h2 id="简介">简介</h2>
<p>一个32位地址指向1个字节，我们常说的flash空间，多少多少K，指的是多少多少K
byte。</p>
<p>Flash
中文名字叫闪存，是一种长寿命的非易失性（断电数据不丢失）的存储器。可以对称为块的存储器单元块进行擦写和再编程，在进行写入操作之前必须先执行擦除。</p>
<p>STM32的FLASH地址起始于 0x08000000
，结束地址是0x08000000加上芯片实际的FLASH大小，不同的芯片FLASH大小不同。</p>
<blockquote>
<p>Tips:一般情况下，程序文件是从 0x0800 0000
地址写入，这个是STM32开始执行的地方，0x0800
0004是STM32的中断向量表的起始地址。（我们可以手动更改）</p>
</blockquote>
<p>RAM起始地址是 0x20000000
，结束地址是0x20000000加上芯片的RAM大小，不同的芯片RAM也不同。</p>
<p>Flash中的内容一般用来存储代码和一些定义为const的数据，断电不丢失，且不会保存调试中改变的数据；RAM可以理解为内存，用来存储代码运行时的数据，变量等等，掉电数据丢失。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230824221707146.png"
alt="image-20230824221707146" />
<figcaption aria-hidden="true">image-20230824221707146</figcaption>
</figure>
<p>STM32将外设都映射为地址，操作外设也即操作地址。</p>
<blockquote>
<p>Tips:stm32的外设地址从0x4000
0000开始，可以看到在库文件中，是通过基于0x4000
0000地址的偏移量来操作寄存器以及外设的。</p>
</blockquote>
<h3 id="单片机执行流程">单片机执行流程</h3>
<p>单片机复位后，从 0x08000004
取出复位中断的地址，并且跳转到复位中断程序，中断执行完之后会跳到我们的
main 函数， main
函数里边一般是一个死循环，进去后就不会再退出，当有中断发生的时候，单片机将指针强制跳转回中断向量表，然后根据中断源进入对应的中断函数，执行完中断函数之后，再次返回
main 函数中。</p>
<h3 id="启动模式选择管脚">启动模式选择管脚</h3>
<p>BOOT1 BOOT0 启动模式 说明</p>
<ul>
<li><p>X 0 用户闪存存储器du 用户闪存存储器被选为启动区域</p></li>
<li><p>0 1 系统zhi存储器 系统存储器被选为启动区域</p></li>
<li><p>1 1 内嵌SRAM 内嵌SRAM被选为启动区域</p></li>
</ul>
<p>根据选定的启动模式，主闪存存储器、系统存储器或SRAM可以按照以下方式访问：</p>
<p>● 从主闪存存储器启动：主闪存存储器被映射到启动空间(0x0000
0000)，但仍然能够在它原有的地址(0x0800
0000)访问它，即闪存存储器的内容可以在两个地址区域访问，0x0000
0000或0x0800 0000。</p>
<p>● 从系统存储器启动：系统存储器被映射到启动空间(0x0000
0000)，但仍然能够在它原有的地址(0x1FFF F000)访问它。</p>
<p>● 从内置SRAM启动：只能在0x2000 0000开始的地址区访问SRAM。</p>
<h2 id="内部构造">内部构造</h2>
<p>按照不同容量，存储器组织成32个1K字节/页(小容量)、
128个1K字节/页(中容量)、
256个2K字节/页(大容量)的主存储器块和一个信息块。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230824222249830.png"
alt="image-20230824222249830" />
<figcaption aria-hidden="true">image-20230824222249830</figcaption>
</figure>
<p>闪存存储器被组织成32位宽的存储器单元，可以存放代码和数据常数。每一个STM32F10xxx微控制器的闪存模块都有一个特定的启始地址。</p>
<p>信息块分为两个部分：</p>
<ul>
<li><p>系统存储器是用于存放在系统存储器自举模式下的启动程序bootloader(用户无法更改)，这个区域只保留给ST使用，启动程序使用USART1串行接口实现对闪存存储器的编程；
ST在生产线上对这个区域编程并锁定以防止用户擦写</p></li>
<li><p>选择字节： 选项字节存储芯片的配置信息及对主存储块的保护信息。
用于配置 FLASH 的读写保护、电源管理中的 BOR
级别、软件/硬件看门狗等功能，这部分共 32 字节。可以通过修改
FLASH的选项控制寄存器修改。</p></li>
</ul>
<p>闪存存储器有两种保护方式防止非法的访问(读、写、擦除)：</p>
<ul>
<li>页写入保护</li>
<li>读出保护</li>
</ul>
<p>在执行闪存写操作时，任何对闪存的读操作都会锁住总线，在写操作完成后读操作才能正确地进行。</p>
<blockquote>
<p>Tips:即在进行写或擦除操作时，不能进行代码或数据的读取操作。</p>
</blockquote>
<p>进行闪存编程操作时(写或擦除)，必须打开内部的RC振荡器(HSI)。</p>
<blockquote>
<p>Tips:CubeMX默认打开</p>
</blockquote>
<p>闪存存储器可以用ICP或IAP方式编程。</p>
<ul>
<li>IAP(In-Application Programming)：
IAP是在用户程序运行时对闪存微控制器中存储器重新编程。</li>
<li>ICP(In-Circuit Programming)：
ICP是在芯片安装到用户应用板上后，通过JTAG协议对闪存微控制器中存储器编程</li>
</ul>
<h2 id="flash的读写操作">FLASH的读/写操作</h2>
<h3 id="读操作">读操作</h3>
<p>内置闪存模块可以在通用地址空间直接寻址，任何32位数据的读操作都能访问闪存模块的内容并得到相应的数据。（读操作较为简单）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uint32_t Robot_Num_Flash_Add = 0x08005000;</span><br><span class="line">ID_Num = *(__IO uint16_t*)( Robot_Num_Flash_Add ); </span><br><span class="line">//*(__IO uint16_t *)是读取该地址的参数值,其值为16位数据,一次读取两个字节，*(__IO uint32_t *)就一次读4个字节</span><br><span class="line">printf(&quot;ID_num:0x%x\r\n&quot;, ID_Num);</span><br></pre></td></tr></table></figure>
<h3 id="写操作">写操作</h3>
<p>闪存编程和擦除控制器(FPEC)处理闪存的编程和擦除操作。它包括7个32位的寄存器：</p>
<ul>
<li>FPEC键寄存器(FLASH_KEYR)</li>
<li>选择字节键寄存器(FLASH_OPTKEYR)闪存控制寄存器(FLASH_CR)</li>
<li>闪存状态寄存器(FLASH_SR)</li>
<li>闪存地址寄存器(FLASH_AR)</li>
<li>选择字节寄存器(FLASH_OBR)</li>
<li>写保护寄存器(FLASH_WRPR)</li>
</ul>
<p>复位后，
FPEC模块是被保护的，不能写入FLASH_CR寄存器；通过写入特定的序列到FLASH_KEYR寄存器可以打开FPEC模块，这个特定的序列是在FLASH_KEYR写入两个键值(KEY1和KEY2)；错误的操作序列都会在下次复位前锁死FPEC模块和FLASH_CR寄存器。</p>
<ul>
<li>KEY1: 0x45670123</li>
<li>KEY2: 0xCDEF89AB</li>
</ul>
<p>写入错误的键序列还会产生总线错误；总线错误发生在第一次写入的不是KEY1，或第一次写入的是KEY1但第二次写入的不是KEY2时；
FPEC模块和FLASH_CR寄存器可以由程序设置FLASH_CR寄存器中的LOCK位锁住，这时可以通过在FLASH_KEYR中写入正确的键值对FPEC解锁。</p>
<h4 id="闪存擦除">闪存擦除</h4>
<p>闪存可以按页擦除，也可以整片擦除</p>
<h5 id="页擦除"><strong>页擦除</strong></h5>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230824232659185.png"
alt="流程" />
<figcaption aria-hidden="true">流程</figcaption>
</figure>
<p>闪存的任何一页都可以通过FPEC的页擦除功能擦除；擦除一页应遵守下述过程：</p>
<ul>
<li><p>检查FLASH_SR寄存器的BSY位，以确认没有其他正在进行的闪存操作；</p></li>
<li><p>设置FLASH_CR寄存器的PER位为1 ；</p></li>
<li><p>用FLASH_AR寄存器选择要擦除的页；</p></li>
<li><p>设置FLASH_CR寄存器的STRT位为 1 ；</p></li>
<li><p>等待BSY位变为 0 ；</p></li>
<li><p>读出被擦除的页并做验证。（没必要）</p></li>
</ul>
<p><strong>整片擦除</strong></p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230824233016388.png"
alt="整片擦除流程" />
<figcaption aria-hidden="true">整片擦除流程</figcaption>
</figure>
<p>可以用整片擦除功能擦除所有用户区的闪存，信息块不受此操作影响。建议使用下述过程：</p>
<ul>
<li><p>检查FLASH_SR寄存器的BSY位，以确认没有其他正在进行的闪存操作；</p></li>
<li><p>设置FLASH_CR寄存器的MER位为 1 ；</p></li>
<li><p>设置FLASH_CR寄存器的STRT位为 1 ；</p></li>
<li><p>等待BSY位变为 0 ；</p></li>
<li><p>读出所有页并做验证。</p></li>
</ul>
<p><strong>主闪存编程</strong></p>
<p>对主闪存编程每次可以写入16位。即在一个闪存地址写入一个半字将启动一次编程；写入任何非半字的数据，
FPEC都会产生总线错误。</p>
<blockquote>
<p>Tips:在编程过程中，任何读写闪存的操作都会使CPU暂停（即改代码）
，直到此次闪存编程结束。</p>
</blockquote>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230824233303404.png"
alt="image-20230824233303404" />
<figcaption aria-hidden="true">image-20230824233303404</figcaption>
</figure>
<p>标准的闪存编程顺序如下：</p>
<ul>
<li><p>检查FLASH_SR寄存器的BSY位，以确认没有其他正在进行的编程操作；</p></li>
<li><p>设置FLASH_CR寄存器的PG位为 1 ；</p></li>
<li><p>在指定的地址写入要编程的半字；</p></li>
<li><p>等待BSY位变为 0 ；</p></li>
<li><p>读出写入的地址并验证数据。</p></li>
</ul>
<p>FPEC先读出指定地址的内容并检查它是否被擦除，如未被擦除则不执行编程；如果指定的地址在FLASH_WRPR中设定为写保护，也不执行编程。</p>
<blockquote>
<p><strong>Notes</strong>:所有的编程操作结束后要锁上FLASH。</p>
</blockquote>
<h2 id="查看工程的内存分布">查看工程的内存分布</h2>
<p>通过查询应用程序编译时产生的 *.map 后缀文件，打开map
文件后，查看文件最后部分的区域，可以看到一段以 Memory Map of the image
开头的记录</p>
<h2 id="api">API</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FLASH_EraseInitTypeDef; //一个结构体的名字</span><br><span class="line">HAL_StatusTypeDef HAL_FLASH_Unlock(void);解锁</span><br><span class="line">HAL_StatusTypeDef HAL_FLASH_Lock(void);上锁</span><br><span class="line">HAL_StatusTypeDef HAL_FLASHEx_Erase(FLASH_EraseInitTypeDef *pEraseInit, uint32_t *PageError);</span><br><span class="line">//Perform a mass erase or erase the specified FLASH memory pages</span><br><span class="line"></span><br><span class="line">HAL_StatusTypeDef HAL_FLASH_Program(uint32_t TypeProgram, uint32_t Address,uint64_t Data);</span><br><span class="line">//Program halfword, word or double word at a specified address</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="实验">实验</h1>
<p>FLASH读写实验</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/*FLASH写入程序*/</span><br><span class="line">void writeFlash(uint32_t addr, uint32_t WriteFlashData)</span><br><span class="line">&#123;</span><br><span class="line">    /* 1/4解锁FLASH*/</span><br><span class="line">    HAL_FLASH_Unlock();</span><br><span class="line">    </span><br><span class="line">    /* 2/4擦除FLASH*/</span><br><span class="line">    /*初始化FLASH_EraseInitTypeDef*/</span><br><span class="line">    FLASH_EraseInitTypeDef FlashSet;</span><br><span class="line">    FlashSet.TypeErase = FLASH_TYPEERASE_PAGES;</span><br><span class="line">    FlashSet.Banks = FLASH_BANK_1;</span><br><span class="line">    FlashSet.PageAddress = addr;</span><br><span class="line">    FlashSet.NbPages = 1;</span><br><span class="line">    </span><br><span class="line">    /*设置PageError，调用擦除函数*/</span><br><span class="line">    uint32_t PageError = 0;</span><br><span class="line">    HAL_FLASHEx_Erase(&amp;FlashSet, &amp;PageError);</span><br><span class="line">    </span><br><span class="line">    /* 3/4对FLASH烧写*/</span><br><span class="line">    HAL_FLASH_Program(FLASH_TYPEPROGRAM_WORD, addr, WriteFlashData);</span><br><span class="line">    </span><br><span class="line">    /* 4/4锁住FLASH*/</span><br><span class="line">    HAL_FLASH_Lock();</span><br><span class="line">&#125; </span><br><span class="line">/*FLASH读取程序*/</span><br><span class="line">uint32_t readFlash(uint32_t addr)</span><br><span class="line">&#123;</span><br><span class="line">    uint32_t temp = *(__IO uint32_t*)(addr);</span><br><span class="line">    return temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="references">References</h1>
<ul>
<li>哈工深电控内训</li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>robomaster</tag>
        <tag>嵌入式</tag>
      </tags>
  </entry>
  <entry>
    <title>IIC-EEPROM入门</title>
    <url>/2023/08/23/IIC-EEPROM%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following
哈工深上传到B站的电控组培训来入门robomaster电控组，我购买了普中科技玄武套餐开发板作为硬件。</p>
<p>本篇介绍我学习IIC,EEPROM的见闻，并顺带介绍了J-scope软件的使用</p>
<blockquote>
<p>Tips:基本全是copy仅添加一点个人的理解和整理，再次感谢前辈的分享。</p>
</blockquote>
<span id="more"></span>
<h1 id="iic">IIC</h1>
<h2 id="简介">简介</h2>
<p>IIC（Inter－Integrated
Circuit）总线是一种由PHILIPS公司在80年代开发的两线式串行总线，用于连接微控制器及其外围设备。它是<strong>半双工</strong>多设备通信方式。</p>
<ul>
<li><p>IIC总线最主要的优点是其简单性和有效性。由于接口直接在组件之上，因此IIC总线占用的空间非常小，减少了电路板的空间和芯片管脚的数量，降低了互联成本。总线的长度可高达25英尺，并且能够以10Kbps的最大传输速率支持40个组件。</p></li>
<li><p>IIC总线的另一个优点是，它支持<strong>多主控(multimastering)</strong>，
其中任何能够进行发送和接收的设备都可以成为主总线。一个主控能够控制信号的传输和时钟频率。</p></li>
</ul>
<blockquote>
<p>Tips:当然，在任何时间点上只能有一个主控。</p>
</blockquote>
<p>IIC串行总线一般有两根信号线，一根是双向的数据线SDA，另一根是时钟线SCL，其时钟信号是由主控器件产生。所有接到IIC总线设备上的串行数据SDA都接到总线的SDA上，各设备的时钟线SCL接到总线的SCL上。对于并联在一条总线上的每个IC都有唯一的地址。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823150431794.png"
alt="image-20230823150431794" />
<figcaption aria-hidden="true">image-20230823150431794</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823144159053.png"
alt="image-20230823144159053" />
<figcaption aria-hidden="true">image-20230823144159053</figcaption>
</figure>
<blockquote>
<p>Tips:高阻态，有一个低电平信号全为低电平</p>
</blockquote>
<p>一般情况下，数据线SDA和时钟线SCL都是处于<strong>上拉电阻状态</strong>。</p>
<blockquote>
<p>Tips:因为在总线空闲状态时，这两根线一般被上面所接的上拉电阻拉高，保持着高电平。</p>
</blockquote>
<p>目前绝大多数的MCU都附带IIC总线接口，STM32也不例外。但我们不使用STM32的硬件IIC，而是通过<strong>软件的方式来模拟</strong>（会占用MCU），因为STM32的硬件IIC非常复杂，更重要的是它并不稳定，故不推荐使用。</p>
<ul>
<li>总线上发送数据的器件被称作发送器</li>
<li>接收数据的器件被称作接收器</li>
<li>控制信息交换的器件被称作主器件</li>
<li>受主器件控制的器件则被称作从器件</li>
<li>主器件产生串行时钟SCL, 控制总线的访问状态、产生START和STOP条件</li>
</ul>
<h2 id="iic时序图详解">IIC时序图详解</h2>
<p>IIC总线在传输数据的过程中一共有三种类型信号，分别为：开始信号、结束信号和应答信号。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823144440609.png"
alt="image-20230823144440609" />
<figcaption aria-hidden="true">image-20230823144440609</figcaption>
</figure>
<h3 id="空闲状态">空闲状态</h3>
<p>当IIC总线的数据线SDA和时钟线SCL两条信号线同时处于高电平时，规定为总线的空闲状态。此时各个器件的输出级场效应管均处在截止状态，即释放总线，由两条信号线各自的上拉电阻把电平拉高。</p>
<h3 id="起始信号与停止信号">起始信号与停止信号</h3>
<ul>
<li><p>起始信号：当时钟线SCL为高期间，数据线SDA由高到低的跳变；启动信号是一种<strong>电平跳变</strong>时序信号，而不是一个电平信号；</p></li>
<li><p>停止信号：当时钟线SCL为高期间，数据线SDA由低到高的跳变；停止信号也是一种<strong>电平跳变</strong>时序信号，而不是一个电平信号。</p></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823144601476.png"
alt="image-20230823144601476" />
<figcaption aria-hidden="true">image-20230823144601476</figcaption>
</figure>
<h3 id="应答信号">应答信号</h3>
<p>发送器每发送一个字节（8个bit），就在时钟脉冲9期间释放数据线，由接收器反馈一个应答信号。</p>
<ul>
<li><p>应答信号为低电平时，规定为有效应答位（ACK，简称应答位），表示接收器已经成功地接收了该字节；</p></li>
<li><p>应答信号为高电平时，规定为非应答位（NACK），一般表示接收器接收该字节没有成功。</p></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823144726977.png"
alt="接收器是其他设备" />
<figcaption aria-hidden="true">接收器是其他设备</figcaption>
</figure>
<p>对于反馈有效应答位ACK的要求是：接收器在第9个时钟脉冲之前的低电平期间将数据线SDA拉低，并且确保在该时钟的高电平期间为稳定的低电平。</p>
<p>如果接收器是主控器，则在它收到最后一个字节后，发送一个NACK信号，以通知被控发送器结束数据发送，并释放数据线SDA，以便主控接收器发送一个停止信号P。</p>
<h3 id="数据有效性">数据有效性</h3>
<p>IIC总线进行数据传送时，时钟信号为高电平期间，数据线上的数据必须保持稳定；只有在时钟线上的信号为低电平期间，数据线上的高电平或低电平状态才允许变化。</p>
<blockquote>
<p>Tips:即数据在时钟线SCL的上升沿到来之前就需准备好。并在在下降沿到来之前必须稳定。</p>
</blockquote>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823145103033.png"
alt="image-20230823145103033" />
<figcaption aria-hidden="true">image-20230823145103033</figcaption>
</figure>
<h3 id="数据的传达">数据的传达</h3>
<p>每个时钟脉冲传送一位数据（或同步控制），即在SCL串行时钟的配合下，在SDA上逐位地串行传送每一位数据。数据位的传输是边沿触发。</p>
<p>SCL为高时SDA必须保持稳定，因为此时SDA的改变被认为是控制信号。</p>
<h3 id="延时时间">延时时间</h3>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823145157628.png"
alt="image-20230823145157628" />
<figcaption aria-hidden="true">image-20230823145157628</figcaption>
</figure>
<h3 id="iic总线的数据传送">IIC总线的数据传送</h3>
<p>IIC总线上的每一个设备都可以作为主设备或者从设备，而且每一个设备都会对应一个唯一的地址（地址通过物理接地或者拉高），主从设备之间就通过这个地址来确定与哪个器件进行通信。</p>
<ul>
<li>主设备在传输有效数据之前要先指定从设备的地址，地址指定的过程和上面数据传输的过程一样（大多数从设备的地址是7位的）</li>
<li>然后协议规定再给地址添加一个最低位用来表示接下来数据传输的方向：
<ul>
<li>0表示主设备向从设备写数据</li>
<li>1表示主设备向从设备读数据。</li>
</ul></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823145336894.png"
alt="image-20230823145336894" />
<figcaption aria-hidden="true">image-20230823145336894</figcaption>
</figure>
<p>主设备往从设备中<strong>写数据</strong>。数据传输格式如下：</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823145510667.png"
alt="image-20230823145510667" />
<figcaption aria-hidden="true">image-20230823145510667</figcaption>
</figure>
<blockquote>
<p>Tips:淡蓝色部分表示数据由主机向从机传送，粉红色部分则表示数据由从机向主机传送。写用0来表示（高电平），读用1来表示（低电平）。</p>
</blockquote>
<p>主设备从从设备中<strong>读数据</strong>。数据传输格式如下：</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823145521220.png"
alt="image-20230823145521220" />
<figcaption aria-hidden="true">image-20230823145521220</figcaption>
</figure>
<p><strong>Notes:</strong>在从机产生响应时，主机从发送变成接收，从机从接收变成发送。之后，数据由从机发送，主机接收，每个应答由主机产生，时钟信号仍由主机产生。若主机要终止本次传输，则发送一个非应答信号，接着主机产生停止条件。</p>
<h3 id="iic仲裁">IIC仲裁</h3>
<p>如果有两个或两个以上的节点都向总线上发送启动信号并开始传送数据，这样就形成了冲突。要解决这种冲突，就要进行仲裁的判决，这就是I2C总线上的仲裁。</p>
<p>高阻态，当有2个设备同时发送数据，当发送的1和0相冲突（高阻态变为0），发送1的设备检测到不对自动退出。（和CAN差不多）</p>
<h1 id="eeprom">EEPROM</h1>
<h2 id="简介-1">简介</h2>
<p>EEPROM的全称是电可擦除可编程只读存储器（Electrically Erasable
Programmable Read-Only
Memory）。是一种非易失性存储器，它可以在不断电的情况下保持数据的完整性。EEPROM的特点是可以通过电子信号来擦除和重写其中的数据，而不需要像EPROM那样使用紫外线。EEPROM的最小擦写单位是字节，这意味着可以对单个字节进行修改，而不必擦除整个芯片。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823150140273.png"
alt="image-20230823150140273" />
<figcaption aria-hidden="true">image-20230823150140273</figcaption>
</figure>
<h2 id="器件寻址">器件寻址</h2>
<p>起始条件使能芯片读写操作后，EEPROM都要求有8位的器件地址信息:</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823151310476.png"
alt="image-20230823151310476" />
<figcaption aria-hidden="true">image-20230823151310476</figcaption>
</figure>
<p>器件地址信息由"1"、"0"序列组成，前4位如图中所示，对于所有串行EEPROM都是一样的。对于24C02/32/64,
随后3位A2、A1和A0为器件地址位，必须与硬件输入引脚保持一致。</p>
<blockquote>
<p>Tips:如上面的A0,A1,A2跟GND连接,所以为0</p>
</blockquote>
<p>对于24C04,
随后2位A2和A1为器件地址位，另1位为页地址位。A2和A1必须与硬件输入引脚保挣一致，而A0是空脚。</p>
<p>对于24C08,
随后1位A2为器件地址位，另2位为页地址位。A2必须与硬件输入引脚保持一致，而A1和A0是空脚。</p>
<p>对于24C06, 无器件地址位，3位都为页地址位，而A2、A1和A0是空脚。</p>
<p>器件地址信息的LSB为读/写操作选择位，高为读操作1，低为写操作0。</p>
<p>若比较器件地址一致，EEPROM将输出应答"0"。如果不一致，则返回到待机状态。</p>
<h1 id="实验">实验</h1>
<p>实验还是选择用硬件实现IIC，并向EEPROM写入和读出数据</p>
<h2 id="cubemx">CubeMX</h2>
<p>现在开发板原理图中找到想要使用的IIC</p>
<p>选择Fast Mode:400000Hz，其他保持默认即可</p>
<blockquote>
<p>Tips:这个实验没用任何中断，所以没有设置</p>
</blockquote>
<h2 id="code">Code</h2>
<p>哈工深提供了EEPROM库的代码，然后直接利用I2C_EEPROM_WriteBuffer()，I2C_EEPROM_ReadBuffer()两个函数来进行读写</p>
<h1 id="j-scope">J-Scope</h1>
<h2 id="简介-2">简介</h2>
<p>J-Scope是J-link的功能之一：实时分析数据并图形化显示的软件。</p>
<p>J-Scope可以以类似示波器的方式显示多个变量的值。它读取elf或axf文件并允许选择多个变量进行可视化。</p>
<p>只需将目标微控制器连接到J-Link并启动J-Scope，几个步骤即可配置J-Scope，并选择要显示的符号。</p>
<h2 id="工作模式">工作模式</h2>
<p>J-Scope主要有RTT和HSS两种工作模式。</p>
<p>RTT模式：需要用户在MCU上添加代码，有点类似串口上传数据，因为有额外的代码，所以需要占用MCU的资源。优点是速度快，缺点是需要额外的代码。</p>
<p>HSS模式：不需要用户在MCU上添加任何代码，只需要使用J_Scope加载MDK或IAR的可执行文件即可，而且可以随时链接MCU，不影响MCU的正常功能，不需要额外的资源。使用标准的SWD接口即可。优点是不需要添加代码，缺点是速度较慢，一般为1K。</p>
<figure>
<img
src="https://pic4.zhimg.com/80/v2-892c5372b0ce4dc97fee2ccd513bc327_720w.webp"
alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<blockquote>
<p>J-Scope这么强大，但是<strong>依旧取代不了</strong>通过硬件串口发送给PC虚拟示波器的软件，因为J-Scope只能读取全局变量的数据，我们使用硬件串口可以将函数的局部变量发给虚拟示波器。</p>
</blockquote>
<h1 id="references">References</h1>
<ul>
<li><p>哈工深B站视频</p></li>
<li><p><a
href="https://blog.csdn.net/qq_38410730/article/details/80312357">【STM32】IIC的基本原理（实例：普通IO口模拟IIC时序读取24C02）_Yngz_Miao的博客-CSDN博客</a></p></li>
<li><p>EEPROM存储器24C02手册(中文)：13.详细操作说明</p></li>
<li><p><a
href="https://zhuanlan.zhihu.com/p/511232168">EEPROM和Flash这样讲，我早就懂了
- 知乎 (zhihu.com)</a></p></li>
<li><p><a
href="https://zhuanlan.zhihu.com/p/413285767">Jlink之J-Scope虚拟示波器 -
知乎 (zhihu.com)</a></p></li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>robomaster</tag>
        <tag>嵌入式</tag>
      </tags>
  </entry>
  <entry>
    <title>Git进阶（1）</title>
    <url>/2023/08/10/Git%E8%BF%9B%E9%98%B6%EF%BC%881%EF%BC%89/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Git进阶（1）——了解Git是什么，Git的配置和所有 Git 基本的本地操作</p>
<p>希望通过<a href="https://git-scm.com/book/zh/v2">Git - Book
(git-scm.com)</a>+<a
href="https://learngitbranching.js.org/?locale=zh_CN">Learn Git
Branching</a>来进一步掌握Git</p>
<p><strong>Learn to love the command line. Leave the IDE
behind.</strong></p>
<span id="more"></span>
<h1 id="git是什么">Git是什么</h1>
<h2 id="git特点">Git特点</h2>
<ul>
<li><p>直接记录快照，而非差异比较： 在 Git
中，每当你提交更新或保存项目状态时，它基本上就会对当时的全部文件创建一个快照并保存这个快照的索引。
为了效率，如果文件没有修改，Git
不再重新存储该文件，而是只保留一个链接指向之前存储的文件。 Git
对待数据更像是一个 <strong>快照流</strong>。</p></li>
<li><p>近乎所有操作都是本地执行，只有上传时才需联网</p></li>
<li><p>Git 保证完整性：Git
中所有的数据在存储前都计算校验和，然后以校验和来引用。Git
用以计算校验和的机制叫做 SHA-1 散列（hash，哈希）。 这是一个由 40
个十六进制字符（0-9 和 a-f）组成的字符串，基于 Git
中文件的内容或目录结构计算出来。</p>
<blockquote>
<p>Tips:Git
数据库中保存的信息都是以文件内容的哈希值来索引，而不是文件名。</p>
</blockquote></li>
<li><p>Git 一般只添加数据：你执行的 Git 操作，几乎只往 Git 数据库中
<strong>添加</strong> 数据。 你很难使用 Git 从数据库中删除数据，也就是说
Git 几乎不会执行任何可能导致文件不可恢复的操作。</p></li>
</ul>
<h2 id="git三种状态">Git三种状态</h2>
<p>Git
有三种状态：<strong>已提交（committed）</strong>、<strong>已修改（modified）</strong>
和 <strong>已暂存（staged）</strong>。</p>
<ul>
<li>已修改表示修改了文件，但还没保存到数据库中。</li>
<li>已暂存表示对一个已修改文件的当前版本做了标记，使之包含在下次提交的快照中。</li>
<li>已提交表示数据已经安全地保存在本地数据库中。</li>
</ul>
<p>这会让我们的 Git 项目拥有三个阶段：工作区、暂存区以及 Git 目录。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/areas.png"
alt="areas" />
<figcaption aria-hidden="true">areas</figcaption>
</figure>
<ul>
<li>工作区是对项目的某个版本独立提取出来的内容。 这些从 Git
仓库的压缩数据库中提取出来的文件，放在磁盘上供你使用或修改。</li>
<li>暂存区是一个文件，保存了下次将要提交的文件列表信息，一般在 Git
仓库目录中。 按照 Git
的术语叫做“索引”，不过一般说法还是叫“暂存区”。</li>
<li>Git 仓库目录是 Git 用来保存项目的元数据和对象数据库的地方。 这是 Git
中最重要的部分，从其它计算机克隆仓库时，复制的就是这里的数据。</li>
</ul>
<h2 id="git工作流程">Git工作流程</h2>
<ol type="1">
<li>在工作区中修改文件。</li>
<li>将你想要下次提交的更改选择性地暂存，这样只会将更改的部分添加到暂存区。</li>
<li>提交更新，找到暂存区的文件，将快照永久性存储到 Git 目录。</li>
</ol>
<p>如果 Git 目录中保存着特定版本的文件，就属于 <strong>已提交</strong>
状态。 如果文件已修改并放入暂存区，就属于 <strong>已暂存</strong> 状态。
如果自上次检出后，作了修改但还没有放到暂存区域，就是
<strong>已修改</strong> 状态。</p>
<h2 id="git获取帮助">Git获取帮助</h2>
<p>Git命令的manpage</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">help</span> &lt;verb&gt;</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git &lt;verb&gt; --<span class="built_in">help</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">man git-&lt;verb&gt;</span></span><br></pre></td></tr></table></figure>
<p>or 可以用 <code>-h</code> 选项获得更简明的 "help'':</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ git add -h </span><br></pre></td></tr></table></figure>
<h1 id="git配置">Git配置</h1>
<p>Git 自带一个 <code>git config</code> 的工具来帮助设置控制 Git
外观和行为的配置变量。</p>
<p>查看所有的配置以及它们所在的文件：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git config --list --show-origin</span></span><br></pre></td></tr></table></figure>
<ul>
<li><h4 id="用户信息">用户信息</h4></li>
</ul>
<p>安装完 Git 之后，要做的第一件事就是设置你的用户名和邮件地址。
这一点很重要，因为每一个 Git
提交都会使用这些信息，它们会写入到你的每一次提交中，不可更改：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git config --global user.name <span class="string">&quot;John Doe&quot;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git config --global user.email johndoe@example.com</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:如果使用了 <code>--global</code>
选项，那么该命令只需要运行一次，因为之后无论你在该系统上做任何事情， Git
都会使用那些信息。（）</p>
</blockquote>
<ul>
<li><h4 id="文本编辑器">文本编辑器</h4>
<p>既然用户信息已经设置完毕，你可以配置默认文本编辑器了，当 Git
需要你输入信息时会调用它。 如果未配置，Git
会使用操作系统默认的文本编辑器。</p>
<p>如果你想使用不同的文本编辑器，例如 Emacs，可以这样做：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git config --global core.editor emacs</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>在 Windows
系统上，如果你想要使用别的文本编辑器，那么必须指定可执行文件的完整路径。
它可能随你的编辑器的打包方式而不同。</p>
</blockquote></li>
<li><h4 id="检查配置信息">检查配置信息</h4>
<p>如果想要检查你的配置，可以使用 <code>git config --list</code>
命令来列出所有 Git 当时能找到的配置。</p>
<p>你可以通过输入 <code>git config &lt;key&gt;</code>： 来检查 Git
的某一项配置</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git config user.name</span></span><br><span class="line">John Doe</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>Note： 由于 Git
会从多个文件中读取同一配置变量的不同值，因此你可能会在其中看到意料之外的值而不知道为什么。
此时，你可以查询 Git 中该变量的 <strong>原始</strong>
值，它会告诉你哪一个配置文件最后设置了该值：<code>$ git config --show-origin rerere.autoUpdate file:/home/johndoe/.gitconfig    false</code></p>
</blockquote>
<h1 id="git基础">Git基础</h1>
<h2 id="获取git-repository">获取Git repository</h2>
<p>通常有两种获取 Git 项目仓库的方式：</p>
<ul>
<li><p>将尚未进行版本控制的本地目录转换为 Git 仓库</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /home/user/my_project</span><br><span class="line">git init</span><br></pre></td></tr></table></figure>
<p>该命令将创建一个名为 <code>.git</code>
的子目录，这个子目录含有你初始化的 Git 仓库中所有的必须文件，这些文件是
Git 仓库的骨干。
但是，在这个时候，我们仅仅是做了一个初始化的操作，你的项目里的文件还没有被跟踪。</p>
<p>如果在一个已存在文件的文件夹（而非空文件夹）中进行版本控制，你应该开始追踪这些文件并进行初始提交。
可以通过 <code>git add</code> 命令来指定所需的文件来进行追踪，然后执行
<code>git commit</code> ：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git add *.c</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git add LICENSE</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git commit -m <span class="string">&#x27;initial project version&#x27;</span></span></span><br></pre></td></tr></table></figure></li>
<li><p>从其它服务器 <strong>克隆</strong> 一个已存在的 Git 仓库。</p>
<p>克隆仓库的命令是 <code>git clone &lt;url&gt;</code></p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> https://github.com/libgit2/libgit2</span></span><br></pre></td></tr></table></figure>
<p>这会在当前目录下创建一个名为 “libgit2”
的目录，并在这个目录下初始化一个 <code>.git</code> 文件夹，
从远程仓库拉取下所有数据放入 <code>.git</code>
文件夹，然后从中读取最新版本的文件的拷贝。</p>
<p>如果你想在克隆远程仓库的时候，自定义本地仓库的名字，你可以通过额外的参数指定新的目录名：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> https://github.com/libgit2/libgit2 mylibgit</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="记录每次更新到仓库">记录每次更新到仓库</h2>
<p>每一个文件都有两种状态：<strong>已跟踪</strong> 或
<strong>未跟踪</strong>。（已跟踪的文件就是 Git 已经知道的文件。）</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/lifecycle.png"
alt="lifecycle" />
<figcaption aria-hidden="true">lifecycle</figcaption>
</figure>
<ul>
<li><h4 id="检查当前文件状态">检查当前文件状态</h4>
<p>可以用 <code>git status</code> 命令查看哪些文件处于什么状态</p></li>
<li><h4 id="状态简览">状态简览</h4>
<p><code>git status</code> 命令的输出十分详细，但其用语有些繁琐。 Git
有一个选项可以帮你缩短状态命令的输出，这样可以以简洁的方式查看更改。
如果你使用 <code>git status -s</code> 命令或
<code>git status --short</code>
命令，你将得到一种格式更为紧凑的输出。</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git status -s</span></span><br><span class="line"> M README</span><br><span class="line">MM Rakefile</span><br><span class="line">A  lib/git.rb</span><br><span class="line">M  lib/simplegit.rb</span><br><span class="line">?? LICENSE.txt</span><br></pre></td></tr></table></figure>
<p>新添加的未跟踪文件前面有 <code>??</code>
标记，新添加到暂存区中的文件前面有 <code>A</code>
标记，修改过的文件前面有 <code>M</code> 标记。
输出中有两栏，左栏指明了暂存区的状态，右栏指明了工作区的状态。例如，上面的状态报告显示：
<code>README</code> 文件在工作区已修改但尚未暂存，而
<code>lib/simplegit.rb</code> 文件已修改且已暂存。 <code>Rakefile</code>
文件已修改，暂存后又作了修改，因此该文件的修改中既有已暂存的部分，又有未暂存的部分。</p></li>
<li><h4 id="跟踪新文件">跟踪新文件</h4>
<p>使用命令 <code>git add</code> 开始跟踪一个文件，只要在
<code>Changes to be committed</code>
这行下面的，就说明是已暂存状态。</p></li>
<li><h4 id="暂存已修改的文件">暂存已修改的文件</h4>
<p>文件出现在 <code>Changes not staged for commit</code>
这行下面，说明已跟踪文件的内容发生了变化，但还没有放到暂存区。
要暂存这次更新，需要运行 <code>git add</code> 命令。
这是个多功能命令：可以用它开始跟踪新文件，或者把已跟踪的文件放到暂存区，还能用于合并时把有冲突的文件标记为已解决状态等。</p>
<blockquote>
<p>Tips:文件可能同时出现在暂存区（某一次修改被git
add）和非暂存区(之后又修改了)。所以要重新git add</p>
</blockquote></li>
<li><h4 id="忽略文件">忽略文件</h4>
<p>一般我们总会有些文件无需纳入 Git
的管理，也不希望它们总出现在未跟踪文件列表。
通常都是些自动生成的文件，比如日志文件，或者编译过程中创建的临时文件等。
在这种情况下，我们可以创建一个名为 <code>.gitignore</code>
的文件，列出要忽略的文件的模式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">touch .gitignore</span><br></pre></td></tr></table></figure></li>
<li><p>文件 <code>.gitignore</code> 的格式规范如下：</p>
<ul>
<li>所有空行或者以 <code>#</code> 开头的行都会被 Git 忽略。</li>
<li>可以使用标准的 glob 模式匹配，它会递归地应用在整个工作区中。</li>
<li>匹配模式可以以（<code>/</code>）开头防止递归。</li>
<li>匹配模式可以以（<code>/</code>）结尾指定目录。</li>
<li>要忽略指定模式以外的文件或目录，可以在模式前加上叹号（<code>!</code>）取反。</li>
</ul>
<p>所谓的 glob 模式是指 shell
所使用的简化了的<strong>正则表达式</strong>。
星号（<code>*</code>）匹配零个或多个任意字符；<code>[abc]</code>
匹配任何一个列在方括号中的字符 （这个例子要么匹配一个 a，要么匹配一个
b，要么匹配一个 c）；
问号（<code>?</code>）只匹配一个任意字符；如果在方括号中使用短划线分隔两个字符，
表示所有在这两个字符范围内的都可以匹配（比如 <code>[0-9]</code>
表示匹配所有 0 到 9 的数字）。
使用两个星号（**）表示匹配任意中间目录，比如 <code>a/**/z</code>
可以匹配 <code>a/z</code> 、 <code>a/b/z</code> 或 <code>a/b/c/z</code>
等。</p>
<blockquote>
<p>Tips：要养成一开始就为你的新仓库设置好 .gitignore
文件的习惯，以免将来误提交这类无用的文件。</p>
</blockquote></li>
<li><h4 id="查看已暂存和未暂存的修改">查看已暂存和未暂存的修改</h4>
<p>想知道具体修改了什么地方，可以用 <code>git diff</code> 命令。
<code>git diff</code>
能通过文件补丁的格式更加具体地显示哪些行发生了改变。（
<code>--staged</code> 和 <code>--cached</code> 是同义词）</p>
<ul>
<li>要查看修改之后还没有暂存起来的变化内容，不加参数直接输入
<code>git diff</code></li>
<li>要查看已暂存的将要添加到下次提交里的内容，可以用
<code>git diff --staged</code> 命令。
这条命令将比对已暂存文件与最后一次提交的文件差异</li>
</ul>
<blockquote>
<p>Tips：git diff
本身只显示尚未暂存的改动，而不是自上次提交以来所做的所有改动</p>
</blockquote></li>
<li><h4 id="提交更新">提交更新</h4>
<p>提交命令
<code>git commit</code>,这样会启动你选择的文本编辑器来输入提交说明。</p>
<p>可以在 <code>commit</code> 命令后添加 <code>-m</code>
选项，将提交信息与命令放在同一行，如下所示：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git commit -m <span class="string">&quot;Story 182: Fix benchmarks for speed&quot;</span></span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Note:更详细的内容修改提示可以用 <code>-v</code>
选项查看，这会将你所作的更改的 diff
输出呈现在编辑器中，以便让你知道本次提交具体作出哪些修改。</p>
</blockquote>
<p>提交后它会告诉你，当前是在哪个分支（<code>master</code>）提交的，本次提交的完整SHA-1
校验和是什么（<code>463dc4f</code>），以及在本次提交中，有多少文件修订过，多少行添加和删改过</p></li>
<li><h4 id="跳过使用暂存区域">跳过使用暂存区域</h4>
<p>只要在提交的时候，给 <code>git commit</code> 加上 <code>-a</code>
选项，Git 就会自动把所有已经跟踪过的文件暂存起来一并提交，从而跳过
<code>git add</code> 步骤</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git commit -a -m <span class="string">&#x27;added new benchmarks&#x27;</span></span></span><br></pre></td></tr></table></figure></li>
<li><h4 id="移除文件">移除文件</h4>
<p>要从 Git
中移除某个文件，就必须要从已跟踪文件清单中移除（确切地说，是从暂存区域移除），然后提交。
可以用 <code>git rm</code>
命令完成此项工作，并连带从工作目录中删除指定的文件，这样以后就不会出现在未跟踪文件清单中了。</p>
<p>下一次提交时，该文件就不再纳入版本管理了。
如果要删除之前修改过或已经放到暂存区的文件，则必须使用强制删除选项
<code>-f</code>（译注：即 force 的首字母）。
这是一种安全特性，用于防止误删尚未添加到快照的数据，这样的数据不能被 Git
恢复</p>
<p>另外一种情况是，我们想把文件从 Git
仓库中删除（亦即从暂存区域移除），但仍然希望保留在当前工作目录中。
换句话说，你想让文件保留在磁盘，但是并不想让 Git 继续跟踪。 当你忘记添加
<code>.gitignore</code> 文件，不小心把一个很大的日志文件或一堆
<code>.a</code> 这样的编译生成文件添加到暂存区时，这一做法尤其有用。
为达到这一目的，使用 <code>--cached</code> 选项：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">rm</span> --cached README</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果只是简单地从工作目录中手工删除文件，运行 <code>git status</code>
时就会在 “Changes not staged for commit” 部分（也就是
<em>未暂存清单</em>）看到。</p>
</blockquote></li>
<li><h4 id="移动文件">移动文件</h4>
<p>要在 Git 中对文件改名，可以这么做：（Git足够聪明）</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">mv</span> file_from file_to</span></span><br></pre></td></tr></table></figure>
<p>运行 <code>git mv</code> 就相当于运行了下面三条命令：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mv</span> README.md README</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">rm</span> README.md</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git add README</span></span><br></pre></td></tr></table></figure>
<p>直接使用 <code>git mv</code> 方便得多。
不过在使用其他工具重命名文件时，记得在提交前 <code>git rm</code>
删除旧文件名，再 <code>git add</code> 添加新文件名。</p></li>
</ul>
<h2 id="查看提交历史">查看提交历史</h2>
<p>完成这个任务最简单而又有效的工具是 <code>git log</code> 命令。</p>
<p>默认情况下，<code>git log</code>
会按时间先后顺序列出所有的提交，最近的更新排在最上面。这个命令会列出每个提交的
SHA-1 校验和、作者的名字和电子邮件地址、提交时间以及提交说明。</p>
<h3 id="常用的选项">常用的选项</h3>
<p><code>git log</code> 的常用选项:</p>
<table>
<colgroup>
<col style="width: 22%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">选项</th>
<th style="text-align: left;">说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>-p</code></td>
<td style="text-align: left;">按补丁格式显示每个提交引入的差异。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>--stat</code></td>
<td style="text-align: left;">显示每次提交的文件修改统计信息。</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>--shortstat</code></td>
<td style="text-align: left;">只显示 --stat
中最后的行数修改添加移除统计。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>--name-only</code></td>
<td style="text-align: left;">仅在提交信息后显示已修改的文件清单。</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>--name-status</code></td>
<td style="text-align: left;">显示新增、修改、删除的文件清单。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>--abbrev-commit</code></td>
<td style="text-align: left;">仅显示 SHA-1 校验和所有 40
个字符中的前几个字符。</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>--relative-date</code></td>
<td
style="text-align: left;">使用较短的相对时间而不是完整格式显示日期（比如“2
weeks ago”）。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>--graph</code></td>
<td style="text-align: left;">在日志旁以 ASCII
图形显示分支与合并历史。</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>--pretty</code></td>
<td
style="text-align: left;">使用其他格式显示历史提交信息。可用的选项包括
oneline、short、full、fuller 和 format（用来定义自己的格式）。</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>--oneline</code></td>
<td
style="text-align: left;"><code>--pretty=oneline --abbrev-commit</code>
合用的简写。</td>
</tr>
</tbody>
</table>
<ul>
<li><p>其中一个比较有用的选项是 <code>-p</code> 或 <code>--patch</code>
，它会显示每次提交所引入的差异（按 <strong>补丁</strong> 的格式输出）。
你也可以限制显示的日志条目数量，例如使用 <code>-2</code>
选项来只显示最近的两次提交</p></li>
<li><p>想看到每次提交的简略统计信息，可以使用 <code>--stat</code>
选项。在每次提交的下面列出所有被修改过的文件、有多少文件被修改了以及被修改过的文件的哪些行被移除或是添加了。
在每次提交的最后还有一个总结</p></li>
<li><p><code>--pretty</code>。
这个选项可以使用不同于默认格式的方式展示提交历史。<code>oneline</code>
会将每个提交放在一行显示，在浏览大量的提交时非常有用。 另外还有
<code>short</code>，<code>full</code> 和 <code>fuller</code>
选项，它们展示信息的格式基本一致，但是详尽程度不一 。</p>
<p><code>git log --pretty=format</code> <code>format</code>
接受的常用格式占位符的写法及其代表的意义（可以定制记录的显示格式）：</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">选项</th>
<th style="text-align: left;">说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>%H</code></td>
<td style="text-align: left;">提交的完整哈希值</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%h</code></td>
<td style="text-align: left;">提交的简写哈希值</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%T</code></td>
<td style="text-align: left;">树的完整哈希值</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%t</code></td>
<td style="text-align: left;">树的简写哈希值</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%P</code></td>
<td style="text-align: left;">父提交的完整哈希值</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%p</code></td>
<td style="text-align: left;">父提交的简写哈希值</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%an</code></td>
<td style="text-align: left;">作者名字</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%ae</code></td>
<td style="text-align: left;">作者的电子邮件地址</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%ad</code></td>
<td style="text-align: left;">作者修订日期（可以用 --date=选项
来定制格式）</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%ar</code></td>
<td style="text-align: left;">作者修订日期，按多久以前的方式显示</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%cn</code></td>
<td style="text-align: left;">提交者的名字</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%ce</code></td>
<td style="text-align: left;">提交者的电子邮件地址</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%cd</code></td>
<td style="text-align: left;">提交日期</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%cr</code></td>
<td style="text-align: left;">提交日期（距今多长时间）</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%s</code></td>
<td style="text-align: left;">提交说明</td>
</tr>
</tbody>
</table>
<p><strong>eg:</strong></p>
<p><figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --pretty=format:<span class="string">&quot;%h - %an, %ar : %s&quot;</span></span></span><br><span class="line">ca82a6d - Scott Chacon, 6 years ago : changed the version number</span><br><span class="line">085bb3b - Scott Chacon, 6 years ago : removed unnecessary test</span><br><span class="line">a11bef0 - Scott Chacon, 6 years ago : first commit</span><br></pre></td></tr></table></figure></p>
<ul>
<li>当 <code>oneline</code> 或 <code>format</code> 与另一个
<code>log</code> 选项 <code>--graph</code>
结合使用时尤其有用。<code>--graph</code>可视化显示分支、合并历史</li>
</ul>
<h3 id="限制输出长度">限制输出长度</h3>
<ul>
<li><p>你可以使用类似 <code>-&lt;n&gt;</code> 的选项，其中的
<code>n</code> 可以是任何整数，表示仅显示最近的 <code>n</code> 条提交。
不过实践中这个选项不是很常用，因为 Git
默认会将所有的输出传送到分页程序中，所以你一次只会看到一页的内容。</p></li>
<li><p><code>--since</code>==<code>--after</code>(仅显示指定时间之后的提交)和
<code>--until</code>
==<code>--before</code>(仅显示指定时间之前的提交)这种按照时间作限制的选项很有用。
下面的命令会列出最近两周的所有提交：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --since=2.weeks</span></span><br></pre></td></tr></table></figure>
<p>该命令可用的格式十分丰富——可以是类似 <code>"2008-01-15"</code>
的具体的某一天，也可以是类似 <code>"2 years 1 day 3 minutes ago"</code>
的相对日期。</p></li>
<li><p>过滤出匹配指定条件的提交。 用 <code>--author</code>
选项显示指定作者的提交，用 <code>--grep</code>
选项搜索提交说明中的关键字。</p>
<blockquote>
<p>Tips:你可以指定多个 <code>--author</code> 和 <code>--grep</code>
搜索条件，这样会只输出匹配 <strong>任意</strong> <code>--author</code>
模式和 <strong>任意</strong> <code>--grep</code>
模式的提交。然而，如果你添加了 <code>--all-match</code> 选项，
则只会输出匹配 <strong>所有</strong> <code>--grep</code>
模式的提交。</p>
</blockquote></li>
<li><p>另一个非常有用的过滤器是
<code>-S</code>,它接受一个字符串参数，并且只会显示那些添加或删除了该字符串的提交。
假设你想找出添加或删除了对某一个特定函数的引用的提交，可以调用：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> -S function_name</span></span><br></pre></td></tr></table></figure></li>
<li><p>隐藏合并提交</p>
<p>按照你代码仓库的工作流程，记录中可能有为数不少的合并提交，它们所包含的信息通常并不多。
为了避免显示的合并提交弄乱历史记录，可以为 <code>log</code> 加上
<code>--no-merges</code> 选项。</p></li>
</ul>
<h2 id="撤销操作">撤销操作</h2>
<p>撤销操作是非常有用的，但<strong>有些撤消操作是不可逆的</strong></p>
<p><code>git reset</code>
通过把分支记录回退几个提交记录来实现撤销改动。</p>
<p>Git 把 main 分支移回到
<code>C1</code>；现在我们的本地代码库根本就不知道有 <code>C2</code>
这个提交了。</p>
<blockquote>
<p>（译者注：在reset后， <code>C2</code>
所做的变更还在，但是处于未加入暂存区状态。）</p>
</blockquote>
<p>虽然在你的本地分支中使用 <code>git reset</code>
很方便，但是这种“改写历史”的方法对大家一起使用的远程分支是无效的！</p>
<p>为了撤销更改并<strong>分享</strong>给别人，我们需要使用
<code>git revert</code></p>
<p>我们要撤销的提交记录后面多了一个新提交！这是因为新提交记录
<code>C2'</code> 引入了<strong>更改</strong> —— 这些更改刚好是用来撤销
<code>C2</code> 这个提交的。也就是说 <code>C2'</code> 的状态与
<code>C1</code> 是相同的。</p>
<p>revert 之后就可以把你的更改推送到远程仓库与别人分享</p>
<p>本地分支撤销用：<code>git reset + &lt;想要回溯的版本（之前的）&gt;</code></p>
<p>远程分支撤销用：<code>git revert +&lt;当前想要改变的分支（当前的）&gt;</code></p>
<h3 id="提交错误">提交错误</h3>
<p>有时候我们提交完了才发现漏掉了几个文件没有添加，或者提交信息写错了。
此时，可以运行带有 <code>--amend</code> 选项的提交命令来重新提交：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git commit --amend</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:即用一个 <strong>新的提交</strong> 替换旧的提交</p>
</blockquote>
<h3 id="取消暂存的文件">取消暂存的文件</h3>
<p><code>git reset HEAD &lt;file&gt;…</code> 来取消暂存</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset HEAD CONTRIBUTING.md</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:<code>git reset</code> 是个危险的命令，如果加上了
<code>--hard</code> 选项则更是如此。</p>
</blockquote>
<h3 id="撤消对文件的修改">撤消对文件的修改</h3>
<p>并不想保留对 <code>CONTRIBUTING.md</code> 文件的修改</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout -- CONTRIBUTING.md</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:请务必记得 <code>git checkout — &lt;file&gt;</code>
是一个危险的命令。 你对那个文件在本地的任何修改都会消失——Git
会用最近提交的版本覆盖掉它。
除非你确实清楚不想要对那个文件的本地修改了，否则请不要使用这个命令。</p>
</blockquote>
<p>如果你仍然想保留对那个文件做出的修改，但是现在仍然需要撤消，Git
分支](https://git-scm.com/book/zh/v2/ch00/ch03-git-branching)
介绍保存进度与分支，这通常是更好的做法。</p>
<p>记住，在 Git 中任何 <strong>已提交</strong>
的东西几乎总是可以恢复的。 甚至那些被删除的分支中的提交或使用
<code>--amend</code> 选项覆盖的提交也可以恢复。
然而，任何你未提交的东西丢失后很可能再也找不到了。</p>
<h2 id="远程仓库的使用">远程仓库的使用</h2>
<h3 id="查看远程仓库">查看远程仓库</h3>
<p>查看你已经配置的远程仓库服务器，可以运行 <code>git remote</code>
命令。 它会列出你指定的每一个远程服务器的简写。
如果你已经克隆了自己的仓库，那么至少应该能看到 origin ——这是 Git
给你克隆的仓库服务器的默认名字。</p>
<p>可以指定选项 <code>-v</code>，会显示需要读写远程仓库使用的 Git
保存的简写与其对应的
URL；远程仓库会全部列出来（可能不止一个，eg:和几个协作者合作）</p>
<h3 id="添加远程仓库">添加远程仓库</h3>
<p><code>git clone</code> 命令会自行添加远程仓库。</p>
<p>运行 <code>git remote add &lt;shortname&gt; &lt;url&gt;</code>
添加一个新的远程 Git 仓库，同时指定一个方便使用的简写</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git remote add pb https://github.com/paulboone/ticgit</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git remote -v</span></span><br><span class="line">pb	https://github.com/paulboone/ticgit (fetch)</span><br><span class="line">pb	https://github.com/paulboone/ticgit (push)</span><br></pre></td></tr></table></figure>
<p>可以在命令行中使用字符串 <code>pb</code> 来代替整个 URL</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ gir fetch pb</span><br></pre></td></tr></table></figure>
<h3 id="从远程仓库中抓取与拉取">从远程仓库中抓取与拉取</h3>
<p>从远程仓库中获得数据，可以执行：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git fetch &lt;remote&gt;</span></span><br></pre></td></tr></table></figure>
<p>这个命令会访问远程仓库，从中拉取所有你还没有的数据。
执行完成后，你将会拥有那个远程仓库中所有分支的引用，可以随时合并或查看。</p>
<p><code>git fetch</code>
命令只会将数据下载到你的本地仓库——它并不会自动合并或修改你当前的工作。
当准备好时你必须手动将其合并入你的工作。</p>
<p>如果你的当前分支设置了跟踪远程分支,可以用 <code>git pull</code>
命令来自动抓取后合并该远程分支到当前分支。</p>
<h3 id="推送到远程仓库">推送到远程仓库</h3>
<p><code>git push &lt;remote&gt; &lt;branch&gt;</code></p>
<p>只有当你有所克隆服务器的写入权限，并且之前没有人推送过时，这条命令才能生效。
当你和其他人在同一时间克隆，他们先推送到上游然后你再推送到上游，你的推送就会毫无疑问地被拒绝。
你必须先抓取他们的工作并将其合并进你的工作后才能推送。</p>
<h3 id="查看某个远程仓库">查看某个远程仓库</h3>
<p>想要查看某一个远程仓库的更多信息，可以使用
<code>git remote show &lt;remote&gt;</code> 命令</p>
<p>它同样会列出远程仓库的 URL 与跟踪分支的信息(important)</p>
<h3 id="远程仓库的重命名与移除">远程仓库的重命名与移除</h3>
<p>可以运行 <code>git remote rename</code> 来修改一个远程仓库的简写名。
例如，想要将 <code>pb</code> 重命名为 <code>paul</code>，可以用
<code>git remote rename</code> 这样做：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git remote rename pb paul</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git remote</span></span><br><span class="line">paul</span><br></pre></td></tr></table></figure>
<p>这同样也会修改你所有远程跟踪的分支名字。 那些过去引用
<code>pb/master</code> 的现在会引用 <code>paul/master</code>。(nice)</p>
<p>如果因为一些原因想要移除一个远程仓库（你已经从服务器上搬走了或不再想使用某一个特定的镜像了，
又或者某一个贡献者不再贡献了）以使用 <code>git remote remove</code> 或
<code>git remote rm</code> ：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git remote remove paul</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git remote</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>一旦你使用这种方式删除了一个远程仓库，那么所有和这个远程仓库相关的远程跟踪分支以及配置信息也会一起被删除。</p>
<h2 id="打标签">打标签</h2>
<p>Git 可以给仓库历史中的某一个提交打上标签，以示重要。
比较有代表性的是人们会使用这个功能来标记发布结点（ <code>v1.0</code> 、
<code>v2.0</code> 等等）</p>
<h3 id="列出标签">列出标签</h3>
<p>列出标签：<code>git tag</code> （可带上可选的 <code>-l</code> 选项
<code>--list</code>）（这个命令以字母顺序列出标签）：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git tag</span></span><br><span class="line">v1.0</span><br><span class="line">v2.0</span><br></pre></td></tr></table></figure>
<p>你也可以按照特定的模式查找标签。 例如，Git
自身的源代码仓库包含标签的数量超过 500 个。 如果只对 1.8.5
系列感兴趣，可以运行：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git tag -l <span class="string">&quot;v1.8.5*&quot;</span></span></span><br><span class="line">v1.8.5</span><br><span class="line">v1.8.5-rc0</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips: 按照通配符列出标签需要 <code>-l</code> 或 <code>--list</code>
选项如果你只想要完整的标签列表，那么运行 <code>git tag</code>
就会默认假定你想要一个列表，它会直接给你列出来， 此时的 <code>-l</code>
或 <code>--list</code>
是可选的。然而，如果你提供了一个匹配标签名的通配模式，那么
<code>-l</code> 或 <code>--list</code> 就是强制使用的。</p>
</blockquote>
<h3 id="创建标签">创建标签</h3>
<p>Git
支持两种标签：轻量标签（lightweight）与附注标签（annotated）。</p>
<ul>
<li><p>轻量标签很像一个不会改变的分支——它只是某个特定提交的引用。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git tag v1.0 c1</span><br></pre></td></tr></table></figure></li>
<li><p>附注标签是存储在 Git 数据库中的一个完整对象，
它们是可以被校验的，其中包含打标签者的名字、电子邮件地址、日期时间，
此外还有一个标签信息，并且可以使用 GNU Privacy Guard （GPG）签名并验证。
通常会建议创建附注标签，这样你可以拥有以上所有信息。但是如果你只是想用一个临时的标签，
或者因为某些原因不想要保存这些信息，那么也可以用轻量标签。</p></li>
</ul>
<h4 id="轻量标签">轻量标签</h4>
<p>一种给提交打标签的方式是使用轻量标签。
轻量标签本质上是将提交校验和存储到一个文件中——没有保存任何其他信息。
创建轻量标签，不需要使用 <code>-a</code>、<code>-s</code> 或
<code>-m</code> 选项，只需要提供标签名字：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git tag v1.2-lw</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git tag</span></span><br><span class="line">v0.1</span><br><span class="line">v1.2</span><br><span class="line">v1.2-1w</span><br></pre></td></tr></table></figure>
<p>这时，如果在标签上运行
<code>git show</code>，你不会看到额外的标签信息。
命令只会显示出提交信息。</p>
<h4 id="附注标签">附注标签</h4>
<p>创建附注标签: 最简单的方式是当你在运行 <code>tag</code> 命令时指定
<code>-a</code> 选项：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git tag -a v1.4 -m <span class="string">&quot;my version 1.4&quot;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git tag</span></span><br><span class="line">v0.1</span><br><span class="line">v1.3</span><br><span class="line">v1.4</span><br></pre></td></tr></table></figure>
<p><code>-m</code> 选项指定了一条将会存储在标签中的信息。
如果没有为附注标签指定一条信息，Git 会启动编辑器要求你输入信息。</p>
<p>通过使用 <code>git show</code>
命令可以看到标签信息和与之对应的提交信息.</p>
<h3 id="后期打标签">后期打标签</h3>
<p>你也可以对过去的提交打标签。 假设提交历史是这样的：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --pretty=oneline</span></span><br><span class="line">9fceb02d0ae598e95dc970b74767f19372d61af8 updated rakefile</span><br><span class="line">964f16d36dfccde844893cac5b347e7b3d44abbc commit the todo</span><br><span class="line">8a5cbc430f1a9c3d00faaeffd07798508422908a updated readme</span><br></pre></td></tr></table></figure>
<p>现在，假设在 v1.2 时你忘记给项目打标签，也就是在 “updated rakefile”
提交。 你可以在之后补上标签。
要在那个提交上打标签，你需要在命令的末尾指定提交的校验和（或部分校验和）：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git tag -a v1.2 9fceb02</span></span><br></pre></td></tr></table></figure>
<h3 id="共享标签">共享标签</h3>
<p>默认情况下，<code>git push</code>
命令并不会传送标签到远程仓库服务器上。
在创建完标签后你必须显式地推送标签到共享服务器上。
这个过程就像共享远程分支一样——你可以运行
<code>git push origin &lt;tagname&gt;</code>。</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git push origin v1.5</span></span><br></pre></td></tr></table></figure>
<p>如果想要一次性推送很多标签，也可以使用带有 <code>--tags</code> 选项的
<code>git push</code> 命令。
这将会把所有不在远程仓库服务器上的标签全部传送到那里。</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git push origin --tags</span></span><br></pre></td></tr></table></figure>
<p>现在，当其他人从仓库中克隆或拉取，他们也能得到你的那些标签。</p>
<blockquote>
<p>Tips: <code>git push</code> 推送两种标签使用
<code>git push &lt;remote&gt; --tags</code>
推送标签并不会区分轻量标签和附注标签，
没有简单的选项能够让你只选择推送一种标签。</p>
</blockquote>
<h3 id="删除标签">删除标签</h3>
<p>要删除掉你本地仓库上的标签，可以使用命令
<code>git tag -d &lt;tagname&gt;</code>。
例如，可以使用以下命令删除一个轻量标签：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git tag -d v1.4-lw</span></span><br><span class="line">Deleted tag &#x27;v1.4-lw&#x27; (was e7d5add)</span><br></pre></td></tr></table></figure>
<p>注意上述命令并不会从任何远程仓库中移除这个标签，你必须用
<code>git push &lt;remote&gt; :refs/tags/&lt;tagname&gt;</code>
来更新你的远程仓库：</p>
<p>第一种变体是
<code>git push &lt;remote&gt; :refs/tags/&lt;tagname&gt;</code> ：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git push origin :refs/tags/v1.4-lw</span></span><br><span class="line">To /git@github.com:schacon/simplegit.git</span><br><span class="line"> - [deleted]         v1.4-lw</span><br></pre></td></tr></table></figure>
<p>上面这种操作的含义是，将冒号前面的空值推送到远程标签名，从而高效地删除它。</p>
<p>第二种<strong>更直观</strong>的删除远程标签的方式是：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git push origin --delete &lt;tagname&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="检出标签">检出标签</h3>
<p>如果你想查看某个标签所指向的文件版本，可以使用
<code>git checkout</code> 命令，
虽然这会使你的仓库处于“分离头指针（detached
HEAD）”的状态——这个状态有些不好的副作用：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout 2.0.0</span></span><br></pre></td></tr></table></figure>
<p>在“分离头指针”状态下，如果你做了某些更改然后提交它们，标签不会发生变化，
但你的新提交将不属于任何分支，并且将无法访问，除非通过确切的提交哈希才能访问。
因此，如果你需要进行更改，比如你要修复旧版本中的错误，那么通常需要创建一个新分支：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout -b version2 v2.0.0</span></span><br><span class="line">Switched to a new branch &#x27;version2&#x27;</span><br></pre></td></tr></table></figure>
<p>如果在这之后又进行了一次提交，<code>version2</code>
分支就会因为这个改动向前移动， 此时它就会和 <code>v2.0.0</code>
标签稍微有些不同，这时就要当心了。</p>
<h3 id="git-describe">Git Describe</h3>
<p>由于标签在代码库中起着“锚点”的作用，Git
还为此专门设计了一个命令用来<strong>描述</strong>离你最近的锚点（也就是标签），它就是
<code>git describe</code>！</p>
<p>Git Describe 能帮你在提交历史中移动了多次以后找到方向；当你用
<code>git bisect</code>（一个查找产生 Bug
的提交记录的指令）找到某个提交记录时，或者是当你坐在你那刚刚度假回来的同事的电脑前时，
可能会用到这个命令。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git describe &lt;ref&gt;</span><br></pre></td></tr></table></figure>
<p><code>&lt;ref&gt;</code> 可以是任何能被 Git
识别成提交记录的引用，如果你没有指定的话，Git
会使用你目前所在的位置（<code>HEAD</code>）。</p>
<p>它输出的结果是这样的：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;tag&gt;_&lt;numCommits&gt;_g&lt;hash&gt;</span><br></pre></td></tr></table></figure>
<p><code>tag</code> 表示的是离 <code>ref</code> 最近的标签，
<code>numCommits</code> 是表示这个 <code>ref</code> 与 <code>tag</code>
相差有多少个提交记录， <code>hash</code> 表示的是你所给定的
<code>ref</code> 所表示的提交记录哈希值的前几位。</p>
<p>当 <code>ref</code> 提交记录上有某个标签时，则只输出标签名称</p>
<h2 id="git别名">Git别名</h2>
<p>配置Git command，看你需要咯</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git config --global alias.co checkout</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git config --global alias.br branch</span></span><br></pre></td></tr></table></figure>
<h1 id="references">References</h1>
<ul>
<li><a href="https://git-scm.com/book/zh/v2">Git - Book
(git-scm.com)</a></li>
<li><a href="https://learngitbranching.js.org/?locale=zh_CN">Learn Git
Branching</a></li>
</ul>
]]></content>
      <categories>
        <category>CS</category>
      </categories>
      <tags>
        <tag>CS</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Markdown_in_Typora</title>
    <url>/2023/08/09/Markdown-in-Typora/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Typora写markdown是必修课，在此学习Typora常用的快捷键操作，以更方便地使用</p>
<span id="more"></span>
<h1 id="快捷键集合">快捷键集合</h1>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">Typora快捷键整合</span><br><span class="line">```</span><br><span class="line">Ctrl+1  一阶标题    Ctrl+B  字体加粗</span><br><span class="line">Ctrl+2  二阶标题    Ctrl+I  字体倾斜</span><br><span class="line">Ctrl+3  三阶标题    Ctrl+U  下划线</span><br><span class="line">Ctrl+4  四阶标题    Ctrl+Home   返回Typora顶部</span><br><span class="line">Ctrl+5  五阶标题    Ctrl+End    返回Typora底部</span><br><span class="line">Ctrl+6  六阶标题    Ctrl+T  创建表格</span><br><span class="line">Ctrl+L  选中某句话   Ctrl+K  创建超链接</span><br><span class="line">Ctrl+D  选中某个单词  Ctrl+F  搜索</span><br><span class="line">Ctrl+E  选中相同格式的文字   Ctrl+H  搜索并替换</span><br><span class="line">Alt+Shift+5 删除线 Ctrl+Shift+I    插入图片</span><br><span class="line">Ctrl+Shift+M    公式块 Ctrl+Shift+Q    引用</span><br><span class="line"></span><br><span class="line">注：一些实体符号需要在实体符号之前加”\”才能够显示</span><br></pre></td></tr></table></figure>
<h1 id="换行符">换行符</h1>
<p>在markdown中，段落由多个空格分隔。在Typora中，只需回车即可创建新段落。</p>
<h1 id="标题级别">标题级别</h1>
<p># 一级标题 快捷键为 Ctrl + 1 ## 二级标题 快捷键为 Ctrl + 2 ......
###### 六级标题 快捷键为 Ctrl + 6</p>
<h1 id="引用文字">引用文字</h1>
<p>&gt; + 空格 + 引用文字</p>
<h1 id="无序列表">无序列表</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Ctrl+Shift+}</span><br></pre></td></tr></table></figure>
<p>使用 * + - 都可以创建一个无序列表</p>
<ul>
<li><p>AAA</p></li>
<li><p>BBB</p></li>
<li><p>CCC</p></li>
</ul>
<h1 id="有序列表">有序列表</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Ctrl+Shift+{</span><br></pre></td></tr></table></figure>
<p>使用 1. 2. 3. 创建有序列表</p>
<ol type="1">
<li>AAA</li>
<li>BBB</li>
<li>CCC</li>
</ol>
<h1 id="任务列表">任务列表</h1>
<p> -[ ] 不勾选  -[x] 勾选</p>
<h1 id="代码块">代码块</h1>
<p>在Typora中插入程序代码的方式有两种：使用反引号 `（~
键）、使用缩进（Tab）。</p>
<ul>
<li>插入行内代码，即插入一个单词或者一句代码的情况，使用
<code>code</code> 这样的形式插入。</li>
<li>插入多行代码输入3个反引号（`） +
回车，并在后面选择一个语言名称即可实现语法高亮。</li>
</ul>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">def helloworld():</span><br><span class="line">    print("hello, world!")</span><br></pre></td></tr></table></figure>
<h1 id="数学表达式">数学表达式</h1>
<p><a href="https://blog.csdn.net/mingzhuo_126/article/details/82722455">(15条消息)
使用Typora添加数学公式_typora数学公式_姚明明的博客-CSDN博客</a></p>
<p><a href="https://blog.csdn.net/qq_43444349/article/details/105400052">(15条消息)
全面整理Typora的Latex数学公式语法_M010K的博客-CSDN博客</a></p>
<p>当你需要在编辑器中插入数学公式时，可以使用两个美元符 $$ 包裹 TeX 或
LaTeX 格式的数学公式来实现。根据需要加载 Mathjax
对数学公式进行渲染。</p>
<p>按下 <code>$$</code>，然后按下回车键，即可进行数学公式的编辑。</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">$$</span><br><span class="line">\mathbf{V}_1\times\mathbf{V}_2 = \mathbf{X}_3</span><br><span class="line">$$</span><br></pre></td></tr></table></figure>
<h1 id="插入表格">插入表格</h1>
<p>输入
<code>| 表头1 | 表头2 |</code>并回车。即可创建一个包含2列表。快捷键
<code>Ctrl + T</code>弹出对话框。</p>
<div class="line-block">id | number | | ---- | ------ | | | |</div>
<ul>
<li>不管是哪种方式，第一行为表头，第二行为分割表头和主体部分，第三行开始每一行为一个表格行</li>
<li>列与列之间用管道符号<code>|</code> 隔开</li>
<li>还可设置对齐方式(表头与内容之间)，如果不使用对齐标记，内容默认左对齐，表头居中对齐</li>
<li>左对齐 ：|</li>
<li>右对齐 |：</li>
<li>中对齐 ：|：</li>
<li>为了美观，可以使用空格对齐不同行的单元格，并在左右两侧都使用 |
来标记单元格边界</li>
<li>为了使 Markdown 更清晰，| 和 -
两侧需要至少有一个空格（最左侧和最右侧的 | 外就不需要了）。</li>
</ul>
<h1 id="脚注">脚注</h1>
<p>这个例子的脚注为[<a href="https://link.zhihu.com/?target=https%3A//www.cnblogs.com/hider/p/11614688.html%23fn1">1]</a>。</p>
<p>注意：该例子脚注标识是1，脚注标识可以为字母数字下划线，但是暂不支持中文。脚注内容可为任意字符，包括中文。</p>
<h1 id="分割线">分割线</h1>
<p>输入 <code>***</code> 或者 <code>---</code>
再按回车即可绘制一条水平线，如下：</p>
<hr>
<h1 id="目录toc">目录（TOC）</h1>
<p>输入 <code>[ toc ]</code>
然后回车，即可创建一个“目录”。TOC从文档中提取所有标题，其内容将自动更新。</p>
<h1 id="图片">图片</h1>
<p>以我的github库作为image
host，利用PicGo作为上传工具，再连接Typora，实现一条龙服务</p>
<h1 id="plugins-in-vs-code">plugins in VS Code</h1>
<ul>
<li><p>Markdown All in One：支持markdown语法</p></li>
<li><p>Markdown Preview Github：预览</p></li>
<li><p>Markmap：markdown自动生成思维导图</p></li>
</ul>
]]></content>
      <categories>
        <category>奇技淫巧</category>
      </categories>
      <tags>
        <tag>奇技淫巧</tag>
      </tags>
  </entry>
  <entry>
    <title>GPIO入门</title>
    <url>/2023/08/20/GPIO%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following
哈工深上传到B站的电控组培训来入门robomaster电控组，我购买了普中科技玄武套餐开发板作为硬件。</p>
<p>本篇介绍我学习GPIO的见闻</p>
<span id="more"></span>
<h1 id="gpio">GPIO</h1>
<h2 id="简介">简介</h2>
<p>GPIO：general purpose input
output通用输入输出，一种外设与大部分芯片引脚挂钩。</p>
<p>GPIO时最基本功能，高电平3.3V，低电平0V，<strong>单片机对外设的所有操作</strong>都通过GPIO进行的</p>
<h2 id="八种模式">八种模式</h2>
<p>四种输入，四种输出</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230815145636958.png"
alt="image-20230815145636958" />
<figcaption aria-hidden="true">image-20230815145636958</figcaption>
</figure>
<p><strong>VDD表示器件内部的工作电压，VSS通常指电路公共接地端电压</strong>。
对于数字电路来说，VDD是芯片的工作电压，VSS是接地点，在场效应管中，VDD为漏极，VSS为源极，VDD和VSS指的是元件引脚</p>
<ul>
<li><p>输入浮空：不确定，根据阈值确定0和1（不常用），浮空什么都不接，高阻态，数据传输时较多</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230815145657948.png"
alt="image-20230815145657948" />
<figcaption aria-hidden="true">image-20230815145657948</figcaption>
</figure></li>
<li><p><strong>输入上拉：</strong>拉就是把点位拉高，比如拉到Vcc。上拉就是将不确定的信号通过一个上拉电阻嵌位在高电平。电阻同时起到限流的作用。</p>
<p>无输入——1，有输入——取决于输入</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230815145710226.png"
alt="image-20230815145710226" />
<figcaption aria-hidden="true">image-20230815145710226</figcaption>
</figure></li>
<li><p><strong>输入下拉：</strong></p>
<p>无输入——0，有输入——取决于输入</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230815145727794.png"
alt="image-20230815145727794" />
<figcaption aria-hidden="true">image-20230815145727794</figcaption>
</figure></li>
<li><p>模拟输入：ADC，可推出读入电压的大小</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230815145737614.png"
alt="image-20230815145737614" />
<figcaption aria-hidden="true">image-20230815145737614</figcaption>
</figure></li>
<li><p>开漏输出：一般来说，开漏是用来连接不同电平的器件，匹配电平用的，因为开漏引脚不连接外部的上拉电阻时，只能输出低电平，如果需要同时具备输出高电平的功能，则需要接上拉电阻，很好的一个优点是通过改变上拉电源的电压，便可以改变传输电平。（低电压控制高电压）</p>
<p>0——输出0，1——浮空</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230815145748091.png"
alt="image-20230815145748091" />
<figcaption aria-hidden="true">image-20230815145748091</figcaption>
</figure></li>
<li><p><strong>推挽输出（最多）</strong>：可以输出高，低电平，连接数字器件。推挽结构一般是指两个三级管分别受到互补信号的控制，总是在一个三极管导通的时候另一个截止</p>
<p>0——0，1——1</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230815145757519.png"
alt="image-20230815145757519" />
<figcaption aria-hidden="true">image-20230815145757519</figcaption>
</figure></li>
<li><p>推挽式复用：可以理解为GPIO口被用作第二功能时的配置情况（即并非作为通用IO口使用）</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230815145810824.png"
alt="image-20230815145810824" />
<figcaption aria-hidden="true">image-20230815145810824</figcaption>
</figure></li>
<li><p>开漏式复用：可以理解为GPIO口被用作第二功能时的配置情况（即并非作为通用IO口使用）</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230815145820371.png"
alt="image-20230815145820371" />
<figcaption aria-hidden="true">image-20230815145820371</figcaption>
</figure></li>
</ul>
<h2 id="常用函数">常用函数</h2>
<ul>
<li>设置GPIO电平高低</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_GPIO_WritePin(GPIOx,GPIO_Pin,GPIO_state);</span><br></pre></td></tr></table></figure>
<p>GPIOX代表目标引脚的端口号，例如GPIOB。
GPIO_Pin代表目标引脚的引脚号，例如GPIO_Pin_5。
GPIO_state代表当前引脚的高低电平，<strong>高电平(GPIO_PIN_SET)熄灭、低电平(GPIO_PIN_RESET)点亮。</strong></p>
<ul>
<li>翻转GPIO电平状态</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_GPIO_TogglePin(GPIOx,GPIO_Pin); //toggle  v.切换</span><br></pre></td></tr></table></figure>
<ul>
<li>读取GPIO电平状态</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_GPIO_ReadPin(GPIOx,GPIO_Pin);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:GPIO用|，挺常见的（用+也一样）</p>
</blockquote>
<h2 id="实验">实验</h2>
<p>分别做了跑马灯和按键点亮GPIO的实验</p>
<h1 id="bonus">BONUS</h1>
<h2 id="cubemx">CubeMX</h2>
<h3 id="一基本概念">一、基本概念：</h3>
<ul>
<li><p>RCC： Reset and Clock Control，即复位和时钟控制。</p></li>
<li><p>HSE： High Speed External Clock
signal，高速外部时钟信号，即是OSC_IN和OSC_OUT接口所接的4~16MHz的晶振，一般接8MHz。</p>
<blockquote>
<p>Tips:72MHz，我在CubeMX中设置的72但是在keil中打开工程还是8MHz，很奇怪（我只能手动修改）</p>
</blockquote></li>
<li><p>LSE： Low Speed External Clock
signal，低速外部时钟信号，即是OSC32_IN和OSC32_OUT接口，指外部用于RTC的32.768KHz晶振。</p></li>
<li><p>HSI： High Speed Internal Clock
signal，高速内部时钟信号，出厂校准的8MHz内部RC振荡器。</p></li>
<li><p>LSI： Low Speed Internal Clock
signal，高速内部时钟信号，带有校准功能的40KHz的内部RC振荡器。</p></li>
<li><p>RTC： Real Time
Clock实时时钟，用于带有年、月、日、小时、分钟、秒钟的计时器。</p></li>
<li><p>PLL：锁相环倍频输出，其时钟输入源可选择为HSI/2、HSE或者HSE/2。倍频可选择为2~16倍，但是其输出频率最大不得超过72MHz。</p></li>
<li><p>SYSCLK：系统时钟，最高72MHz。</p></li>
<li><p>AHB：高级高性能总线，这是一种“系统总线”AHB主要用于高性能模块(如CPU、DMA和DSP等)之间的连接。AHB
系统由主模块、从模块和基础结构(Infrastructure)3部分组成，整个AHB总线上的传输都由主模块发出，由从模块负责回应。</p></li>
<li><p>APB：是一种外围总线。APB主要用于低带宽的周边外设之间的连接，例如UART等，它的总线架构不像
AHB支持多个主模块，在APB里面唯一的主模块就是APB 桥。</p></li>
</ul>
<h3 id="二外部晶振与内部晶振的区别">二、外部晶振与内部晶振的区别：</h3>
<p>外部晶振比较稳定而内部晶振的误差比较大，但如果对频率要求不高，如不涉及到串口通信和精确定时等情况时，则可以使用内部晶振。所以如果对频率要求不高，则一般是优先使用内部晶振。如果要省电，用到了SLEEP，则不能使用内部晶振，因为内部振荡会停止。</p>
<ul>
<li><p>debug:SWD，JTAG(4/5 pins)</p></li>
<li><p>选引脚后，在GPIO中进一步配置：</p>
<p>GPIO mode,maximum output
speed(速度越快耗电越大,high就完事了)</p></li>
<li><p>RCC配置时钟（Crystal）：选择HSE:Crystal/Ceramic
Reasonator外部晶振（HSI内部时钟，慢/不准确）</p>
<blockquote>
<p>Tips:时钟树的配置，晶振能在板子原理图中看</p>
</blockquote></li>
</ul>
<h2 id="普中arm仿真器">普中ARM仿真器</h2>
<p>普中免驱版ARM仿真器：选择CMSIS-DAP Debugger</p>
<blockquote>
<p>Tips:一般开始先build（比rebuild节约时间）</p>
</blockquote>
<p>可用20PIN的线直连，也可自己接线用杜邦线把仿真器和板子对应引脚连接：</p>
<p>JTAG接线方式：1、3、4、5、7、9、13、15</p>
<p>SWJ接线方式：1、 4、 7、 9</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230821005945795.png"
alt="仿真器接线" />
<figcaption aria-hidden="true">仿真器接线</figcaption>
</figure>
<h1 id="arm-仿真器种类与概念">ARM 仿真器种类与概念</h1>
<p>JTAG、SWD是仿真器协议接口。</p>
<p>JLink、ULink、ST-Link是各家公司仿真器的名字：调试仿真器是为了嵌入式程序开发时，连接电脑和单片机，方便于调试、仿真、下载嵌入式程序的设备。</p>
<h2 id="jatg协议">JATG协议</h2>
<p>JTAG（Joint Test Action
Group，联合测试行动小组）是一种国际标准测试协议（IEEE
1149.1兼容），主要用于芯片内部测试。现在多数的高级器件都支持JTAG协议，如ARM、DSP、FPGA器件等。JTAG调试接口必须使用VCC、GND电源信号，以及TMS、TCK、TDI、TDO四根调试信号，可选TRST、RESET复位信号和RTCK（同步时钟）信号。</p>
<ul>
<li>VREF:目标表参考电压信号，用于检测目标板是否供电，直接与目标板VDD相连，并不向外提供输出电压；</li>
<li>TRST:JTAG复位，连接到目标板CPU的nTRST引脚，用于复位CPU调试接口的TAP控制器；目标板上应该将此脚上拉到高电位，避免意外复位，可选引脚；</li>
<li><strong>TDI:测试数据输入，建议在目标板上上拉到VDD；</strong></li>
<li><strong>TMS:测试模式选择，必须在目标板上将此引脚上拉；</strong></li>
<li><strong>TCK:测试时钟输入，建议在目标板上将此引脚上拉；</strong></li>
<li><strong>TDO:测试数据输出；</strong></li>
<li>RTCK:
目标板提供仿真器的时钟信号，有些项目中是要求JTAG的输入与其内部时钟信号同步，仿真器利用此引脚的输入可动态的控制自己的TCK速率；</li>
<li>RESET:仿真器输出至目标CPU的系统复位信号，可选信号；</li>
</ul>
<h2 id="swd接口">SWD接口</h2>
<p>串行调试（Serial Wire
Debug），SWD是ARM调试公司提出的另外一种调试接口，相对于JTAG接口，占用更少的端口资源，四根信号如下：</p>
<ul>
<li><p>Vre：目标表参考电压信号，用于检测目标板是否供电，直接与目标板VDD相连，并不向外提供输出电压；</p></li>
<li><p>GND：公共地信号；</p></li>
<li><p>SWDIO：串行数据输入信号，作为仿真信号的双向数据信号线，建议上拉；</p></li>
<li><p>SWCLK：串行时钟输入，作为仿真信号的时钟信号线，建议下拉；</p></li>
<li><p>SWO：串行数据输出，CPU调试接口可通过SWO输出一些调试信息，该引脚可选。</p></li>
<li><p>RESET：仿真器输出至目标CPU的系统复位信号；是可选信号。</p></li>
</ul>
<blockquote>
<p>Tips:JTAG中的TRST和RESET，以及SWD中的RESET：虽然都是可选信号，建议连接，使得仿真器能够在连接器前对器件进行复位，已获得较理想的状态，便于后续连接仿真。</p>
</blockquote>
<h2 id="jlink仿真器">JLink仿真器</h2>
<p>J-Link连接到计算机用的是USB接口，而到目标板内部用的还是jtag协议。它完成了一个从软件到硬件转换的工作。</p>
<p>J-Link是德国 SEGGER 公司的仿真器，得到所有主流的 IDE 的支持。支持SWIM
/ JTAG /
SWD下载。速度，效率，功能都很好，据说是众多仿真器里最强悍的。</p>
<h2 id="ulink仿真器">ULink仿真器</h2>
<p>ULINK是ARM/KEIL公司推出的仿真器，ULINK2和ULINK
Pro仿真器。ULINK/ULINK2可以配合Keil软件实现仿真功能，</p>
<blockquote>
<p>Tips:但是要注意的是，ULINK是KEIL公司开发的仿真器，专用于KEIL平台下使用，ADS、IAR下不能使用。</p>
</blockquote>
<h2 id="st-link仿真器">ST-Link仿真器</h2>
<p>​ ST-LINK是专门针对意法半导体STM8和STM32系列芯片的仿真器。ST-LINK
/V2指定的SWIM标准接口和JTAG / SWD标准接口，其主要功能有：</p>
<ul>
<li>编程功能：可烧写FLASH ROM、EEPROM、AFR等；</li>
<li>仿真功能：支持全速运行、单步调试、断点调试等各种调试方法，可查看IO状态，变量数据等；</li>
<li>仿真性能：采用USB2.0接口进行仿真调试，单步调试，断点调试，反应速度快；</li>
<li>编程性能：采用USB2.0接口，进行SWIM / JTAG /
SWD下载，下载速度快；</li>
</ul>
<h1 id="references">References</h1>
<ul>
<li><p><a
href="https://zhuanlan.zhihu.com/p/429091473">简述调试仿真器协议（JTAG、SWD）及各类调试器（Jlink、Ulink、STlink）
- 知乎 (zhihu.com)</a></p></li>
<li><p><a
href="https://blog.csdn.net/weixin_46672094/article/details/121106421">ARM
仿真器种类与概念(JTAG、SWD、JLink、ULink、ST-Link)_arm仿真器jtag+swd接口定义_匠在江湖的博客-CSDN博客</a></p></li>
<li><p><a
href="https://blog.csdn.net/qq_35157382/article/details/119653413">嵌入式-STM32-GPIO输出和输入的HAL库函数_hal_gpio_writepin_南迦巴瓦峰_yang的博客-CSDN博客</a></p></li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>robomaster</tag>
        <tag>嵌入式</tag>
      </tags>
  </entry>
  <entry>
    <title>TIM入门</title>
    <url>/2023/08/22/TIM%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following
哈工深上传到B站的电控组培训来入门robomaster电控组，我购买了普中科技玄武套餐开发板作为硬件。</p>
<p>本篇介绍我学习TIM的见闻</p>
<span id="more"></span>
<h1 id="tim">TIM</h1>
<h2 id="简介">简介</h2>
<ul>
<li><p>定时器Timer分类：STM32中的TIM分为三大类：基本定时器（TIM6和TIM7）、通用定时器（TIMx）和高级控制定时器（TIM1和TIM8）</p>
<ul>
<li><p>基本定时器具有最基本的定时功能，可编程控制定时周期，计数器溢出(即设置定时间隔，然后自动重装载为0，重新计数)能产生中断/DMA请求。</p></li>
<li><p>通用定时器除了基本定时器的功能外，还可配置计数器装载方式，具有<strong>4个独立通道</strong>，每个通道均可进行输入捕获、输出比较、PWM输出以及单脉冲模式。中断源更多（向上溢出/向下溢出、计数器初始化/启动/停止、输入捕获、输出比较等）
HAL_Delay(ms);</p></li>
<li><p>高级定时器在通用定时器的基础上，还增加了数个功能：可输出嵌入死区时间的互补PWM、允许在指定数目的计数器周期之后更新定时器寄存器的重复计数器、刹车输入信号可以将定时器输出信号置于复位或者一个已知状态，中断源也多了一个刹车信号输入。</p>
<blockquote>
<p>Notes:可编程定时器的主要部分是一个带有自动重装载的16位累加计数器，计数器的时钟通过一个预分频器得到。软件可以读写计数器、自动重装载寄存器和预分频寄存器，即使计数器运行时也可以操作。</p>
</blockquote></li>
</ul></li>
<li><p>死区：为了避免功率元件烧毁而产生的的一段延迟时间。</p>
<blockquote>
<p>通常，大功率电机、变频器等，末端都是由大功率管、IGBT等元件组成的H桥或3相桥。每个桥的上半桥和下半桥是是绝对不能同时导通的，但高速的PWM驱动信号在达到功率元件的控制极时，往往会由于各种各样的原因产生延迟的效果，造成某个半桥元件在应该关断时没有关断，造成功率元件烧毁。死区就是在上半桥关断后，延迟一段时间再打开下半桥或在下半桥关断后，延迟一段时间再打开上半桥，从而避免功率元件烧毁。这段延迟时间就是死区。（就是上、下半桥的元件都是关断的）死区时间控制在通常的低端单片机所配备的PWM中是没有的。</p>
</blockquote></li>
<li><p>TIM的刹车功能是一种用于控制PWM输出的技术，它可以在检测到外部信号或者内部事件时，立即停止PWM输出，并将输出管脚置为预设的状态，以避免负载端出现异常或者危险的情况。</p></li>
</ul>
<h2 id="基本定时器介绍">基本定时器介绍</h2>
<p>TIM6和TIM7为基本定时器，两者资源相互独立不共享。两者各有一个可编程定时器。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230821151535921.png"
alt="image-20230821151535921" />
<figcaption aria-hidden="true">image-20230821151535921</figcaption>
</figure>
<h3 id="时基单元">时基单元</h3>
<p>时基单元是一种用于产生定时或计数功能的模块。</p>
<p>时基单元包含：</p>
<ul>
<li><p>计数器寄存器(TIMx_CNT):它可以对分频后的时钟信号进行计数，从而实现定时或计数功能。计数器的计数方向由TIMx_CR1寄存器的DIR位设置，它可以是向上计数或向下计数。计数器的当前值由TIMx_CNT寄存器保存，它是一个16位的只读寄存器。</p></li>
<li><p>预分频寄存器(TIMx_PSC):它可以对输入的时钟信号进行分频，从而降低计数器的计数速度，增加计数范围。分频器的分频比由TIMx_PSC寄存器设置，它是一个16位的预装载寄存器，即它有一个影子寄存器和一个预装载寄存器，当发生更新事件时，预装载寄存器的值会被复制到影子寄存器中。</p></li>
<li><p>自动重装载寄存器(TIMx_ARR):它可以为计数器设置一个最大值或最小值，当计数器达到这个值时，会发生溢出或下溢，并触发更新事件，该事件可用于产生中断。自动重装载寄存器由TIMx_ARR寄存器设置，它也是一个16位的预装载寄存器，具有影子寄存器和预装载寄存器。</p>
<blockquote>
<p>Tips:自动重装载寄存器是预加载的，每次读写自动重装载寄存器时，实际上是通过读写预加载寄存器实现。根据TIMx_CR1寄存器中的自动重装载预加载使能位(ARPE)，写入预加载寄存器的内容能够立即或在每次更新事件时，传送到它的影子寄存器。</p>
</blockquote></li>
</ul>
<h3 id="预分频">预分频</h3>
<p>预分频可以以系数介于1至65536之间的任意数值对计数器时钟分频。它是通过一个16位寄存器(TIMx_PSC)的计数实现分频。因为TIMx_PSC控制寄存器具有缓冲，可以在运行过程中改变它的数值，新的预分频数值将在下一个更新事件时起作用。(随时可以写)</p>
<h3 id="计数器模式">计数器模式</h3>
<p>计数器从0累加计数到自动重装载数值(TIMx_ARR寄存器：AutoReload
Register)，然后重新从0开始计数并产生一个计数器溢出事件。每次计数器溢出时可以产生更新事件。ARR=36:</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230821153155929.png"
alt="image-20230821153155929" />
<figcaption aria-hidden="true">image-20230821153155929</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230821153204740.png"
alt="image-20230821153204740" />
<figcaption aria-hidden="true">image-20230821153204740</figcaption>
</figure>
<blockquote>
<p>Tips:ARR没有预装载则为FF,只有向上计数</p>
</blockquote>
<h2 id="通用定时器介绍">通用定时器介绍</h2>
<p>在STM32F10x系列中，通用定时器有TIM2、TIM3、TIM4和TIM5，每个定时器都是完全独立的，没有互相共享任何资源。它们可以一起同步操作。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230821153334967.png"
alt="image-20230821153334967" />
<figcaption aria-hidden="true">image-20230821153334967</figcaption>
</figure>
<h3 id="计数器模式-1">计数器模式</h3>
<ul>
<li>向上计数：当TIMx_CR1寄存器中的DIR位为低的时候执行向上计数。</li>
<li>向下计数：当TIMx_CR1寄存器中的DIR位为高时时候执行向下计数。<br />
</li>
<li>中央对齐模式（向上/向下计数）</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230821153406553.png"
alt="image-20230821153406553" />
<figcaption aria-hidden="true">image-20230821153406553</figcaption>
</figure>
<h3 id="输入捕获模式">输入捕获模式</h3>
<p>在输入捕获模式下，当检测到信号上相应的边沿后，计数器的当前值被锁存到捕获/比较寄存器(TIMx_CCRx)中，同时产生输入捕获事件，该事件可以被用于产生中断。</p>
<h3 id="pwm模式">PWM模式</h3>
<p>脉冲宽度调制模式可以产生一个由TIMx_ARR寄存器确定频率（周期）、由TIMx_CCRx寄存器确定占空比的信号。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230822174411921.png"
alt="image-20230822174411921" />
<figcaption aria-hidden="true">image-20230822174411921</figcaption>
</figure>
<blockquote>
<p>Tips:eg TIMx_CCRx为8，则计数器小于8为低电平，大于等于8为高电平</p>
<p>OCxREF极性与电平相反，CCxIF是中断</p>
</blockquote>
<p>在PWM模式(模式1或模式2)下， TIMx_CNT和TIMx_CCRx始终在进行比较，
(依据计数器的计数方向)以确定是否符合TIMx_CCRx≤TIMx_CNT或者TIMx_CNT≤TIMx_CCRx。</p>
<h2 id="tim中断">TIM中断</h2>
<ul>
<li><p>定时器溢出中断</p></li>
<li><p>定时器输入捕获中断</p></li>
</ul>
<h2 id="tim重要寄存器">TIM重要寄存器</h2>
<ol type="1">
<li><p>计数器(TIMx_CNT)</p></li>
<li><p>预分频器(TIMx_PSC)</p></li>
<li><p>自动重装载寄存器(TIMx_ARR)</p></li>
<li><p>捕获/比较寄存器(TIMx_CCRx)</p></li>
</ol>
<h2 id="tim-api">TIM API</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_StatusTypeDef HAL_TIM_IC_Start_IT(TIM_HandleTypeDef *htim, uint32_t Channel)</span><br><span class="line">//IC：input capture</span><br><span class="line">HAL_StatusTypeDef HAL_TIM_IC_Stop_IT(TIM_HandleTypeDef *htim, uint32_t Channel)</span><br><span class="line"></span><br><span class="line">HAL_StatusTypeDef HAL_TIM_PWM_Start(TIM_HandleTypeDef *htim, uint32_t Channel)</span><br><span class="line"></span><br><span class="line">HAL_StatusTypeDef HAL_TIM_PWM_Stop(TIM_HandleTypeDef *htim, uint32_t Channel)</span><br><span class="line"></span><br><span class="line">HAL_StatusTypeDef HAL_TIM_Base_Start(TIM_HandleTypeDef *htim)</span><br><span class="line"></span><br><span class="line">HAL_StatusTypeDef HAL_TIM_Base_Stop(TIM_HandleTypeDef *htim)</span><br><span class="line"></span><br><span class="line">HAL_StatusTypeDef HAL_TIM_Base_Start_IT(TIM_HandleTypeDef *htim)</span><br><span class="line"></span><br><span class="line">HAL_StatusTypeDef HAL_TIM_Base_Stop_IT(TIM_HandleTypeDef *htim)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * @brief Period elapsed callback in non-blocking mode</span><br><span class="line"> * @param htim TIM handle</span><br><span class="line"> * @retval None */ </span><br><span class="line">__weak void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim) </span><br><span class="line">&#123;</span><br><span class="line"> /* Prevent unused argument(s) compilation warning */</span><br><span class="line"> UNUSED(htim);</span><br><span class="line"> /* NOTE : This function should not be modified, when the callback is needed, the HAL_TIM_PeriodElapsedCallback could be implemented in the user file */ </span><br><span class="line">&#125;</span><br><span class="line">//溢出中断</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * @brief Input Capture callback in non-blocking mode</span><br><span class="line"> * @param htim TIM IC handle</span><br><span class="line"> * @retval None</span><br><span class="line"> */ </span><br><span class="line">__weak void HAL_TIM_IC_CaptureCallback(TIM_HandleTypeDef *htim) </span><br><span class="line">&#123;</span><br><span class="line"> /* Prevent unused argument(s) compilation warning */</span><br><span class="line"> UNUSED(htim);</span><br><span class="line"> /* NOTE : This function should not be modified, when the callback is needed, the HAL_TIM_IC_CaptureCallback could be implemented in the user file */ </span><br><span class="line">&#125;</span><br><span class="line">//输入捕获的中断</span><br></pre></td></tr></table></figure>
<h1 id="实验">实验</h1>
<h2 id="实现简单定时实验">实现简单定时实验</h2>
<h3 id="cubemx">CubeMX</h3>
<p>预分频PSC : 72-1(从0开始计数所以要减1)</p>
<p>counter period: 20000-1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_TIM_Base_Start_IT(&amp;htim6);//TIM6，7是基本定时器</span><br><span class="line"></span><br><span class="line">void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)</span><br><span class="line">&#123;</span><br><span class="line">  static int cnt = 0;</span><br><span class="line">  HAL_GPIO_WritePin(GPIOF, GPIO_PIN_All, GPIO_PIN_SET);</span><br><span class="line">  HAL_GPIO_WritePin(GPIOF, showNum(cnt), GPIO_PIN_RESET);</span><br><span class="line">  cnt++;</span><br><span class="line">  if (cnt == 9)</span><br><span class="line">  &#123;</span><br><span class="line">    cnt = 0;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="实现pwm输出实验">实现PWM输出实验</h2>
<p>输出指定周期和占空比的PWM波，驱动蜂鸣器。</p>
<h3 id="cubemx-1">CubeMX</h3>
<p>通用定时器：要看原理图选择是哪个channel</p>
<p>clock source:internal clock</p>
<p>默认的串口要修改成我们想要设置为TIM的那个串口</p>
<blockquote>
<p>Tips:无TIM可以短接</p>
<p>My fault:PSC预分频设置为0无声音。。。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TIM4-&gt;ARR = M_Do;</span><br><span class="line">TIM4-&gt;CCR3 = TIM4-&gt;ARR &gt;&gt; 1;</span><br><span class="line">HAL_TIM_PWM_Start(&amp;htim4, TIM_CHANNEL_3);</span><br><span class="line">//一打开就开始运行，要写在main function中</span><br></pre></td></tr></table></figure>
<h2 id="实现输入捕获实验">实现输入捕获实验</h2>
<p>读取上一个实验中输出的PWM一个周期内的高电平时间和低电平时间。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int tim4_last_count, tim4_count, low_time, high_time;</span><br><span class="line">// 定时器输入捕获中断回调函数</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void HAL_TIM_IC_CaptureCallback(TIM_HandleTypeDef *htim)</span><br><span class="line">&#123;</span><br><span class="line">	static uint8_t flag = 0; //0代表上升沿触发；1代表下降沿触发</span><br><span class="line">	tim4_last_count = tim4_count;</span><br><span class="line">    if(flag == 0)</span><br><span class="line">    &#123;</span><br><span class="line">    tim4_count = TIM4-&gt;CCR4;</span><br><span class="line">    // 计算低电平时间</span><br><span class="line">    low_time = tim4_count - tim4_last_count;</span><br><span class="line">    if(low_time &lt; 0) low_time += 19999;</span><br><span class="line">    else low_time += 1;</span><br><span class="line">	// 修改输入捕获触发方式为下降沿触发</span><br><span class="line">    TIM_RESET_CAPTUREPOLARITY(&amp;htim4, TIM_CHANNEL_4);</span><br><span class="line">    TIM_SET_CAPTUREPOLARITY(&amp;htim4, TIM_CHANNEL_4, 		TIM_ICPOLARITY_FALLING);</span><br><span class="line">    flag = 1;</span><br><span class="line">&#125; </span><br><span class="line">else if(flag == 1)</span><br><span class="line">&#123;</span><br><span class="line">    tim4_count = TIM4-&gt;CCR4;</span><br><span class="line">    // 计算高电平时间</span><br><span class="line">    high_time = tim4_count - tim4_last_count+1;</span><br><span class="line">    // 修改输入捕获触发方式为上升沿触发</span><br><span class="line">    TIM_RESET_CAPTUREPOLARITY(&amp;htim4, TIM_CHANNEL_4);</span><br><span class="line">    TIM_SET_CAPTUREPOLARITY(&amp;htim4, TIM_CHANNEL_4, TIM_ICPOLARITY_RISING);</span><br><span class="line">    flag = 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:project中没有输入捕获的回调函数，必须自己写</p>
<p>计数器从0开始计数（有时需要+1）</p>
</blockquote>
<h1 id="references">References</h1>
<ul>
<li>哈工深电控内训</li>
<li><a
href="https://zhuanlan.zhihu.com/p/123295629">STM32第六章-TIM定时器详解
- 知乎 (zhihu.com)</a></li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>robomaster</tag>
        <tag>嵌入式</tag>
      </tags>
  </entry>
  <entry>
    <title>USART入门</title>
    <url>/2023/08/22/USART%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following
哈工深上传到B站的电控组培训来入门robomaster电控组，我购买了普中科技玄武套餐开发板作为硬件。</p>
<p>本篇介绍我学习USART的见闻——实验仍有一些问题未解决</p>
<span id="more"></span>
<h1 id="usart">USART</h1>
<h2 id="简介">简介</h2>
<ul>
<li><p>USART(Universal Synchronous/Asynchronous
Receiver/Transmitter)，通用同步(CLK同步接收和发送，数据量大选择)/异步串行接收/发送器</p>
<blockquote>
<p>Tips:UART仅有异步通信</p>
</blockquote></li>
<li><p>USART是异步串口通信<strong>协议</strong>的一种，工作原理是将传输数据的每个字符一位接一位地传输，它能将要传输的资料在串行通信与并行通信之间加以转换，能够灵活地与外部设备进行全双工数据交换（并行转串行）</p></li>
<li><p>USART有两个引脚用于传输数据，RX和TX，接线的时候应使用交叉线，此外如果是不同设备之间通信还必须有一个GND线，VCC线为可选项。</p>
<p>TX(transmitter)：发送数据</p>
<p>RX(receiver)：接收数据</p></li>
<li><p>全双工：两条线互不干扰，可同时进行发送和接收
半双工：一次只能进行发送/接收</p></li>
<li><p>异步：只需频率一样，相位可以不一样（常用）
同步：还需时钟线CLK（数据量很大时）</p></li>
<li><p>支持最基本的</p>
<ul>
<li>通用串口同步、异步通讯</li>
<li>LIN总线功能（局域互联网）</li>
<li>IRDA功能（红外通讯）</li>
<li>SmartCard功能</li>
</ul></li>
<li><p>UART：只有异步通讯</p></li>
</ul>
<h2 id="usart的通信协议"><strong>USART</strong>的通信协议</h2>
<p>一帧一帧地发送</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230608114952821.png"
alt="USART时序图" />
<figcaption aria-hidden="true">USART时序图</figcaption>
</figure>
<ul>
<li><p>起始位：当未有数据发送时，数据线处于逻辑“1”状态；先发出一个逻辑“0”信号，表示开始传输字符。</p></li>
<li><p>数据位：紧接着起始位之后。数据位的个数可以是4、5、6、7、8等，构成一个字符。通常采用ASCII码。从最低位开始传送，靠时钟定位。</p>
<blockquote>
<p>eg:00010001,先发送1</p>
</blockquote></li>
<li><p>奇偶校验位：数据为加上这一位后，使得“1”的位数应为偶数（偶校验）或奇数（奇校验），以此来校验资料传送的正确性。(弱校验)</p></li>
<li><p>停止位：它是一个字符数据的结束标志。可以是1位、1.5位、2位的高电平。
由于数据是在传输线上定时的，并且每一个设备有其自己的时钟，很可能在通信中两台设备间出现了小小的不同步。因此停止位不仅仅是<strong>表示传输的结束</strong>，并且<strong>提供计算机校正时钟同步的机会</strong>。适用于停止位的位数越多，不同时钟同步的容忍程度越大，但是数据传输率同时也越慢。</p></li>
<li><p>空闲位或起始位：处于逻辑“1”状态，表示当前线路上没有资料传送，进入空闲状态。处于逻辑“0”状态，表示开始传送下一数据段(起始位)。</p></li>
<li><p>波特率：即每秒传输的二进制位数， 用 b/s
(bps)表示，通过对时钟的控制可以改变波特率。USART具有<strong>独立</strong>的高精度波特率发生器，不占用定时/计数器。常用的波特率有：9600、115200……</p>
<blockquote>
<p>Notes:奇偶校验是弱校验，115200最常用，发送/接收的FIFO（CPU太快了
）</p>
</blockquote></li>
</ul>
<h2 id="usart工作原理"><strong>USART</strong>工作原理</h2>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230608115210441.png"
alt="image-20230608115210441" />
<figcaption aria-hidden="true">image-20230608115210441</figcaption>
</figure>
<h3 id="fifo-操作">FIFO 操作</h3>
<ul>
<li><p><strong>INTRO</strong>:FIFO 是“First-In
First-Out”的缩写，意为“先进先出”，是一种常见的队列操作。Stellaris
系列ARM 的UART 模块包含有2 个16
字节的FIFO：一个用于发送，另一个用于接收。可以将两个FIFO
分别配置为以不同深度触发中断。可供选择的配置包括：1/8、 1/4、1/2、3/4
和7/8 深度。</p>
<blockquote>
<p>Tips:例如，如果接收FIFO选择1/4，则在UART 接收到4
个数据时产生接收中断</p>
</blockquote></li>
<li><p>目的：收发FIFO 主要是为了解决UART 收发中断过于频繁而导致CPU
效率不高的问题而引入的。</p>
<p>在进行UART通信时，中断方式比轮询方式(polling)要简便且效率高。但是，如果没有收发
FIFO，则每收发一个数据都要中断处理一次，效率仍然不够高。如果有了收发FIFO，则可以在连续收发若干个数据（可多至14
个）后才产生一次中断然后一并处理，这就大大提高了收发效率。</p></li>
<li><p>发送FIFO的基本工作过程：</p>
<ul>
<li><p>只要有数据填充到发送FIFO 里，就会立即启动发送过程。</p></li>
<li><p>由于发送本身是个相对缓慢的过程，因此在发送的同时其它需要发送的数据还可以继续填充到发送
FIFO 里。</p>
<blockquote>
<p>Tips:当发送 FIFO
被填满时就不能再继续填充了，否则会造成数据丢失，此时只能等待。</p>
</blockquote></li>
<li><p>发送 FIFO 会按照填入数据的先后顺序把数据一个个发送出去，直到发送
FIFO 全空时为止。已发送完毕的数据会被自动清除，在发送FIFO
里同时会多出一个空位。</p></li>
</ul></li>
<li><p>接收FIFO的基本工作过程：</p>
<ul>
<li><p>当硬件逻辑接收到数据时，就会往接收FIFO
里填充接收到的数据。</p></li>
<li><p>程序应当及时取走这些数据，数据被取走也是在接收FIFO
里被自动删除的过程，因此在接收 FIFO 里同时会多出一个空位。</p>
<blockquote>
<p>Tips:如果在接收 FIFO 里的数据未被及时取走而造成接收FIFO
已满，则以后再接收到数据时因无空位可以填充而造成数据丢失。</p>
</blockquote></li>
</ul></li>
<li><p><strong>Notes:</strong>完全不必要担心FIFO
机制可能带来的数据丢失或得不到及时处理的问题，因为它已经帮你想到了收发过程中存在的任何问题，只要在初始化配置UART
后，就可以放心收发了， FIFO 和中断例程会自动搞定一切。</p></li>
</ul>
<h3 id="发送接收">发送接收</h3>
<ul>
<li>发送逻辑：从发送FIFO
读取的数据执行“并→串”转换。控制逻辑输出起始位在先的串行位流，并且根据控制寄存器中已编程的配置，后面紧跟着数据位（注意：最低位
LSB 先输出）、奇偶校验位和停止位。</li>
<li>接收逻辑：在检测到一个有效的起始脉冲后，对接收到的位流执行“串→并”转换。此外还会对溢出错误、奇偶校验错误、帧错误和线中止（line-break）错误进行检测，并将检测到的状态附加到被写入接收FIFO
的数据中。</li>
</ul>
<h3 id="数据收发过程">数据收发过程</h3>
<ul>
<li>发送时，数据被写入发送FIFO。如果USART
被使能，则会按照预先设置好的参数（波特率、数据位、停止位、校验位等）开始发送数据，一直到发送FIFO
中没有数据。一旦向发送FIFO 写数据（如果FIFO 未空），UART 的忙标志位BUSY
就有效，并且在发送数据期间一直保持有效。BUSY 位仅在发送FIFO
为空，且已从移位寄存器发送最后一个字符，包括停止位时才变无效。即 USART
不再使能，它也可以指示忙状态。</li>
<li>在USART
接收器空闲时，如果数据输入变成“低电平”，即接收到了起始位，则接收计数器开始运行，若起始位持续时间达到阈值，则起始位有效，否则会被认为是错误的起始位并将其忽略。</li>
<li>如果起始位有效，则根据数据字符被编程的长度，对连续的数据位进行采样。如果奇偶校验模式使能，则还会检测奇偶校验位。</li>
<li>最后，如果Rx
为高电平，则有效的停止位被确认，否则发生帧错误。当接收到一个完整的字符时，将数据存放在接收FIFO
中。</li>
</ul>
<h3 id="波特率">波特率</h3>
<ul>
<li><p>波特率除数（baud-rate divisor）是一个22 位数，它由16 位整数和6
位小数组成，<strong>是一个用来设置USART的通信速度的参数</strong>。波特率发生器使用这两个值组成的数字来决定位周期，决定发送、接收的波特率。</p>
<p>通过带有小数波特率的除法器，在足够高的系统时钟速率下，UART
可以产生所有标准的波特率，而误差很小。</p></li>
</ul>
<blockquote>
<p>Tips:根据距离的远近设置波特率的大小</p>
</blockquote>
<h3 id="中断控制">中断控制</h3>
<p>出现以下情况时，可使UART产生中断：</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230608120340707.png"
alt="image-20230608120340707" />
<figcaption aria-hidden="true">image-20230608120340707</figcaption>
</figure>
<blockquote>
<p>Tips:接收数据就绪可读</p>
</blockquote>
<p>由于所有中断事件在发送到中断控制器之前会一起进行“或运算”操作，所以<strong>任意时刻
USART
只能向中断产生一个中断请求</strong>。通过查询中断状态函数，软件可以在同一个中断服务函数里处理多个中断事件（多个并列的if
语句）</p>
<p><img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230608120555701.png" /></p>
<h3 id="使用dma收发">使用DMA收发</h3>
<ul>
<li><p>DMA（Direct Memory
Access，直接内存访问）是一种用于数据传输的技术，它可以绕过CPU直接在外设和内存之间进行数据传输。在DMA操作中，有两个重要的地址：外设基地址和内存基地址。</p>
<ul>
<li>外设基地址是指用于DMA传输的外设设备的起始地址。</li>
<li>内存基地址是指用于DMA传输的内存区域的起始地址。</li>
</ul>
<p>DMA的优点是可以减少CPU的负担，提高系统的效率和性能。</p>
<p>DMA的缺点是需要额外的硬件支持，如DMA控制器和总线仲裁器，以及额外的软件配置，如设置DMA通道、传输方向、数据量、优先级等参数。</p></li>
</ul>
<blockquote>
<p>Tips:数据传输想象成快递，本来店家需要和快递员一个一个联系，DMA就是快递柜分好类，店家就不用一个一个联系了</p>
</blockquote>
<h2 id="usart重要寄存器">USART重要寄存器</h2>
<h3 id="状态寄存器usart_sr">状态寄存器（USART_SR）</h3>
<p>通过查询状态寄存器可查询状态</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230608120652738.png"
alt="image-20230608120652738" />
<figcaption aria-hidden="true">image-20230608120652738</figcaption>
</figure>
<ul>
<li><p>TC：发送完成 (Transmission complete)</p>
<p>当包含有数据的一帧发送完成后，并且TXE=1时，由硬件将该位置’1’。如果USART_CR1中的TCIE为’1’，则产生中断。由软件序列清除该位(先读USART_SR，然后写入USART_DR)。
TC位也可以通过写入’0’来清除，只有在多缓存通讯中才推荐这种清除程序。</p>
<p>0：发送还未完成；</p>
<p>1：发送完成。</p></li>
<li><p>IDLE：监测到总线空闲 (IDLE line detected)</p>
<p>当检测到总线空闲时，该位被硬件置位。如果USART_CR1中的IDLEIE为’1’，则产生中断。由软件序列清除该位(先读USART_SR，然后读USART_DR)。</p>
<p>0：没有检测到空闲总线；</p>
<p>1：检测到空闲总线。</p>
<blockquote>
<p>Tips：
IDLE用于不知道到底有多少个字节，IDLE位不会再次被置高,直到RXNE位被置起(即又检测到一次空闲总线)</p>
</blockquote></li>
</ul>
<h3 id="控制寄存器-usart_crx">控制寄存器 （USART_CRx）</h3>
<p>有CR1、CR2、CR3三个寄存器，具体的配置较复杂，具体的可以参考《STM32中文参考手册》。</p>
<h2 id="usart-api"><strong>USART API</strong></h2>
<h3 id="接收">接收</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_StatusTypeDef HAL_UART_Receive(UART_HandleTypeDef *huart, uint8_t *pData,uint16_t Size, uint32_t Timeout)</span><br><span class="line">串口接收数据的库函数，阻塞的方式接收数据。</span><br><span class="line"></span><br><span class="line">huart :要发送数据的串口指针，pData:接收数据缓存地址，注意此处的指针形式，Size:接收数据的长度（字节数） Timeout：数据接收等待时间，CPU等待这个时间用来接收数据。</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_StatusTypeDef HAL_UART_Receive_IT(UART_HandleTypeDef *huart, uint8_t *pData,uint16_t Size)</span><br></pre></td></tr></table></figure>
<p>使用中断的方式进行接受数据，在这里需要注意的一个点是，使用中断的方式接收到数据之后，需要在中断里面在调用一次HAL_UART_Receive_IT函数，重新开启下一次数据接收，否则会导致，接收完一次数据之后，不会接收下一次数据。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_UART_Receive_IT(&amp;huart2,&amp;usart2_rdata,1);  </span><br><span class="line">//IT：interrupt type control，中断</span><br><span class="line">void HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart)  </span><br><span class="line">&#123;</span><br><span class="line">	if(huart-&gt;Instance == USART2)  //串口屏，接收中断</span><br><span class="line">	&#123;</span><br><span class="line">	HAL_UART_Receive_IT(&amp;huart2,&amp;usart2_rdata,1);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">//接收到指定长度就会产生一次中断</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_StatusTypeDef HAL_UART_Receive_DMA(UART_HandleTypeDef *huart, uint8_t*pData, uint16_t Size)</span><br><span class="line">//接收到指定长度就会产生一次中断</span><br></pre></td></tr></table></figure>
<h3 id="发送">发送</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_StatusTypeDef HAL_UART_Transmit(UART_HandleTypeDef *huart, uint8_t *pData,uint16_t Size, uint32_t Timeout)</span><br><span class="line">在发送方面，使用HAL_UART_Transmit阻塞数据发送的时候，一定要计算好发送数据的时间。如果发送时间到了，但是数据还没有发送完成的话，会导致没有发送的数据丢失</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_StatusTypeDef HAL_UART_Transmit_IT(UART_HandleTypeDef *huart, uint8_t*pData, uint16_t Size)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_StatusTypeDef HAL_UART_Transmit_DMA(UART_HandleTypeDef *huart, uint8_t*pData, uint16_t Size)</span><br></pre></td></tr></table></figure>
<h3 id="中断">中断</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void USART1_IRQHandler(void)</span><br><span class="line">&#123;</span><br><span class="line">/* USER CODE BEGIN USART1_IRQn 0 */</span><br><span class="line">/* USER CODE END USART1_IRQn 0 */</span><br><span class="line">	HAL_UART_IRQHandler(&amp;huart1);</span><br><span class="line">/* USER CODE BEGIN USART1_IRQn 1 */</span><br><span class="line">/* USER CODE END USART1_IRQn 1 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__weak void HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart)</span><br><span class="line">&#123;</span><br><span class="line">/* Prevent unused argument(s) compilation warning */</span><br><span class="line">	UNUSED(huart);</span><br><span class="line">/* NOTE: This function should not be modified, when the callback is needed,</span><br><span class="line">the HAL_UART_TxCpltCallback could be implemented in the user file*/</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__weak void HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart)</span><br><span class="line">&#123;/* Prevent unused argument(s) compilation warning */</span><br><span class="line">	UNUSED(huart);</span><br><span class="line">/* NOTE: This function should not be modified, when the callback is needed,</span><br><span class="line">the HAL_UART_RxCpltCallback could be implemented in the user file*/</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:callback函数需要重定义</p>
</blockquote>
<h1 id="实验">实验</h1>
<h2 id="cubemx">CubeMX：</h2>
<ul>
<li><p>串口在Connectivity</p></li>
<li><p>Asynchronous <em>adj.</em>[电]
异步的；不同时的；不同期的</p></li>
<li><p>Parity 奇偶校验位</p></li>
<li><p>NVIC Interrupt打开串口中断</p></li>
<li><p>DMA setting当不知道要接收多少时用DMA空闲中断，ADD-&gt;Rx</p></li>
</ul>
<h2 id="keil">Keil</h2>
<ul>
<li>勾选<strong>use micro lib</strong></li>
</ul>
<blockquote>
<p>Tips:KeilMDK配置项中Use
MicroLIB是一个选项，用于选择是否使用microlib库。microlib库是一个简化的C标准库，它专门为需要在极少量内存中运行的深层嵌入式应用程序设计的。microlib库的优点是可以减少代码的大小，但缺点是功能有限，不符合ISO
C标准和IEEE 754浮点算法标准。如果你想使用printf等函数，你可以选择Use
MicroLIB选项，或者关闭半主机模式并重写相关的底层函数。</p>
</blockquote>
<ul>
<li>DMA空闲中断</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 先打开串口空闲中断</span><br><span class="line">__HAL_UART_ENABLE_IT(&amp;huart1, UART_IT_IDLE);</span><br><span class="line">HAL_UART_Receive_DMA(&amp;huart1, receive_data, 100);</span><br><span class="line"></span><br><span class="line">//然后重写callback函数</span><br><span class="line">void UART_IDLE_Callback(UART_HandleTypeDef *huart)</span><br><span class="line"></span><br><span class="line">//最后在it.c中调用自己的中断，屏蔽默认的中断</span><br><span class="line">void USART1_IRQHandler(void)</span><br><span class="line">&#123;</span><br><span class="line">  /* USER CODE BEGIN USART1_IRQn 0 */</span><br><span class="line">	UART_IDLE_Callback(&amp;huart1);    //调用自己的中断</span><br><span class="line">	return;    //屏蔽默认的中断</span><br><span class="line">  /* USER CODE END USART1_IRQn 0 */</span><br><span class="line">  HAL_UART_IRQHandler(&amp;huart1);</span><br><span class="line">  /* USER CODE BEGIN USART1_IRQn 1 */</span><br><span class="line"></span><br><span class="line">  /* USER CODE END USART1_IRQn 1 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="串口调试助手">串口调试助手</h2>
<p>我用了xcom和sscom串口调试助手</p>
<ul>
<li>Xcom.exe中可以监视数据传输</li>
<li>DTR(Data Terminal
Ready（数据终端准备好）)：由数据终端设备（如计算机）发出，表示它已经准备好接收数据了。当DTR为高电平时，表示数据终端设备已经打开了串口，并且可以接收数据。当DTR为低电平时，表示数据终端设备已经关闭了串口，或者不想接收数据了。</li>
<li>RTS(Request To
Send（请求发送）)：由数据终端设备发出，表示它想要发送数据了，并且请求对方的许可。当RTS为高电平时，表示数据终端设备有数据要发送，并且等待对方的应答。当RTS为低电平时，表示数据终端设备没有数据要发送，或者暂停发送数据。</li>
</ul>
<h2 id="一些经验">一些经验</h2>
<p>总结下来就是遇到串口不能使用的情况应该检查以下问题：</p>
<p>（1）看看串口有没有和其他串口冲突或者被占用</p>
<p>（2）代码有没有问题，实在不行先烧官方例程看看</p>
<p>（3）检查波特率，停止位，数据位，奇偶校验位这些什么的，一定要选对</p>
<blockquote>
<p>Tips:对照Cube MX中的设置检查</p>
</blockquote>
<p>（4）还有就是要勾选<strong>use micro lib</strong>。</p>
<h2 id="bonus">BONUS</h2>
<ul>
<li><p>uint8_t_16_t_t_t</p>
<ul>
<li><p>这些类型的来源：这些数据类型中都带有_t, _t
表示这些数据类型是通过typedef定义的，而不是新的数据类型。也就是说，它们其实是我们已知的类型的别名。</p></li>
<li><p>使用这些类型的原因：方便代码的维护。比如，在C中没有bool型，于是在一个软件中，一个程序员使用int，一个程序员使用short，会比较混乱。最好用一个typedef来定义一个统一的bool</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">typedef char bool;</span><br><span class="line">typedef unsigned char           uint8_t;</span><br></pre></td></tr></table></figure></li>
<li><p>uint8_t实际上是一个char。所以输出uint8_t类型的变量实际上输出其对应的字符，而不是数值。</p></li>
</ul></li>
<li><p>句柄与普通指针的区别在于，指针包含的是引用对象的内存地址，而句柄则是由系统所管理的引用标识，该标识可以被系统重新定位到一个内存地址上。这种间接访问对象的模式增强了系统对引用对象的控制。句柄本质就是对底层硬件的指针的使用。句柄是针对内核的。大家可以理解为句柄是一个指向指针的指针。</p></li>
</ul>
<h1 id="problem">Problem</h1>
<p>在前面两个使用EXTI中断的projects中没能收到USART传来的消息？？？</p>
<p>在最后的DMA中断中收到了</p>
<figure>
<img
src="C:\Users\Immortal\AppData\Local\Temp\WeChat%20Files\88a583cc4036de8ace38c8517d0075d.jpg"
alt="88a583cc4036de8ace38c8517d0075d" />
<figcaption
aria-hidden="true">88a583cc4036de8ace38c8517d0075d</figcaption>
</figure>
<h1 id="references">References</h1>
<ul>
<li><p>哈工深电控内训</p></li>
<li><p><a
href="https://blog.csdn.net/weixin_56321457/article/details/124206957">STM32用XCOM调试助手打印不出数据_xcom串口调试助手_山野的风.的博客-CSDN博客</a></p></li>
<li><p><a
href="https://www.cnblogs.com/ChurF-Lin/p/10793111.html">基于STM32之UART串口通信协议（一）详解
- LLLIN000 - 博客园 (cnblogs.com)</a></p></li>
<li><p><a
href="https://blog.csdn.net/weixin_43281206/article/details/116279189">STM32串口通信详解以及通信异常或者卡死常见问题分析_stm32
串口传数据互相 干扰_“星云-视界”的博客-CSDN博客</a></p></li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>robomaster</tag>
        <tag>嵌入式</tag>
      </tags>
  </entry>
  <entry>
    <title>Vim（1）</title>
    <url>/2023/08/12/Vim%EF%BC%881%EF%BC%89/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following missing semester of MIT to learn Vim.</p>
<p>希望通过<a
href="https://learnvimscriptthehardway.stevelosh.com/">Learn Vimscript
the Hard Way (stevelosh.com)</a>+<a
href="https://vim-adventures.com/">Vim Adventures</a>
来进一步练习Vim的使用</p>
<p>Vim（1）——Vim的基础知识和基本操作</p>
<blockquote>
<p>双手离开鼠标！</p>
</blockquote>
<span id="more"></span>
<h1 id="why-do-i-choose-vim">Why do I choose Vim</h1>
<p><strong>Vim is an evergreen skill.</strong></p>
<ul>
<li><p>双手离开鼠标！</p></li>
<li><p>不同编辑器操作不同，但所偶有主流ide都支持vim编辑模式，一劳永逸</p>
<p>不同编程语言ide，桌面dwm，浏览器vimium，操作spreadsheet啥的全统一成vim操作了</p></li>
<li><p>高度可扩展<a href="https://vimawesome.com/">Vim
Awesome</a></p></li>
<li><p>高度可定制</p>
<p>Vim有数以百计的选项供我们定制其行为，.vimrc 就是控制 vim
行为的配置文件，位于 ~/.vimrc</p></li>
</ul>
<h1 id="vim-的哲学">Vim 的哲学</h1>
<p><strong>Vim 的接口其实是一种编程语言：</strong></p>
<p>Vim 最重要的设计思想是 Vim
的界面本身是一个程序语言。键入操作（以及他们的助记名）
本身是命令，这些命令可以组合使用。这使得移动和编辑更加高效，特别是一旦形成肌肉记忆。</p>
<p>在编程的时候，你会把大量时间花在阅读/编辑而不是在写代码上。所以，Vim
是一个<em>多模态</em>编辑器：它对于插入文字和操纵文字有不同的模式。Vim
是可编程的（可以使用 Vimscript 或者像 Python
一样的其他程序语言），<strong>Vim
的接口本身也是一个程序语言：键入操作（以及其助记名）
是命令，这些命令也是可组合的</strong>。Vim
避免了使用鼠标，因为那样太慢了；Vim 甚至避免用
上下左右键因为那样需要太多的手指移动。</p>
<p>这样的设计哲学使得 Vim 成为了一个能跟上你思维速度的编辑器。</p>
<blockquote>
<p>vim 中有一些术语：</p>
<ul>
<li>mode：模式</li>
<li>verb：vim 里执行的操作，比如删除 <code>d</code>、修改
<code>c</code>、拷贝 <code>y</code>、查找 <code>f</code> 等。verb
后面需要跟一个 motion，表示该操作生效的范围。</li>
<li>motion：vim 里移动的范围，比如向右一个字母 <code>l</code>、向下一行
<code>j</code>、向右一个单词 <code>w</code> 等。</li>
</ul>
</blockquote>
<h1 id="编辑模式">编辑模式</h1>
<p>Vim
的设计以大多数时间都花在阅读、浏览和进行少量编辑改动为基础，因此它具有多种操作模式：</p>
<ul>
<li><strong>正常模式</strong>：在文件中四处移动光标进行修改</li>
<li><strong>插入模式</strong>：插入文本</li>
<li><strong>替换模式</strong>：替换文本</li>
<li><strong>可视化模式</strong>（一般，行，块）：选中文本块</li>
<li><strong>命令模式</strong>：用于执行命令</li>
</ul>
<p>在不同的操作模式下，键盘敲击的含义也不同。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230811142738743.png"
alt="Vim cheatsheet" />
<figcaption aria-hidden="true">Vim cheatsheet</figcaption>
</figure>
<h2 id="模式切换">模式切换</h2>
<p>你可以按下
<code>&lt;ESC&gt;</code>（退出键）从任何其他模式返回正常模式。在正常模式，键入
<code>i</code>
进入插入模式（a也可以，在当前字母后进行插入）(shift+i在行开始进入insert
mode，shift+a在行末尾进入insert mode)，<code>R</code>
进入替换模式，<code>v</code> 进入可视（一般）模式，<code>V</code>
进入可视（行）模式，<code>&lt;C-v&gt;</code> （Ctrl-V, 有时也写作
<code>^V</code>）进入可视（块）模式，<code>:</code> 进入命令模式。</p>
<p>因为你会在使用 Vim 时大量使用 <code>&lt;ESC&gt;</code>
键，所以可以考虑把大小写锁定键重定义成 <code>&lt;ESC&gt;</code> 键。</p>
<h2 id="替换模式">替换模式</h2>
<p>替换模式切换 --Replace–</p>
<ul>
<li>r：替换光标所在字符</li>
<li>R：进入替换模式</li>
</ul>
<h2 id="插入模式">插入模式</h2>
<p><strong>insert</strong></p>
<ul>
<li>i：在光标前插入</li>
<li>I：在行首插入</li>
</ul>
<p><strong>append</strong></p>
<ul>
<li>a：在光标后插入</li>
<li>A：在行尾插入</li>
</ul>
<p><strong>oneLine</strong></p>
<ul>
<li>o：在下一行插入</li>
<li>O：在上一行插入</li>
</ul>
<p><strong>change</strong></p>
<ul>
<li>c：删除字符后进插入模式</li>
<li>C：删除光标处至行尾进编辑模式</li>
</ul>
<h2 id="正常模式">正常模式</h2>
<h3 id="移动">移动</h3>
<p>多数时候你会在正常模式下，使用移动命令在缓存中导航。在 Vim
里面移动也被称为 “名词”， 因为它们指向文字块。（均可以改）</p>
<ul>
<li><p>基本移动: <code>hjkl</code> （左， 下， 上， 右）</p></li>
<li><p>词： <code>w</code> （下一个词）， <code>b</code> （词初begin），
<code>e</code> （词尾end）</p></li>
<li><p>行： <code>0</code> （行初）， <code>^</code>
（第一个非空格字符）， <code>$</code> （行尾）</p></li>
<li><p>屏幕： <code>H</code> （屏幕首行）， <code>M</code>
（屏幕中间）， <code>L</code> （屏幕底部）</p></li>
<li><p>翻页： <code>Ctrl-u</code> （上翻半页）， <code>Ctrl-d</code>
（下翻半页）；<code>Ctrl-b</code> （上翻）， <code>Ctrl-f</code>
（下翻）</p></li>
<li><p><code>zz</code>使当前行位于中间，<code>zb</code>使当前行位于末尾，<code>zt</code>使当前行置顶</p></li>
<li><p><code>za</code>快捷，切换代码块状态(zc：快捷，折叠代码块,zo：快捷，打开代码块)</p></li>
<li><p>文件： <code>gg</code> （文件头）， <code>G</code>
（文件尾）</p></li>
<li><p>行数： <code>:&#123;行数&#125;&lt;CR&gt;</code> 或者 <code>&#123;行数&#125;G</code>
({行数}为行数)</p></li>
<li><p>杂项： <code>%</code> （找到配对，比如括号或者 /* */
之类的注释对）</p></li>
<li><p>查找：大写往后找，小写往前找（同一行内）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">f&#123;字符&#125;：落在字母上</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">t&#123;字符&#125;：落在字母前</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">F&#123;字符&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">T&#123;字符&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>查找/到 向前/向后 在本行的{字符}</li>
<li><strong><code>,</code> / <code>;</code>
用于导航匹配</strong>,非常有用！，/{word}
enter，n(next)可以搜索下一个</li>
</ul></li>
<li><p>搜索: <code>/&#123;正则表达式&#125;</code>, <code>n</code> / <code>N</code>
用于导航匹配</p></li>
</ul>
<h3 id="编辑">编辑</h3>
<p>所有你需要用鼠标做的事，
你现在都可以用键盘：采用编辑命令和移动命令的组合来完成。 这就是 Vim
的界面开始看起来像一个程序语言的时候。Vim 的编辑命令也被称为 “动词”，
因为动词可以施动于名词。</p>
<ul>
<li><p>i/a</p>
<p>进入插入模式</p>
<ul>
<li>但是对于操纵/编辑文本，不单想用退格键完成</li>
</ul></li>
<li><p><code>O</code> / <code>o</code> 在之上/之下插入行</p></li>
<li><p>d{移动命令}</p>
<blockquote>
<p>Tips:d理解为剪切比较好，因为vim有缓存区，所以删除的可以再p粘贴</p>
</blockquote>
<p>d删除 {移动命令}</p>
<ul>
<li>例如，<code>dw</code> 删除词, <code>d$</code> 删除到行尾,
<code>d0</code>
删除到行头,<code>dd</code>删除整行，<code>D</code>直接删除到末尾</li>
</ul></li>
<li><p>c{移动命令}</p>
<p>c改变 {移动命令}</p>
<ul>
<li>例如，<code>cw</code> 改变词</li>
<li>等价于 <code>d&#123;移动命令&#125;</code> 再 <code>i</code></li>
</ul></li>
<li><p><code>x</code> 删除字符（等同于 <code>dl</code>）</p></li>
<li><p><code>s</code> 删除字符并进入insert mode（等同于
<code>xi</code>）</p></li>
<li><p><code>r</code>替换字符（无副作用即不会进入insert
mode）一般f{字母}+r</p></li>
<li><p>可视化模式 + 操作</p>
<ul>
<li>选中文字, <code>d</code> 删除 或者 <code>c</code> 改变</li>
</ul></li>
<li><p><number><code>u</code> 撤销, <code>&lt;C-r&gt;</code>
重做</p></li>
<li><p><code>y&#123;移动命令&#125;</code> 复制 / “yank” （其他一些命令比如
<code>d</code> 也会复制）yy复制当前行</p></li>
<li><p><code>p</code> 粘贴在后面，<code>P</code>在前面粘贴</p></li>
<li><p><code>.</code>重复刚才的操作（当想在不同的地方写相同的东西，很有用）</p></li>
<li><p>更多值得学习的: 比如 <code>~</code> 改变字符的大小写</p></li>
<li><p><code>J</code>:合并两行(删除当前行行尾的换行符)</p></li>
<li><p><code>~</code>切换将光标所在位置的字符大小写互换</p></li>
<li><p>可视模式下，选中字母后，按U将其换成大写</p></li>
<li><p>可视模式下，选中字母后，按u将其换成小写</p></li>
</ul>
<h3 id="计数">计数</h3>
<p>你可以用一个计数来结合“名词”和“动词”，这会执行指定操作若干次。</p>
<ul>
<li><code>3w</code> 向前移动三个词</li>
<li><code>5j</code> 向下移动5行</li>
<li><code>7dw</code> 删除7个词</li>
</ul>
<h3 id="修饰语">修饰语</h3>
<p>你可以用修饰语改变“名词”的意义。修饰语有
<code>i</code>，表示“内部”或者“inside“，和 <code>a</code>，
表示”around“。</p>
<ul>
<li><code>ci(</code> 改变当前括号内的内容</li>
<li><code>ci[</code> 改变当前方括号内的内容</li>
<li><code>da'</code> 删除一个单引号字符串， 包括周围的单引号</li>
</ul>
<h2 id="命令模式">命令模式</h2>
<p>在正常模式下键入 <code>:</code> 进入命令行模式。 在键入
<code>:</code> 后，你的光标会立即跳到屏幕下方的命令行。
这个模式有很多功能，包括打开，保存，关闭文件，以及 <a
href="https://twitter.com/iamdevloper/status/435555976687923200">退出
Vim</a>。</p>
<ul>
<li><p><code>:set number</code>对行进行编号，想要到哪行就:<number>即可</p></li>
<li><p><code>:q</code> 退出（关闭窗口）</p></li>
<li><p><code>:w</code> 保存（写）</p></li>
<li><p><code>:wq</code> 保存然后退出</p></li>
<li><p><code>:q!</code>放弃更改并退出</p></li>
<li><p><code>:e &#123;文件名&#125;</code> 打开要编辑的文件</p></li>
<li><p><code>:ls</code> 显示打开的缓存</p></li>
<li><p>:help {标题}</p>
<p>打开帮助文档</p>
<ul>
<li><code>:help :w</code> 打开 <code>:w</code> 命令的帮助文档</li>
<li><code>:help w</code> 打开 <code>w</code> 移动的帮助文档</li>
</ul></li>
<li><p><code>+p</code>粘贴</p></li>
<li><p><code>:!+&lt;command line&gt;</code>不退出vim界面也可以直接运行命令</p></li>
</ul>
<h2 id="可视化模式">可视化模式</h2>
<ul>
<li>可视化：<code>v</code></li>
<li>可视化行： <code>V</code></li>
<li>可视化块（矩形）：<code>Ctrl+v</code></li>
</ul>
<p>可以用移动命令来选中。</p>
<h1 id="references">References</h1>
<ul>
<li><p><a
href="https://missing-semester-cn.github.io/2020/editors/">编辑器 (Vim)
· the missing semester of your cs education
(missing-semester-cn.github.io)</a></p></li>
<li><p>【VS Code ×
Vim：提高你的编码效率】https://www.bilibili.com/video/BV1MX4y1b7nM?vd_source=93bb338120537438ee9180881deab9c1</p></li>
<li><p><a href="https://zhuanlan.zhihu.com/p/430603620">vscode + vim
全键盘操作高效搭配方案 - 知乎 (zhihu.com)</a></p></li>
<li><p><a href="https://zhuanlan.zhihu.com/p/44044896">VS Code
的常用快捷键 - 知乎 (zhihu.com)</a></p></li>
<li><p><a
href="https://blog.csdn.net/weixin_42514042/article/details/124169302">VSCode
vim 使用vimrc配置 vim使用系统剪切板配置_vscode
vimrc_未知褶皱的博客-CSDN博客</a></p></li>
<li><p><a
href="https://blog.csdn.net/m0_47670683/article/details/125160391?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-125160391-blog-121179927.235%5Ev38%5Epc_relevant_sort_base3&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-125160391-blog-121179927.235%5Ev38%5Epc_relevant_sort_base3&amp;utm_relevant_index=1">VSCode使用Vim插件心得_vscode
vim插件_皛心的博客-CSDN博客</a></p></li>
</ul>
]]></content>
      <categories>
        <category>CS</category>
      </categories>
      <tags>
        <tag>CS</tag>
      </tags>
  </entry>
  <entry>
    <title>Vim（2）</title>
    <url>/2023/08/13/Vim%EF%BC%882%EF%BC%89/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following missing semester of MIT to learn Vim.</p>
<p>希望通过<a
href="https://learnvimscriptthehardway.stevelosh.com/">Learn Vimscript
the Hard Way (stevelosh.com)</a>+<a
href="https://vim-adventures.com/">Vim Adventures</a>
来进一步练习Vim的使用</p>
<p>Vim（2）——Vim的进阶知识(我也还没用到宏，以后重新整理填坑)</p>
<blockquote>
<p>双手离开鼠标！</p>
</blockquote>
<span id="more"></span>
<h1 id="vim-进阶">Vim 进阶</h1>
<p>一个好的对策是: 当你在使用你的编辑器的时候感觉
“一定有更好的方法来做这个”， 那么很可能真的有：上网搜寻一下。</p>
<h2 id="缓存标签页窗口">缓存，标签页，窗口</h2>
<p>Vim 会维护一系列打开的文件，称为“缓存”。一个 Vim
会话包含一系列标签页，每个标签页包含
一系列窗口（分隔面板）。每个窗口显示一个缓存。跟网页浏览器等其他你熟悉的程序不一样的是，
缓存和窗口不是一一对应的关系；窗口只是视角。一个缓存可以在<em>多个</em>窗口打开，甚至在同一
个标签页内的多个窗口打开。这个功能其实很好用，比如在查看同一个文件的不同部分的时候。</p>
<p>Vim 默认打开一个标签页，这个标签也包含一个窗口。</p>
<h2 id="搜索和替换">搜索和替换</h2>
<p><code>:s</code> （替换）命令（<a
href="http://vim.wikia.com/wiki/Search_and_replace">文档</a>）。</p>
<ul>
<li><code>%s/foo/bar/g</code>
<ul>
<li>在整个文件中将 foo 全局替换成 bar</li>
</ul></li>
<li><code>%s/\[.*\](\(.*\))/\1/g</code>
<ul>
<li>将有命名的 Markdown 链接替换成简单 URLs</li>
</ul></li>
</ul>
<h2 id="多窗口">多窗口</h2>
<ul>
<li>用 <code>:sp</code> / <code>:vsp</code> 来分割窗口</li>
<li>同一个可以buffer在多个窗口中显示。</li>
</ul>
<h2 id="宏">宏</h2>
<ul>
<li><p><code>q&#123;字符&#125;</code>
来开始在寄存器<code>&#123;字符&#125;</code>中录制宏</p></li>
<li><p><code>q</code>停止录制</p></li>
<li><p><code>@&#123;字符&#125;</code> 重放宏</p></li>
<li><p>宏的执行遇错误会停止</p></li>
<li><p><code>&#123;计数&#125;@&#123;字符&#125;</code>执行一个宏{计数}次</p></li>
<li><p>宏可以递归</p>
<ul>
<li>首先用<code>q&#123;字符&#125;q</code>清除宏</li>
<li>录制该宏，用 <code>@&#123;字符&#125;</code> 来递归调用该宏
（在录制完成之前不会有任何操作）</li>
</ul></li>
<li><p>例子：将 xml 转成 json (</p>
<p>file</p>
<p>)</p>
<ul>
<li><p>一个有 “name” / “email” 键对象的数组</p></li>
<li><p>用一个 Python 程序？</p></li>
<li><p>用 sed / 正则表达式</p>
<ul>
<li><code>g/people/d</code></li>
<li><code>%s/&lt;person&gt;/&#123;/g</code></li>
<li><code>%s/&lt;name&gt;\(.*\)&lt;\/name&gt;/"name": "\1",/g</code></li>
<li>…</li>
</ul></li>
<li><p>Vim 命令 / 宏</p>
<ul>
<li><p><code>Gdd</code>, <code>ggdd</code> 删除第一行和最后一行</p></li>
<li><p>格式化最后一个元素的宏 （寄存器</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e</span><br></pre></td></tr></table></figure>
<p>）</p>
<ul>
<li>跳转到有 <code>&lt;name&gt;</code> 的行</li>
<li><code>qe^r"f&gt;s": "&lt;ESC&gt;f&lt;C"&lt;ESC&gt;q</code></li>
</ul></li>
<li><p>格式化一个</p>
<p>的宏</p>
<ul>
<li>跳转到有 <code>&lt;person&gt;</code> 的行</li>
<li><code>qpS&#123;&lt;ESC&gt;j@eA,&lt;ESC&gt;j@ejS&#125;,&lt;ESC&gt;q</code></li>
</ul></li>
<li><p>格式化一个</p>
<p>标签然后转到另外一个的宏</p>
<ul>
<li>跳转到有 <code>&lt;person&gt;</code> 的行</li>
<li><code>qq@pjq</code></li>
</ul></li>
<li><p>执行宏到文件尾</p>
<ul>
<li><code>999@q</code></li>
</ul></li>
<li><p>手动移除最后的 <code>,</code> 然后加上 <code>[</code> 和
<code>]</code> 分隔符</p></li>
</ul></li>
</ul></li>
</ul>
<h1 id="自定义-vim">自定义 Vim</h1>
<p>Vim 由一个位于 <code>~/.vimrc</code> 的文本配置文件（包含 Vim
脚本命令）。你可能会启用很多基本设置。</p>
<p>我们提供一个文档详细的基本设置，你可以用它当作你的初始设置。我们推荐使用这个设置因为它修复了一些
Vim 默认设置奇怪行为。 <strong>在<a
href="https://missing-semester-cn.github.io/2020/files/vimrc">这儿</a>
下载Missing semester的设置，然后将它保存成
<code>~/.vimrc</code>.</strong></p>
<p>Vim
能够被重度自定义，花时间探索自定义选项是值得的。你可以参考其他人的在
GitHub 上共享的设置文件。
有很多好的博客文章也聊到了这个话题。尽量不要复制粘贴别人的整个设置文件，
而是阅读和理解它，然后采用对你有用的部分。</p>
<h1 id="扩展-vim">扩展 Vim</h1>
<p>Vim 有很多扩展插件。跟很多互联网上已经过时的建议相反，你不需要在 Vim
使用一个插件 管理器（从 Vim 8.0
开始）。你可以使用内置的插件管理系统。只需要创建一个
<code>~/.vim/pack/vendor/start/</code>
的文件夹，然后把插件放到这里（比如通过 <code>git clone</code>）。</p>
<p>以下是一些好用的我们最爱的插件：</p>
<ul>
<li><a href="https://github.com/ctrlpvim/ctrlp.vim">ctrlp.vim</a>:
模糊文件查找</li>
<li><a href="https://github.com/mileszs/ack.vim">ack.vim</a>:
代码搜索</li>
<li><a href="https://github.com/scrooloose/nerdtree">nerdtree</a>:
文件浏览器</li>
<li><a
href="https://github.com/easymotion/vim-easymotion">vim-easymotion</a>:
魔术操作</li>
</ul>
<p>我们尽量避免在这里提供一份冗长的插件列表。可以查看missing
semester讲师们的开源的配置文件 (<a
href="https://github.com/anishathalye/dotfiles">Anish</a>, <a
href="https://github.com/jonhoo/configs">Jon</a>, <a
href="https://github.com/JJGO/dotfiles">Jose</a>)
来看看我们使用的其他插件。 浏览 <a href="https://vimawesome.com/">Vim
Awesome</a> 来了解一些很棒的插件。 这个话题也有很多博客文章：搜索 “best
Vim plugins”。</p>
<h1 id="references">References</h1>
<ul>
<li><p><a
href="https://missing-semester-cn.github.io/2020/editors/">编辑器 (Vim)
· the missing semester of your cs education
(missing-semester-cn.github.io)</a></p></li>
<li><p>【VS Code ×
Vim：提高你的编码效率】https://www.bilibili.com/video/BV1MX4y1b7nM?vd_source=93bb338120537438ee9180881deab9c1</p></li>
<li><p><a href="https://zhuanlan.zhihu.com/p/430603620">vscode + vim
全键盘操作高效搭配方案 - 知乎 (zhihu.com)</a></p></li>
<li><p><a href="https://zhuanlan.zhihu.com/p/44044896">VS Code
的常用快捷键 - 知乎 (zhihu.com)</a></p></li>
<li><p><a
href="https://blog.csdn.net/weixin_42514042/article/details/124169302">VSCode
vim 使用vimrc配置 vim使用系统剪切板配置_vscode
vimrc_未知褶皱的博客-CSDN博客</a></p></li>
<li><p>[VSCode使用Vim插件心得_vscode
vim插件_皛心的博客-CSDN博客](</p></li>
</ul>
]]></content>
      <categories>
        <category>CS</category>
      </categories>
      <tags>
        <tag>CS</tag>
      </tags>
  </entry>
  <entry>
    <title>Vim（3）</title>
    <url>/2023/08/14/Vim%EF%BC%883%EF%BC%89/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following missing semester of MIT to learn Vim.</p>
<p>希望通过<a
href="https://learnvimscriptthehardway.stevelosh.com/">Learn Vimscript
the Hard Way (stevelosh.com)</a>+<a
href="https://vim-adventures.com/">Vim Adventures</a>
来进一步练习Vim的使用</p>
<p>Vim（3）——Vim在其他应用上的应用</p>
<blockquote>
<p>双手离开鼠标！</p>
</blockquote>
<span id="more"></span>
<h1 id="vim-in-other-programs">Vim in other programs</h1>
<p>很多工具提供了 Vim 模式。这些 Vim
模式的质量参差不齐；取决于具体工具，有的提供了很多酷炫的 Vim
功能，但是大多数对基本功能支持的很好。</p>
<h2 id="shell">Shell</h2>
<p>如果你是一个 Bash 用户，用 <code>set -o vi</code>。如果你用
Zsh：<code>bindkey -v</code>。Fish 用
<code>fish_vi_key_bindings</code>。另外，不管利用什么 shell，你可以
<code>export EDITOR=vim</code>。
这是一个用来决定当一个程序需要启动编辑时启动哪个的环境变量。
例如，<code>git</code> 会使用这个编辑器来编辑 commit 信息。</p>
<h2 id="readline">Readline</h2>
<p>很多程序使用 <a
href="https://tiswww.case.edu/php/chet/readline/rltop.html">GNU
Readline</a> 库来作为 它们的命令控制行界面。Readline 也支持基本的 Vim
模式， 可以通过在 <code>~/.inputrc</code> 添加如下行开启：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set editing-mode vi</span><br></pre></td></tr></table></figure>
<p>比如，在这个设置下，Python REPL 会支持 Vim 快捷键。</p>
<h2 id="vscode">VSCode</h2>
<p>add extention——vim,enable</p>
<p>Vim有些功能在VSCode中不能用，例如宏录制</p>
<h3 id="导入vimrc">导入vimrc</h3>
<p>再vscode的setting中enable vimrc配置方式，并填写vimrc文件地址</p>
<p>用 vscode 打开 my.vimrc 文件，输入
<code>set clipboard=unnamedplusset</code>。或者，直接在设置中搜索
<code>vim.useSystemClipboard</code> ，打钩。默认使用的 vim
无名缓存器已经与系统剪切板连通了。</p>
<h3 id="vscode常用快捷键">VSCode常用快捷键</h3>
<ul>
<li><p>ctrl+B:侧边栏隐藏/显示</p></li>
<li><p>ctrl+J:终端显示</p></li>
<li><p>ctrl+Tab:切换tab</p></li>
<li><p>ctrl+<number>：切换分屏，没有就创建</p></li>
<li><p>ctrl+\:水平分屏</p></li>
<li><p>ctrl+k+ctrl+\:竖直分屏;我改为:ctrl+&lt;]+\&gt;</p></li>
<li><p>ctrl+w:删除当前屏幕（当当前屏幕无tab时）or tab</p></li>
<li><p>ctrl+P:搜索文件,加上&gt;等价于ctrl+shift+P</p></li>
<li><p>ctrl+shift+P:VSCode中的，命令:open folder</p></li>
<li><p>ctrl+,:打开settings:配置一些json文件+vim</p></li>
</ul>
<p>函数定义之类：</p>
<ul>
<li><code>gd</code> : 进入函数定义</li>
<li><code>Ctrl+o</code> : 从函数定义中返回</li>
<li><code>gh</code> : 查看函数参数等信息</li>
</ul>
<h2 id="vimium">Vimium</h2>
<ul>
<li><p>基础移动hjkl,gg,G</p></li>
<li><p>J，K跳转标签页，H(Shift+h):打开上一个网页，L(Shift+l):打开下一个网页</p></li>
<li><p>g0，g$跳转到第一个，最后一个标签页</p></li>
<li><p>t:打开新的标签页</p></li>
<li><p>x:关闭当前标签页；X重新打开最后关闭的标签页</p></li>
<li><p>d向下翻半页，u向上翻半页</p></li>
<li><p>yy:复制当前页面地址到剪切板。如下图所示,按下yy后在按下Win+V可以看到已经将当前页面的链接复制到剪切板了</p></li>
<li><p>p（P）:如果剪切板第一个是URL，则打开链接，是记录则搜索该内容</p></li>
<li><p>建议直接Tab or shift+Tab（
gi:定位到页面中的第一个输入框,前面也可以加数字）</p></li>
<li><p>r:刷新界面</p></li>
<li><p><strong>f（F）</strong>:在当前（新）标签页打开指定的链接。如下图所示,按下f后就会在链接上出现字母或者字母组合,只要按下相应的字母或者字母组合就可以打开对应的链接</p></li>
</ul>
<blockquote>
<p>Tips:好用！</p>
</blockquote>
<ul>
<li><strong>o（O）</strong>:在当前（新）标签页打开链接、书签（b是打开书签）、历史记录。如下图所示,按下o输入关键字后可以看到有符合条件的历史记录、书签等结果,可以通过上下箭头选择项目后按下Enter键即可在当前（新）标签页打开所选的项目。</li>
<li>T:是在所有打开的标签页中搜索/</li>
<li>m:添加标记,当你看一篇长文章时,如果你需要看前面的内容,或者想先看后面某部分内容再回来看当前的内容,则可以通过标记实现这需求。通过按下m之后再按一个字母就可以在当前位置标记,如果你在页面的其他地方想回到标记的地方,则可以通过`+之前标记的字母快速返回。</li>
</ul>
<h3 id="复制东西">复制东西</h3>
<p>一般先/{}匹配到位置，再v进入可视化y复制</p>
<h2 id="其他">其他</h2>
<p>甚至有 Vim 的网页浏览快捷键 <a
href="http://vim.wikia.com/wiki/Vim_key_bindings_for_web_browsers">browsers</a>,
受欢迎的有用于 Google Chrome 的 <a
href="https://chrome.google.com/webstore/detail/vimium/dbepggeogbaibhgnhhndojpepiihcmeb?hl=en">Vimium</a>
和用于 Firefox 的 <a
href="https://github.com/tridactyl/tridactyl">Tridactyl</a>。
你甚至可以在 <a
href="https://github.com/lambdalisue/jupyter-vim-binding">Jupyter
notebooks</a> 中用 Vim 快捷键。 <a
href="https://reversed.top/2016-08-13/big-list-of-vim-like-software">这个列表</a>
中列举了支持类 vim 键位绑定的软件。</p>
<h1 id="references">References</h1>
<ul>
<li><p><a
href="https://blog.csdn.net/weixin_42514042/article/details/124169302">VSCode
vim 使用vimrc配置 vim使用系统剪切板配置_vscode
vimrc_未知褶皱的博客-CSDN博客</a></p></li>
<li><p><a
href="https://blog.csdn.net/m0_47670683/article/details/125160391?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-125160391-blog-121179927.235%5Ev38%5Epc_relevant_sort_base3&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-125160391-blog-121179927.235%5Ev38%5Epc_relevant_sort_base3&amp;utm_relevant_index=1">VSCode使用Vim插件心得_vscode
vim插件_皛心的博客-CSDN博客</a></p></li>
<li><p><a
href="https://zhuanlan.zhihu.com/p/113316942">Chrome插件Vimium使用教程 -
知乎 (zhihu.com)</a></p></li>
<li><p>【VS Code ×
Vim：提高你的编码效率】https://www.bilibili.com/video/BV1MX4y1b7nM?vd_source=93bb338120537438ee9180881deab9c1</p></li>
</ul>
]]></content>
      <categories>
        <category>CS</category>
      </categories>
      <tags>
        <tag>CS</tag>
      </tags>
  </entry>
  <entry>
    <title>YAML初探</title>
    <url>/2023/08/08/YAML%E5%88%9D%E6%8E%A2/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>利用hexo和next遇到了YAML语法写的config，借此机会了解下YAML语言</p>
<p>目标：了解基本语法，能看懂就行（虽然大部分都是copy但是人家真写得够简洁了）</p>
<span id="more"></span>
<h1 id="introduction">Introduction</h1>
<p>YAML (（发音 /ˈjæməl/
）)是专门用来写配置文件的语言，非常简洁和强大，远比 JSON
格式方便，实质上是一种通用的数据串行化格式。</p>
<h1 id="基本语法规则">基本语法规则</h1>
<ul>
<li>大小写敏感</li>
<li>使用缩进表示层级关系</li>
<li>缩进时不允许使用Tab键，只允许使用空格。</li>
<li>缩进的空格数目不重要，只要相同层级的元素左侧对齐即可</li>
<li># 是注释</li>
</ul>
<h1 id="数据结构">数据结构</h1>
<h3 id="对象">对象</h3>
<p>键值对的集合，又称为映射（mapping）/ 哈希（hashes） /
字典（dictionary）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">animal: pets</span><br><span class="line">hash: &#123; name: Steve, foo: bar &#125; #也可以将所有键值对写成一个行内对象</span><br></pre></td></tr></table></figure>
<h3 id="数组">数组</h3>
<p>一组按次序排列的值，又称为序列（sequence） / 列表（list）</p>
<p>一组连词线开头的行，构成一个数组。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">- <span class="title class_">Cat</span></span><br><span class="line">- <span class="title class_">Dog</span></span><br><span class="line">- <span class="title class_">Goldfish</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>数据结构的子成员是一个数组，则可以在该项下面缩进一个空格。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">-</span><br><span class="line"> - <span class="title class_">Cat</span></span><br><span class="line"> - <span class="title class_">Dog</span></span><br><span class="line"> - <span class="title class_">Goldfish</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>数组也可以采用行内表示法。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">animal</span>: [<span class="title class_">Cat</span>, <span class="title class_">Dog</span>]</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>Tips:对象和数组可以结合使用，形成复合结构。</p>
</blockquote>
<h3 id="纯量scalars">纯量（scalars）</h3>
<p>单个的、不可再分的值，以下数据类型都属于 JavaScript 的纯量。</p>
<blockquote>
<ul>
<li>字符串</li>
<li>布尔值</li>
<li>整数</li>
<li>浮点数</li>
<li>Null</li>
<li>时间</li>
<li>日期</li>
</ul>
</blockquote>
<p>数值直接以字面量的形式表示。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">number</span>: <span class="number">12.30</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>布尔值用<code>true</code>和<code>false</code>表示。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">isSet</span>: <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>null</code>用<code>~</code>表示。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">parent</span>: ~ </span><br></pre></td></tr></table></figure>
</blockquote>
<p>时间采用 ISO8601 格式。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">iso8601</span>: <span class="number">2001</span>-<span class="number">12</span>-14<span class="attr">t21</span>:<span class="number">59</span>:<span class="number">43.10</span>-<span class="number">05</span>:<span class="number">00</span> </span><br></pre></td></tr></table></figure>
</blockquote>
<p>日期采用复合 iso8601 格式的年、月、日表示。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">date</span>: <span class="number">1976</span>-<span class="number">07</span>-<span class="number">31</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>YAML 允许使用两个感叹号，强制转换数据类型。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">e</span>: !!str <span class="number">123</span></span><br><span class="line"><span class="attr">f</span>: !!str <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>转为 JavaScript 如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="attr">e</span>: <span class="string">&#x27;123&#x27;</span>, <span class="attr">f</span>: <span class="string">&#x27;true&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="字符串">字符串</h1>
<p>字符串是最常见，也是最复杂的一种数据类型。</p>
<p>字符串默认不使用引号表示。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">str</span>: 这是一行字符串</span><br></pre></td></tr></table></figure>
</blockquote>
<p>转为 JavaScript 如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="attr">str</span>: <span class="string">&#x27;这是一行字符串&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>如果字符串之中包含空格或特殊字符，需要放在引号之中。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">str</span>: <span class="string">&#x27;内容： 字符串&#x27;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>转为 JavaScript 如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="attr">str</span>: <span class="string">&#x27;内容: 字符串&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>单引号和双引号都可以使用，<strong>双引号不会对特殊字符转义</strong>。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">s1</span>: <span class="string">&#x27;内容\n字符串&#x27;</span></span><br><span class="line"><span class="attr">s2</span>: <span class="string">&quot;内容\n字符串&quot;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>转为 JavaScript 如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="attr">s1</span>: <span class="string">&#x27;内容\\n字符串&#x27;</span>, <span class="attr">s2</span>: <span class="string">&#x27;内容\n字符串&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>单引号之中如果还有单引号，必须连续使用两个单引号转义。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">str</span>: <span class="string">&#x27;labor&#x27;</span><span class="string">&#x27;s day&#x27;</span> </span><br></pre></td></tr></table></figure>
</blockquote>
<p>转为 JavaScript 如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="attr">str</span>: <span class="string">&#x27;labor\&#x27;s day&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>字符串可以写成多行，从第二行开始，必须有一个单空格缩进。换行符会被转为空格。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">str</span>: 这是一段</span><br><span class="line">  多行</span><br><span class="line">  字符串</span><br></pre></td></tr></table></figure>
</blockquote>
<p>转为 JavaScript 如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="attr">str</span>: <span class="string">&#x27;这是一段 多行 字符串&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>多行字符串可以使用<code>|</code>保留换行符，也可以使用<code>&gt;</code>折叠换行。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">this</span>: |</span><br><span class="line">  <span class="title class_">Foo</span></span><br><span class="line">  <span class="title class_">Bar</span></span><br><span class="line"><span class="attr">that</span>: &gt;</span><br><span class="line">  <span class="title class_">Foo</span></span><br><span class="line">  <span class="title class_">Bar</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>转为 JavaScript 代码如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="attr">this</span>: <span class="string">&#x27;Foo\nBar\n&#x27;</span>, <span class="attr">that</span>: <span class="string">&#x27;Foo Bar\n&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>+</code>表示保留文字块末尾的换行，<code>-</code>表示删除字符串末尾的换行。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">s1</span>: |</span><br><span class="line">  <span class="title class_">Foo</span></span><br><span class="line"></span><br><span class="line"><span class="attr">s2</span>: |+</span><br><span class="line">  <span class="title class_">Foo</span></span><br><span class="line"></span><br><span class="line"><span class="attr">s3</span>: |-</span><br><span class="line">  <span class="title class_">Foo</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>转为 JavaScript 代码如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="attr">s1</span>: <span class="string">&#x27;Foo\n&#x27;</span>, <span class="attr">s2</span>: <span class="string">&#x27;Foo\n\n\n&#x27;</span>, <span class="attr">s3</span>: <span class="string">&#x27;Foo&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>字符串之中可以插入 HTML 标记。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">message</span>: |</span><br><span class="line"></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color: red&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    段落</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>转为 JavaScript 如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="attr">message</span>: <span class="string">&#x27;\n&lt;p style=&quot;color: red&quot;&gt;\n  段落\n&lt;/p&gt;\n&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="引用">引用</h1>
<p>锚点<code>&amp;</code>和别名<code>*</code>，可以用来引用。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">defaults</span>: &amp;defaults</span><br><span class="line">  <span class="attr">adapter</span>:  postgres</span><br><span class="line">  <span class="attr">host</span>:     localhost</span><br><span class="line"></span><br><span class="line"><span class="attr">development</span>:</span><br><span class="line">  <span class="attr">database</span>: myapp_development</span><br><span class="line">  &lt;&lt;: *defaults</span><br><span class="line"></span><br><span class="line"><span class="attr">test</span>:</span><br><span class="line">  <span class="attr">database</span>: myapp_test</span><br><span class="line">  &lt;&lt;: *defaults</span><br></pre></td></tr></table></figure>
</blockquote>
<p>等同于下面的代码。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">defaults</span>:</span><br><span class="line">  <span class="attr">adapter</span>:  postgres</span><br><span class="line">  <span class="attr">host</span>:     localhost</span><br><span class="line"></span><br><span class="line"><span class="attr">development</span>:</span><br><span class="line">  <span class="attr">database</span>: myapp_development</span><br><span class="line">  <span class="attr">adapter</span>:  postgres</span><br><span class="line">  <span class="attr">host</span>:     localhost</span><br><span class="line"></span><br><span class="line"><span class="attr">test</span>:</span><br><span class="line">  <span class="attr">database</span>: myapp_test</span><br><span class="line">  <span class="attr">adapter</span>:  postgres</span><br><span class="line">  <span class="attr">host</span>:     localhost</span><br></pre></td></tr></table></figure>
</blockquote>
<p><code>&amp;</code>用来建立锚点（<code>defaults</code>），<code>&lt;&lt;</code>表示合并到当前数据，<code>*</code>用来引用锚点。</p>
<p>下面是另一个例子。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">- &amp;showell <span class="title class_">Steve</span> </span><br><span class="line">- <span class="title class_">Clark</span> </span><br><span class="line">- <span class="title class_">Brian</span> </span><br><span class="line">- <span class="title class_">Oren</span> </span><br><span class="line">- *showell </span><br></pre></td></tr></table></figure>
</blockquote>
<p>转为 JavaScript 代码如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[ <span class="string">&#x27;Steve&#x27;</span>, <span class="string">&#x27;Clark&#x27;</span>, <span class="string">&#x27;Brian&#x27;</span>, <span class="string">&#x27;Oren&#x27;</span>, <span class="string">&#x27;Steve&#x27;</span> ]</span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="函数和正则表达式的转换">函数和正则表达式的转换</h1>
<p>这是 <a href="https://github.com/nodeca/js-yaml">JS-YAML</a>
库特有的功能，可以把函数和正则表达式转为字符串。（不太懂）</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># example.<span class="property">yml</span></span><br><span class="line"><span class="attr">fn</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="keyword">return</span> <span class="number">1</span> &#125;</span><br><span class="line"><span class="attr">reg</span>: <span class="regexp">/test/</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>解析上面的 yml 文件的代码如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> yaml = <span class="built_in">require</span>(<span class="string">&#x27;js-yaml&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fs   = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> doc = yaml.<span class="title function_">load</span>(</span><br><span class="line">    fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./example.yml&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  );</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(doc);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>从 JavaScript 对象还原到 yaml 文件的代码如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> yaml = <span class="built_in">require</span>(<span class="string">&#x27;js-yaml&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fs   = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">fn</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="keyword">return</span> <span class="number">1</span> &#125;,</span><br><span class="line">  <span class="attr">reg</span>: <span class="regexp">/test/</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  fs.<span class="title function_">writeFileSync</span>(</span><br><span class="line">    <span class="string">&#x27;./example.yml&#x27;</span>,</span><br><span class="line">    yaml.<span class="title function_">dump</span>(obj),</span><br><span class="line">    <span class="string">&#x27;utf8&#x27;</span></span><br><span class="line">  );</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="property">log</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="references">References</h1>
<ul>
<li><a href="https://www.ruanyifeng.com/blog/2016/07/yaml.html">YAML
语言教程 - 阮一峰的网络日志 (ruanyifeng.com)</a></li>
</ul>
]]></content>
      <categories>
        <category>CS</category>
      </categories>
      <tags>
        <tag>CS</tag>
      </tags>
  </entry>
  <entry>
    <title>ADC入门</title>
    <url>/2023/08/23/ADC%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Following
哈工深上传到B站的电控组培训来入门robomaster电控组，我购买了普中科技玄武套餐开发板作为硬件。</p>
<p>本篇介绍我学习ADC的见闻</p>
<span id="more"></span>
<h1 id="adc">ADC</h1>
<h2 id="简介">简介</h2>
<p>Analog-to-Digital
Converter模数转换器，是一种逐次逼近型模拟数字转换器。它有多达18个通道，可测量16个外部和2个内部信号源。各通道的A/D转换可以单次、连续、扫描或间断模式执行。
ADC的结果可以左对齐或右对齐方式存储在16位数据寄存器中。</p>
<blockquote>
<p>Tips:ADC是12位精度，所以有4位空着，于是就有左对齐或右对齐</p>
</blockquote>
<p><strong>模拟看门狗watch
dog</strong>特性允许应用程序检测输入电压是否超出用户定义的高/低阀值,定期进行喂狗操作(复原)，避免程序失控。</p>
<blockquote>
<p>Notes:看门狗向下计数，设置ARR，判断程序是否出错。</p>
</blockquote>
<p>ADC的输入时钟不得超过14MHz，它是由PCLK2经分频产生。</p>
<blockquote>
<p>Tips:72MHz/6=12。</p>
</blockquote>
<p>ADC的特性：</p>
<ul>
<li><p>12位分辨率</p></li>
<li><p>转换结束、注入转换结束和发生模拟看门狗事件时产生中断</p></li>
<li><p>单次和连续转换模式</p></li>
<li><p>从通道0到通道n的自动扫描模式</p></li>
<li><p>自校准</p></li>
<li><p>带内嵌数据一致性的数据对齐</p></li>
<li><p>采样间隔可以按通道分别编程</p></li>
<li><p>规则转换和注入转换均有外部触发选项</p></li>
<li><p>间断模式</p></li>
<li><p>双重模式(带2个或以上ADC的器件)</p></li>
<li><p>ADC转换时间：</p></li>
</ul>
<p>─ STM32F103xx增强型产品：时钟为56MHz时为1μs(时钟为72MHz为1.17μs)</p>
<p>─ STM32F101xx基本型产品：时钟为28MHz时为1μs(时钟为36MHz为1.55μs)</p>
<p>─ STM32F102xxUSB型产品：时钟为48MHz时为1.2μs</p>
<p>─
STM32F105xx和STM32F107xx产品：时钟为56MHz时为1μs(时钟为72MHz为1.17μs)</p>
<ul>
<li>ADC供电要求： 2.4V到3.6V</li>
<li>ADC输入范围： VREF- ≤ VIN ≤ VREF+</li>
<li>规则通道转换期间有DMA请求产生。</li>
</ul>
<h2 id="adc功能描述">ADC功能描述</h2>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823125852514.png"
alt="image-20230823125852514" />
<figcaption aria-hidden="true">image-20230823125852514</figcaption>
</figure>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 22%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="header">
<th>名称</th>
<th>信号类型</th>
<th>注解</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>VREF+</td>
<td>输入，模拟参考正极</td>
<td>ADC使用的高端/正极参考电压， 2.4V ≤ VREF+ ≤ VDDA</td>
</tr>
<tr class="even">
<td>VDDA</td>
<td>输入，模拟电源</td>
<td>等效于VDD的模拟电源且： 2.4V ≤ VDDA ≤ VDD(3.6V)</td>
</tr>
<tr class="odd">
<td>VREF-</td>
<td>输入，模拟参考负极</td>
<td>ADC使用的低端/负极参考电压， VREF- = VSSA</td>
</tr>
<tr class="even">
<td>VSSA</td>
<td>输入，模拟电源地</td>
<td>等效于VSS的模拟电源地</td>
</tr>
<tr class="odd">
<td>ADCx_IN[15:0]</td>
<td>模拟输入信号</td>
<td>16个模拟输入通道</td>
</tr>
</tbody>
</table>
<h3 id="通道选择">通道选择</h3>
<p>ADC有16个多路通道。可以把转换组织成两组：<strong>规则组和注入组</strong>。在任意多个通道上以任意顺序进行的一系列转换构成成组转换。</p>
<ul>
<li>规则组由多达16个转换组成。</li>
<li>注入组由多达4个转换组成。</li>
<li>温度传感器和通道ADC1_IN16相连接，内部参照电压VREFINT和ADC1_IN17相连接。可以按注入或规则通道对这两个内部通道进行转换。</li>
</ul>
<blockquote>
<p>Tips:温度传感器和VREFINT只出现在主ADC1中</p>
</blockquote>
<h3 id="单次转换模式">单次转换模式</h3>
<p>单次转换模式下， ADC只执行一次转换。一旦选择通道的转换完成：</p>
<ul>
<li>如果一个规则通道被转换，转换数据被储存在16位ADC_DR寄存器中</li>
<li>如果一个注入通道被转换，转换数据被储存在16位的ADC_DRJ1寄存器中</li>
</ul>
<p>转换完成后，会产生相应的中断（如果使能Enable），然后ADC停止。开启<strong>扫描模式</strong>会将排序好的通道全部转换一遍</p>
<h3 id="连续转换模式">连续转换模式</h3>
<p>在连续转换模式中，当前面ADC转换一结束马上就启动另一次转换。此模式可通过外部触发启动。每个转换完成后数据存储位置与单次转换模式相同。</p>
<h3 id="模拟看门狗">模拟看门狗</h3>
<p>用户可设置电压的低阈值和高阈值，如果被ADC转换的模拟电压低于低阈值或高于高阈值，则模拟看门狗状态位被设置，产生中断。</p>
<blockquote>
<p>Tips;模拟看门狗可以作用于1个或多个通道。</p>
</blockquote>
<h3 id="扫描模式">扫描模式</h3>
<p>此模式用来扫描一组模拟通道。设置之后，ADC将自动扫描所有被选中的通道。在每个组的每个通道上执行单次转换。在每个转换结束时，同一组的下一个通道被自动转换。</p>
<p>如果设置了DMA位，在每次转换完成后，DMA控制器把规则组通道的转换数据传输到SRAM中。</p>
<h3 id="间断模式">间断模式</h3>
<p>它可以用来执行一个短序列的n次转换(n&lt;=8)。一个外部触发信号可以启动下一轮的n次转换，直到此序列所有的转换完成为止。</p>
<p>这里拿规则通道举例：</p>
<ul>
<li>n=3，被转换的通道 = 0、 1、 2、 3、 6、 7、 9、 10</li>
<li>第一次触发：转换的序列为 0、 1、 2</li>
<li>第二次触发：转换的序列为 3、 6、 7</li>
<li>第三次触发：转换的序列为 9、 10，并产生EOC事件</li>
<li>第四次触发：转换的序列0、 1、 2</li>
</ul>
<blockquote>
<p>Tips:当以间断模式转换一个规则组时，转换序列结束后<strong>不自动</strong>从头开始。当所有子组被转换完成，下一次触发启动第一个子组的转换。在上面的例子中，第四次触发重新转换第一子组的通道
0、 1和2</p>
</blockquote>
<h3 id="注入通道管理">注入通道管理</h3>
<p>规则组有16个，注入组有4个，注入组的优先级比规则组高，在执行规则组的时候注入组有权利打断并且执行自己的函数。</p>
<blockquote>
<p>Tips:可以将注入组的要求视为一个中断</p>
</blockquote>
<h3 id="校准">校准</h3>
<p>ADC有一个内置自校准模式。校准可大幅减小因内部电容器组的变化而造成的准精度误差。在校准期间，在每个电容器上都会计算出一个误差修正码(数字值)，这个码用于消除在随后的转换中每个电容器上产生的误差。</p>
<blockquote>
<p>建议在每次上电后执行一次校准</p>
</blockquote>
<blockquote>
<p>Tips:启动校准前，ADC必须处于关电状态超过至少两个ADC时钟周期</p>
<p>不能一上电就校准，延时1ms即可。</p>
</blockquote>
<h3 id="dma请求">DMA请求</h3>
<p>因为规则通道转换的值储存在一个仅有的数据寄存器中，所以当转换多个规则通道时需要使用DMA，这可以避免丢失已经存储在ADC_DR寄存器中的数据。</p>
<p>只有在规则通道的转换结束时才产生DMA请求，并将转换的数据从ADC_DR寄存器传输到用户指定的目的地址。</p>
<blockquote>
<p>Tips:只有ADC1和ADC3拥有DMA功能。由ADC2转化的数据可以通过双ADC模式，利用ADC1的DMA功能传输</p>
</blockquote>
<h3 id="数据对齐">数据对齐</h3>
<p>数据可以左对齐或右对齐。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823131033599.png"
alt="image-20230823131033599" />
<figcaption aria-hidden="true">image-20230823131033599</figcaption>
</figure>
<blockquote>
<p>Tips:有符号位（不用管）</p>
</blockquote>
<h2 id="adc的通道采样">ADC的通道采样</h2>
<p>ADC使用若干个ADC_CLK周期对输入电压采样，每个通道可以分别用不同的时间采样。总转换时间如下计算：
<span class="math display">\[
T_{CONV} = 采样时间+12.5周期
\]</span></p>
<blockquote>
<p>Tips:采样时间最小1.5个周期，最大200多可在CubeMX中设置</p>
</blockquote>
<h3 id="adc中断">ADC中断</h3>
<p>规则和注入组转换结束时能产生中断，当模拟看门狗状态位被设置时也能产生中断。它们都有独立的中断使能位</p>
<blockquote>
<p>Tips:ADC1和ADC2的中断映射在同一个中断向量上，而ADC3的中断有自己的中断向量。</p>
</blockquote>
<h2 id="api">API</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HAL_StatusTypeDef HAL_ADC_Start_DMA(ADC_HandleTypeDef* hadc, uint32_t* pData,uint32_t Length)</span><br><span class="line">//一般都会多通道连续采样，用DMA</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__weak void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef* hadc)</span><br><span class="line">&#123;</span><br><span class="line">    /* Prevent unused argument(s) compilation warning */</span><br><span class="line">    UNUSED(hadc);</span><br><span class="line">    /* NOTE : This function should not be modified. When the callback is needed,</span><br><span class="line">    function HAL_ADC_ConvCpltCallback must be implemented in the user</span><br><span class="line">    file.</span><br><span class="line">    */</span><br><span class="line">&#125;</span><br><span class="line">//输入捕获，可重定义</span><br></pre></td></tr></table></figure>
<h1 id="实验">实验</h1>
<h2 id="cubemx">CubeMX</h2>
<p>Mode:circular选择循环模式</p>
<h2 id="code">Code</h2>
<p>跟串口类型差不多，都要先定义一个存储数据的变量</p>
<blockquote>
<p>Tips:HAL_ADC_Start_DMA()传入的是32位的数据，寄存器数据是16位，所以一个32位数据分两半，每个通道占一半</p>
</blockquote>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230823100750466.png"
alt="image-20230823100750466" />
<figcaption aria-hidden="true">image-20230823100750466</figcaption>
</figure>
<h1 id="references">References</h1>
<ul>
<li>B站哈工深视频</li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>robomaster</tag>
        <tag>嵌入式</tag>
      </tags>
  </entry>
  <entry>
    <title>blog搭建及优化</title>
    <url>/2023/07/27/blog%E6%90%AD%E5%BB%BA%E5%8F%8A%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>仅以此blog记录生活点滴</p>
<p>遇到困难第一时间找官方手册解决问题!</p>
<p>优化进行ing</p>
<span id="more"></span>
<h1 id="优化">优化</h1>
<ul>
<li><p>以PicGo作为图床上传工具，在github上创建figure
bed并连接typora（一键式typora插入图片自动上传并转化为url）</p></li>
<li><p>增加search function</p></li>
<li><p>设置预览摘要</p></li>
<li><p>主页文章添加阴影效果</p></li>
<li><p>给一篇文章设置多标签</p></li>
<li><p>让blog支持LaTex数学公式</p>
<p>hexo并不支持LaTex数学公式<a
href="https://theme-next.js.org/docs/third-party-services/math-equations.html">Math
Equations | NexT (theme-next.js.org)</a></p>
<p>卸载hexo-math，Render
Engines替换渲染:下载pandoc，hexo-renderer-pandoc，修改config，使用hexo-filter-mathjax</p>
<p><a
href="https://github.com/next-theme/hexo-filter-mathjax">next-theme/hexo-filter-mathjax:
💯 Server side MathJax renderer plugin for Hexo.
(github.com)</a></p></li>
<li><p>hexo-optimize优化页面加载速度</p></li>
<li><p>修改背景</p></li>
</ul>
<h1 id="bonus">Bonus</h1>
<p>记录搭建blog过程中遇到的一些东西</p>
<ul>
<li><p>github.io是静态网页每次修改都需要重新部署</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#在/blog/source/_posts 中添加文件，然后再bash中重新部署</span><br><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br><span class="line">###本地查看</span><br><span class="line">hexo s</span><br><span class="line">###新建文章</span><br><span class="line">hexo n &#x27;filename&#x27;</span><br></pre></td></tr></table></figure></li>
<li><p>设置文章的tags and categories</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title:</span><br><span class="line">date:</span><br><span class="line">tags: [ &#x27;标签1&#x27; , &#x27;标签2&#x27; , &#x27;标签3&#x27; ]  #注意空格</span><br><span class="line">categories: life</span><br><span class="line">---</span><br><span class="line">### 以下是正文</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">总结下有两种格式都适用：</span><br><span class="line"></span><br><span class="line">第一种：</span><br><span class="line"></span><br><span class="line">tags: [ &#x27;Ruby&#x27;, &#x27;Perl&#x27;, &#x27;Python&#x27; ]</span><br><span class="line"></span><br><span class="line">第二种：</span><br><span class="line"></span><br><span class="line">tags:</span><br><span class="line"></span><br><span class="line">- hexo</span><br><span class="line"></span><br><span class="line">- disqus</span><br></pre></td></tr></table></figure></li>
<li><p>数学公式的使用需要添加：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mathjax: true</span><br></pre></td></tr></table></figure></li>
<li><pre><code>  background-size:contain/cover         //看你需求</code></pre></li>
<li><p>CDN(Content Delivery
Network，内容分发网络)是一项非常有效的<strong>缩短时延</strong>的技术，采用更多的缓存服务器（CDN边缘节点），布放在用户访问相对集中的地区或网络中。当用户访问网站时，利用全局负载技术，将用户的访问指向距离最近的缓存服务器上，由缓存服务器响应用户请求</p></li>
<li><p>YAML(.yml文件)，一种数据序列化格式，方便传输和存储</p></li>
<li><p>只要我们在文章中插入
<!-- more -->，该标签之上的是摘要，之后的内容不可见，需点击全文阅读按钮。</p></li>
</ul>
<h1 id="references">References</h1>
<ul>
<li><p><a href="https://theme-next.js.org/">NexT - Theme for Hexo
(theme-next.js.org)</a>Next主题官方文档</p></li>
<li><p><a
href="https://github.com/next-theme/hexo-filter-mathjax">next-theme/hexo-filter-mathjax:
💯 Server side MathJax renderer plugin for Hexo.
(github.com)</a></p></li>
<li><p><a
href="https://github.com/next-theme/hexo-optimize">next-theme/hexo-optimize:
🚩 A Hexo plugin that optimize the pages loading speed.
(github.com)</a></p></li>
<li><p>跟随知乎枫叶大佬<a
href="https://zhuanlan.zhihu.com/p/102592286">从零开始搭建个人博客（超详细）
- 知乎 (zhihu.com)</a>搭建此blog</p></li>
<li><p><a
href="https://github.com/jackfrued/Python-100-Days/blob/master/番外篇/使用Hexo搭建自己的博客.md">Python-100-Days/番外篇/使用Hexo搭建自己的博客.md
at master · jackfrued/Python-100-Days (github.com)</a></p></li>
<li><p>Next主题设置：<a
href="https://github.com/theme-next/hexo-theme-next/blob/master/README.md">hexo-theme-next/README.md
at master · theme-next/hexo-theme-next (github.com)</a></p></li>
<li><p><a href="https://zhuanlan.zhihu.com/p/52362950">到底什么是CDN？ -
知乎 (zhihu.com)</a></p></li>
<li><p><a
href="https://zhuanlan.zhihu.com/p/433176170">两分钟带你了解YAML（.yml后缀文件）
- 知乎 (zhihu.com)</a></p></li>
<li><p><a
href="https://news.netshop168.com/article-85934.html">rss订阅是什么意思?为什么要使用RSS?RSS也称为RSS订阅或RSS提要
(netshop168.com)</a></p></li>
<li><p><a href="https://zhuanlan.zhihu.com/p/347342082">如何利用 Github
搭建自己的免费图床？ - 知乎 (zhihu.com)</a></p></li>
<li><p><a
href="https://zhuanlan.zhihu.com/p/489236769">使用Github+picGo搭建图床，保姆级教程来了
- 知乎 (zhihu.com)</a></p></li>
<li><p><a href="https://www.ruanyifeng.com/blog/2016/07/yaml.html">YAML
语言教程 - 阮一峰的网络日志 (ruanyifeng.com)</a></p></li>
<li><p><a
href="https://www.cnblogs.com/cscshi/p/15196114.html#:~:text=1%201.%20设置背景图片%20将想要的背景图片放入%20themes%2Fnext%2Fsource%2Fimages。%20打开%20themes%2Fnext%2Fsource%2Fcss%2F%20_custom%2Fcustom.styl,blog_root%2Fsource%2F_data%2Fstyles.style%20中添加以下内容：%20...%203%203.%20参考%20Hexo-NexT%20设置博客背景图片">Hexo-NexT
设置博客背景图片 - 锦瑟，无端 - 博客园 (cnblogs.com)</a></p></li>
</ul>
]]></content>
      <categories>
        <category>奇技淫巧</category>
      </categories>
      <tags>
        <tag>奇技淫巧</tag>
      </tags>
  </entry>
  <entry>
    <title>Git进阶（2）</title>
    <url>/2023/08/10/Git%E8%BF%9B%E9%98%B6%EF%BC%882%EF%BC%89/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>Git进阶（2）——了解Git Branching—”killer feature“</p>
<p>希望通过<a href="https://git-scm.com/book/zh/v2">Git - Book
(git-scm.com)</a>+<a
href="https://learngitbranching.js.org/?locale=zh_CN">Learn Git
Branching</a>来进一步掌握Git</p>
<p><strong>Learn to love the command line. Leave the IDE
behind.</strong></p>
<span id="more"></span>
<h1 id="git-branching">Git Branching</h1>
<h2 id="branches-in-a-nutshell">Branches in a Nutshell</h2>
<p>Git保存一系列不同时刻的snapshots,When you make a commit, Git stores a
commit object that contains a pointer to the snapshot of the content you
staged. 暂存操作会为每一个文件计算校验和。当使用 <code>git commit</code>
进行提交操作时，Git
会先计算每一个子目录（本例中只有项目根目录）的校验和， 然后在 Git
仓库中这些校验和保存为树对象。随后，Git 便会创建一个提交对象，
它除了包含上面提到的那些信息外，还包含指向这个树对象（项目根目录）的指针。
如此一来，Git 就可以在需要的时候重现此次保存的快照。</p>
<p>现在，Git 仓库中有五个对象：三个 <em>blob</em>
对象（保存着文件快照）、一个 <strong>树</strong> 对象 （记录着目录结构和
blob 对象索引）以及一个 <strong>提交</strong>
对象（包含着指向前述树对象的指针和所有提交信息）。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/commit-and-tree.png"
alt="commit-and-tree" />
<figcaption aria-hidden="true">commit-and-tree</figcaption>
</figure>
<p>Git 的分支，其实本质上仅仅是指向提交对象的可变指针</p>
<p>Git有一个名为 <code>HEAD</code>
的特殊指针，指向当前所在的本地分支（HEAD即当前你所在的位置）</p>
<blockquote>
<p>Tips:Git 的分支实质上仅是包含所指对象校验和（长度为 40 的 SHA-1
值字符串）的文件，所以它的创建和销毁都异常高效。</p>
</blockquote>
<h2 id="分支创建">分支创建</h2>
<p>使用 <code>git branch</code> 命令：只是为我创建了一个新的指针</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch testing</span></span><br></pre></td></tr></table></figure>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/head-to-master.png"
alt="head-to-master" />
<figcaption aria-hidden="true">head-to-master</figcaption>
</figure>
<p><strong>创建新分支的同时切换过去</strong></p>
<p>通常我们会在创建一个新分支后立即切换过去，这可以用
<code>git checkout -b &lt;newbranchname&gt;</code> 一条命令搞定</p>
<h2 id="分支删除">分支删除</h2>
<p>使用带 <code>-d</code> 选项的 <code>git branch</code>
命令来删除分支：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch -d &lt;branch-name&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="分支检查">分支检查</h2>
<p><code>git log</code> 命令查看各个分支当前所指的对象。
提供这一功能的参数是 <code>--decorate</code>。（仅检查当前分支）</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --oneline --decorate</span></span><br></pre></td></tr></table></figure>
<p>查看<strong>分叉历史</strong>。 运行
<code>git log --oneline --decorate --graph --all</code>
会输出你的提交历史、各个分支的指向以及项目的分支分叉情况。</p>
<h2 id="分支切换">分支切换</h2>
<p>在 Git 2.23 版本中，引入了一个名为 <code>git switch</code>
的新命令，最终会取代 <code>git checkout</code>，因为
<code>checkout</code> 作为单个命令有点超载（它承载了很多独立的功能）</p>
<p>使用 <code>git checkout</code> 命令</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout testing</span></span><br></pre></td></tr></table></figure>
<p>HEAD会随当前指针移动</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout master</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>HEAD 指回 <code>master</code> 分支</p></li>
<li><p>将工作目录恢复成 <code>master</code>
分支所指向的快照内容</p></li>
</ul>
<blockquote>
<p>Tips:切换前保持干净（留意未提交的修改）</p>
</blockquote>
<h2 id="分支合并">分支合并</h2>
<p><code>git merge</code> 命令来达到上述目的：先切换到主分支，然后
<code>git merge &lt;想要合并的branch&gt;</code></p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout master</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git merge hotfix</span></span><br></pre></td></tr></table></figure>
<h3 id="一脉相承的分支合并">一脉相承的分支合并</h3>
<p>当你试图合并两个分支时，
如果顺着一个分支走下去能够到达另一个分支，那么 Git 在合并两者的时候，
只会简单的将指针向前推进（指针右移），因为这种情况下的合并操作没有需要解决的分歧——这就叫做
“快进（fast-forward）</p>
<h3 id="diverged-branches">diverged branches:</h3>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/basic-merging-2.png"
alt="basic-merging-2" />
<figcaption aria-hidden="true">basic-merging-2</figcaption>
</figure>
<p>Git 会使用两个分支的末端所指的快照（<code>C4</code> 和
<code>C5</code>）以及这两个分支的公共祖先（<code>C2</code>），做一个简单的三方合并。</p>
<blockquote>
<p>Tips:多余的分支记得删除 <code>git branch -d ...</code></p>
</blockquote>
<h3 id="遇到冲突时的分支合并">遇到冲突时的分支合并</h3>
<p>如果你在两个不同的分支中，对同一个文件的同一个部分进行了不同的修改，Git
就没法干净的合并它们。</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git merge iss53</span></span><br></pre></td></tr></table></figure>
<p>此时 Git 做了合并，但是没有自动地创建一个新的合并提交。 Git
会暂停下来，等待你去解决合并产生的冲突。
你可以在合并冲突后的任意时刻使用 <code>git status</code>
命令来查看那些因包含合并冲突而处于未合并（unmerged）状态的文件：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git status</span></span><br></pre></td></tr></table></figure>
<p><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> , <code>=======</code> , 和
<code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code> 这些行被完全删除了。
在你解决了所有文件里的冲突之后，对每个文件使用 <code>git add</code>
命令来将其标记为冲突已解决。 一旦暂存这些原本有冲突的文件，Git
就会将它们标记为冲突已解决。</p>
<h2 id="rebasing">Rebasing</h2>
<p>在 Git 中整合来自不同分支的修改主要有两种方法：<code>merge</code>
(最容易)以及 <code>rebase</code>。</p>
<p><strong>变基（rebase）</strong>：使用 <code>rebase</code>
命令将提交到某一分支上的所有修改都移至另一分支上（先转到要rebase的分支上去，master是目标基底分支）</p>
<p>变基是将一系列提交按照原有次序依次应用到另一分支上<code>git rebase &lt;basebranch&gt; &lt;topicbranch&gt;</code></p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout experiment</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git rebase master</span>   </span><br></pre></td></tr></table></figure>
<p>首先找到这两个分支（即当前分支
<code>experiment</code>、变基操作的目标基底分支 <code>master</code>）
的最近共同祖先
<code>C2</code>然后对比当前分支相对于该祖先的历次提交，提取相应的修改并存为临时文件，
然后将当前分支指向目标基底 <code>C3</code>,
最后以此将之前另存为临时文件的修改依序应用。</p>
<p>现在回到 <code>master</code> 分支，进行一次快进合并。</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout master</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git merge experiment</span></span><br></pre></td></tr></table></figure>
<h3 id="rebasing-进阶">Rebasing 进阶</h3>
<p>使用 <code>git rebase</code> 命令的 <code>--onto</code> 选项， 选中在
<code>client</code> 分支里但不在 <code>server</code> 分支里的修改（即
<code>C8</code> 和 <code>C9</code>），将它们在 <code>master</code>
分支上重放：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git rebase --onto master server client</span></span><br></pre></td></tr></table></figure>
<p>理解：取出 <code>client</code> 分支，找出它从 <code>server</code>
分支分歧之后的补丁， 然后把这些补丁在 <code>master</code>
分支上重放一遍，让 <code>client</code> 看起来像直接基于
<code>master</code> 修改一样<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/interesting-rebase-2.png"
alt="interesting-rebase-2" /></p>
<h3 id="变基的风险">变基的风险</h3>
<p>总的原则是，只对尚未推送或分享给别人的本地修改执行变基操作清理历史，
从不对已推送至别处的提交执行变基操作</p>
<h2 id="分支管理">分支管理</h2>
<p>git branch命令的使用</p>
<ul>
<li>查看所有分支</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ git branch</span><br><span class="line">* master</span><br></pre></td></tr></table></figure>
<p>不加任何参数运行它，会得到当前所有分支的一个列表,<code>master</code>
分支前的 <code>*</code> 字符：它代表现在检出的那一个分支（也就是说，当前
<code>HEAD</code> 指针所指向的分支）</p>
<ul>
<li>查看每一个分支的最后一次提交</li>
</ul>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch -v</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>--merged与 --no-merged
这两个有用的选项可以过滤这个列表中已经合并或尚未合并到当前分支的分支。
如果要查看哪些分支已经合并到当前分支，可以运行
<code>git branch --merged</code></p>
<blockquote>
<p>Tips:你总是可以提供一个附加的参数来查看其它分支的合并状态而不必检出它们。
例如，尚未合并到 <code>master</code> 分支的有哪些？</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout testing</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch --no-merged master</span></span><br><span class="line">  topicA</span><br><span class="line">  featureB</span><br></pre></td></tr></table></figure>
</blockquote></li>
</ul>
<h2 id="在tree上移动">在tree上移动</h2>
<p>分离<code>HEAD</code>:git checkout C1(一个snapshot的checksum)</p>
<p>Git识别checksum比较智能，只需能唯一标识的前几个字符即可</p>
<h3 id="相对引用">相对引用</h3>
<p>通过哈希值指定提交记录很不方便，所以 Git
引入了相对引用，这里我介绍两个简单的用法：</p>
<ul>
<li>使用 <code>^</code> 向上移动 1 个提交记录（寻找parent
node，可以连续使用eg:<code>main^^</code>）,其后也可以跟数字，指明回到哪一个parent
node</li>
<li>使用 <code>~&lt;num&gt;</code> 向上移动多个提交记录，如
<code>~3</code>（可选，不加数字时与 <code>^</code>
相同，向上移动一次）</li>
</ul>
<blockquote>
<p>Tips:modifiers可以复合使用：<code>git checkout HEAD\~2^2~3</code></p>
</blockquote>
<h3 id="强制修改分支位置">强制修改分支位置</h3>
<p>使用相对引用最多的就是移动分支。可以直接使用 <code>-f</code>
选项让分支指向另一个提交。例如:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git branch -f main HEAD~3</span><br></pre></td></tr></table></figure>
<p>上面的命令会将 main 分支强制指向 HEAD 的第 3 级 parent 提交。</p>
<h2 id="整理提交记录">整理提交记录</h2>
<h3 id="cherry-pick">cherry-pick</h3>
<p>“整理提交记录” —— 开发人员有时会说“我想要把这个提交放到这里,
那个提交放到刚才那个提交的后面”</p>
<ul>
<li><code>git cherry-pick &lt;提交号&gt;...</code></li>
</ul>
<p>如果你想将一些提交复制到当前所在的位置（<code>HEAD</code>）下面的话，
Cherry-pick 是最直接的方式了。（如果知道提交记录则very simple）</p>
<h3 id="交互式的rebase">交互式的rebase</h3>
<p>if 不清楚你想要的提交记录的哈希值</p>
<blockquote>
<p>Tips:COOL!!!</p>
</blockquote>
<p>交互式 rebase 指的是使用带参数 <code>--interactive</code> 的 rebase
命令, 简写为 <code>-i</code>，Git 会打开一个 UI
界面（vim）并列出将要被复制到目标分支的备选提交记录，它还会显示每个提交记录的哈希值和提交说明，提交说明有助于你理解这个提交进行了哪些更改。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git rebase -i HEAD~4</span><br></pre></td></tr></table></figure>
<p>当 rebase UI界面打开时, 你能做3件事:</p>
<ul>
<li>调整提交记录的顺序（通过鼠标拖放来完成）</li>
<li>删除你不想要的提交（通过切换 <code>pick</code>
的状态来完成，关闭就意味着你不想要这个提交记录）</li>
<li>合并提交。</li>
</ul>
<h3 id="如何整理">如何整理</h3>
<p>来看一个在开发中经常会遇到的情况：我正在解决某个特别棘手的
Bug，为了便于调试而在代码中添加了一些调试命令并向控制台打印了一些信息。解决后并不想在commit中包含这些信息，实际我们只要让
Git 复制解决问题的那一个提交记录就可以了。我们可以使用</p>
<ul>
<li><code>git rebase -i</code></li>
<li><code>git cherry-pick</code></li>
</ul>
<p>来达到目的。</p>
<ul>
<li><p>我们可以使用 <code>rebase -i</code>
对提交记录进行重新排序。只要把我们想要的提交记录挪到最前端，我们就可以很轻松的用
<code>--amend</code> 修改它，然后把它们重新排成我们想要的顺序</p></li>
<li><p>or只是把C2单独提出来，修改后，再用cherry-pick添加进去</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230815110958607.png"
alt="image-20230815110958607" />
<figcaption aria-hidden="true">image-20230815110958607</figcaption>
</figure></li>
</ul>
<h2 id="分支开发工作流">分支开发工作流</h2>
<h3 id="长期分支">长期分支</h3>
<p>非必要，但常很有帮助</p>
<p>许多使用 Git 的开发者都喜欢使用这种方式来工作，比如只在
<code>master</code>
分支上保留完全稳定的代码——有可能仅仅是已经发布或即将发布的代码。
他们还有一些名为 <code>develop</code> 或者 <code>next</code>
的平行分支，被用来做后续开发或者测试稳定性——这些分支不必保持绝对稳定，但是一旦达到稳定状态，它们就可以被合并入
<code>master</code> 分支了。</p>
<p>趋于稳定分支的流水线（“silo”）视图：</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/lr-branches-2.png"
alt="lr-branches-2" />
<figcaption aria-hidden="true">lr-branches-2</figcaption>
</figure>
<h3 id="主题分支">主题分支</h3>
<p>主题分支对任何规模的项目都适用。
主题分支是一种短期分支，它被用来实现单一特性或其相关工作。 在 Git
中一天之内多次创建、使用、合并、删除分支都很常见。</p>
<h2 id="远程分支">远程分支</h2>
<p>远程引用是对远程仓库的引用（指针），包括分支、标签等等。 你可以通过
<code>git ls-remote &lt;remote&gt;</code>
来显式地获得远程引用的完整列表， 或者通过
<code>git remote show &lt;remote&gt;</code> 获得远程分支的更多信息。</p>
<h3 id="远程跟踪分支">远程跟踪分支</h3>
<p>远程跟踪分支是远程分支状态的引用。它们是你无法移动的本地引用。一旦你进行了网络通信，
Git
就会为你移动它们以精确反映远程仓库的状态。提醒你该分支在远程仓库中的位置就是你最后一次连接到它们的位置。</p>
<p>命名形式：<remote>/<branch></p>
<p>Git 的 <code>clone</code> 命令会为你自动将其命名为
<code>origin</code>，拉取它的所有数据， 创建一个指向它的
<code>master</code> 分支的指针，并且在本地将其命名为
<code>origin/master</code>。 Git 也会给你一个与 origin 的
<code>master</code> 分支在指向同一个地方的本地 <code>master</code>
分支，这样你就有工作的基础。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/remote-branches-1.png"
alt="remote-branches-1" />
<figcaption aria-hidden="true">remote-branches-1</figcaption>
</figure>
<blockquote>
<p>Tips:运行
<code>git clone -o booyah</code>，那么你默认的远程分支名字将会是
<code>booyah/master</code>。-o远程库的命名。</p>
<p><code>git remote add name remote(url)</code></p>
</blockquote>
<h3 id="同步远程仓库">同步远程仓库</h3>
<p>程仓库同步数据，运行 <code>git fetch &lt;remote&gt;</code></p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/remote-branches-3.png"
alt="remote-branches-3" />
<figcaption aria-hidden="true">remote-branches-3</figcaption>
</figure>
<blockquote>
<p>Tips:本地与远程的工作可以分叉</p>
</blockquote>
<p>多个远程仓库可以：<code>git remote add name remote(url)</code></p>
<h3 id="推送">推送</h3>
<p><code>git push &lt;remote&gt; &lt;branch&gt;</code> Git 自动将
<code>serverfix</code> 分支名字展开为
<code>refs/heads/serverfix:refs/heads/serverfix</code>，
那意味着，“推送本地的 <code>serverfix</code> 分支来更新远程仓库上的
<code>serverfix</code> 分支。”</p>
<p>运行 <code>git push origin serverfix:awesomebranch</code> 来将本地的
<code>serverfix</code> 分支推送到远程仓库上的 <code>awesomebranch</code>
分支</p>
<blockquote>
<p>Tips:<避免每次输入密码>使用 HTTPS URL 来推送，Git
服务器会询问用户名与密码。</p>
<p>如果不想在每一次推送时都输入用户名与密码，你可以设置一个 “credential
cache”。 最简单的方式就是将其保存在内存中几分钟，可以简单地运行
<code>git config --global credential.helper cache</code> 来设置它。</p>
</blockquote>
<p>当重新抓取到新的远程跟踪分支时，不会有一个新的 <code>serverfix</code>
分支——只有一个不可以修改的 <code>origin/serverfix</code> 指针。</p>
<p>可以运行 <code>git merge origin/serverfix</code>
将这些工作合并到当前所在的分支。 如果想要在自己的 <code>serverfix</code>
分支上工作，可以将其建立在远程跟踪分支之上：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout -b serverfix origin/serverfix</span></span><br><span class="line">Branch serverfix set up to track remote branch serverfix from origin.</span><br><span class="line">Switched to a new branch &#x27;serverfix&#x27;</span><br></pre></td></tr></table></figure>
<p>这会给你一个用于工作的本地分支，并且起点位于
<code>origin/serverfix</code>。</p>
<h3 id="跟踪分支">跟踪分支</h3>
<p>从一个远程跟踪分支检出一个本地分支会自动创建所谓的“跟踪分支”（它跟踪的分支叫做“上游分支”）。
跟踪分支是与远程分支有直接关系的本地分支。 如果在一个跟踪分支上输入
<code>git pull</code>，Git
能自动地识别去哪个服务器上抓取、合并到哪个分支。</p>
<p><code>git checkout -b &lt;branch&gt; &lt;remote&gt;/&lt;branch&gt;</code>。可以自己命名</p>
<p>这是一个十分常用的操作所以 Git 提供了 <code>--track</code>
快捷方式：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout --track origin/serverfix</span></span><br></pre></td></tr></table></figure>
<p>该捷径本身还有一个捷径。 如果你尝试检出的分支 (a) 不存在且 (b)
刚好只有一个名字与之匹配的远程分支，那么 Git
就会为你创建一个跟踪分支：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout serverfix</span></span><br></pre></td></tr></table></figure>
<p><strong>设置已有的本地分支</strong>跟踪一个刚刚拉取下来的远程分支，或者想要修改正在跟踪的上游分支，
你可以在任意时间使用 <code>-u</code> 或 <code>--set-upstream-to</code>
选项运行 <code>git branch</code> 来显式地设置。</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch -u origin/serverfix</span></span><br><span class="line">Branch serverfix set up to track remote branch serverfix from origin.</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:<上游快捷方式>当设置好跟踪分支后，可以通过简写
<code>@&#123;upstream&#125;</code> 或 <code>@&#123;u&#125;</code> 来引用它的上游分支。
所以在 <code>master</code> 分支时并且它正在跟踪
<code>origin/master</code> 时，如果愿意的话可以使用
<code>git merge @&#123;u&#125;</code> 来取代
<code>git merge origin/master</code>。</p>
</blockquote>
<p>查看设置的所有跟踪分支，可以使用 <code>git branch</code> 的
<code>-vv</code> 选项。 这会将所有的本地分支列出来并且包含更多的信息</p>
<h3 id="拉取">拉取</h3>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git fetch --all; git branch -vv</span></span><br></pre></td></tr></table></figure>
<p><code>git fetch</code>
命令从服务器上抓取本地没有的数据时，它并不会修改工作目录中的内容。
它只会获取数据然后让你自己合并。</p>
<blockquote>
<p>Tips:<code>git pull</code> 在大多数情况下它的含义是一个
<code>git fetch</code> 紧接着一个 <code>git merge</code> 命令。</p>
<p>由于 <code>git pull</code> 的魔法经常令人困惑所以通常单独显式地使用
<code>fetch</code> 与 <code>merge</code> 命令会更好一些。</p>
</blockquote>
<h3 id="删除远程分支">删除远程分支</h3>
<p>可以运行带有 <code>--delete</code> 选项的 <code>git push</code>
命令来删除一个远程分支。 如果想要从服务器上删除 <code>serverfix</code>
分支，运行下面的命令：</p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git push origin --delete serverfix</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:基本上这个命令做的只是从服务器上移除这个指针。 Git
服务器通常会保留数据一段时间直到垃圾回收运行，所以如果不小心删除掉了，通常是很容易恢复的。</p>
</blockquote>
<h1 id="references">References</h1>
<ul>
<li><a href="https://git-scm.com/book/zh/v2">Git - Book
(git-scm.com)</a></li>
<li><a href="https://learngitbranching.js.org/?locale=zh_CN">Learn Git
Branching</a></li>
</ul>
]]></content>
      <categories>
        <category>CS</category>
      </categories>
      <tags>
        <tag>CS</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>各种通信方式</title>
    <url>/2023/07/29/%E5%90%84%E7%A7%8D%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>了解及总结（同步通信-异步通信-全双工通信-串行通信-并行通信）各种通信方法</p>
<span id="more"></span>
<h1 id="并行通信-and-串行通信">并行通信 and 串行通信</h1>
<h2 id="并行通信">并行通信</h2>
<p>Parallel communication</p>
<h4 id="传输方式">传输方式</h4>
<p>多个数据bit位同时传输</p>
<h4 id="常用总线">常用总线</h4>
<p>local bus, DDR</p>
<h4 id="特点">特点</h4>
<ul>
<li>同时传输，效率高</li>
<li>数据线多，设计复杂</li>
</ul>
<h2 id="串行通信">串行通信</h2>
<p>Serial communication</p>
<h4 id="传输方式-1">传输方式</h4>
<p>数据bit一位一位传输</p>
<h4 id="常用总线-1">常用总线</h4>
<p>local bus, DDR</p>
<h4 id="特点-1">特点</h4>
<ul>
<li>按bit逐位传输，效率低</li>
<li>只需一根数据线，设计简单</li>
</ul>
<h1 id="异步串行通信-and-同步串行通信">异步串行通信 and
同步串行通信</h1>
<h2 id="异步串行通信">异步串行通信</h2>
<p>Asynchronous serial communication</p>
<h4 id="特点-2">特点</h4>
<ul>
<li>信息发送设备与接收设备之间无时钟连接</li>
<li>信息中包含特殊标志位Start/Stop</li>
<li>接收设备根据特殊标志位利用本地时钟对数据采样</li>
</ul>
<h4 id="example">Example</h4>
<p>UART，无时钟线连接</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">接收器   发送器</span><br><span class="line">TxD-----&gt;RxD</span><br><span class="line">RxD&lt;-----TxD</span><br></pre></td></tr></table></figure>
<h2 id="同步串行通信">同步串行通信</h2>
<p>Synchronous serial communciation</p>
<h4 id="特点-3">特点</h4>
<ul>
<li>信息发送设备与接收设备需要时钟同步</li>
<li>两者间出数据线连接，还需要额外的时钟线连接</li>
</ul>
<h4 id="example-1">Example</h4>
<p>IIC,需要时钟线SCL连接</p>
<h1
id="三种数据通路单工半双工全双工">三种数据通路：单工，半双工，全双工</h1>
<h2 id="单工通信">单工通信</h2>
<p>Simplex communciation</p>
<h4 id="特点-4">特点</h4>
<ul>
<li>信息只能单一方向传输</li>
</ul>
<h4 id="example-2">Example</h4>
<p>广播，遥控器</p>
<h2 id="半双工通信">半双工通信</h2>
<p>Half-duplex communciation</p>
<h4 id="特点-5">特点</h4>
<ul>
<li>数据支持双向传输</li>
<li>发送和接收不能同时进行，同一时间只能发送or接收数据</li>
</ul>
<h4 id="example-3">Example</h4>
<p>IIC</p>
<h2 id="全双工通信">全双工通信</h2>
<p>Full-duplex communciation</p>
<h4 id="特点-6">特点</h4>
<ul>
<li>数据支持双向传输</li>
<li>数据接收和发送同时进行</li>
</ul>
<h4 id="example-4">Example</h4>
<p>电话、网口、UART</p>
<h1 id="references">References</h1>
<ul>
<li>B站视频：【四分钟搞定【同步通信-异步通信-全双工通信-串行通信-并行通信】】https://www.bilibili.com/video/BV1q64y1R72M?vd_source=93bb338120537438ee9180881deab9c1</li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>嵌入式</tag>
        <tag>通信</tag>
      </tags>
  </entry>
  <entry>
    <title>用户名更改and下载cubeMX和keil的一些问题</title>
    <url>/2023/08/17/cubeMX%E5%92%8Ckeil%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%8D%B8%E8%BD%BD/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>cubeMX和keil的安装+卸载及集成到VSCode</p>
<p>被两个软件安装和卸载折磨了！！！,终获成功！！！</p>
<p>多次卸载+安装始终无法正确使用，反而把两个软件的安装+卸载搞熟悉了</p>
<span id="more"></span>
<h1 id="改用户名">改用户名</h1>
<p>主要的错误应该是我的用户名用的中文吧，所以决定壮士断腕改为英文名，看了很多失败的案例，还是选择在淘宝上请一个师傅远程操作（这种事情还是安全为上！）</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/_-721152154__465acad98c72f8e17ea03c287d76d4af_207603416_IMG_20230815_173354_0_xg_0.jpg"
alt="error1" />
<figcaption aria-hidden="true">error1</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/_-639538789__b14d87141ec83c2e90a4fa2c3b7ca94e_210373979_IMG_20230815_173357_0_xg_0.jpg"
alt="error2" />
<figcaption aria-hidden="true">error2</figcaption>
</figure>
<p>但改了用户名后就会有很多软件不能用，必要的还是重新下载为好</p>
<h1 id="stm32cubemx">STM32CubeMX</h1>
<h2 id="下载">下载</h2>
<p>在官网直接下载即可</p>
<p>但是使用时必须下载相应的库才行：在首页HELP-&gt;Manage embedded
software packages中可以直接install/update</p>
<blockquote>
<p>Tips:旧版可以直接下，最新版必须要ST公司的账号（注册是免费的）</p>
</blockquote>
<h2 id="firmware-packages">Firmware packages</h2>
<p>我的路径仍然有问题，且无法修改，所以还是选择从官网上下载.zip文件，然后在固件管理中选择from
local</p>
<h2 id="卸载">卸载</h2>
<p>现在控制面板的程序和功能中删除STM32CubeMX,然后清除C盘的一些残留数据文件夹</p>
<ul>
<li>C:Files32Cube32CubeMX</li>
<li>C:<username>32CubeMX</li>
<li>C:<username>32CubeMX</li>
</ul>
<p>最后删除注册表中的相关项：在Win+R中输入regedit进入注册表编辑器，进入以下路径：HKEY_CURRENT_USER32CubeMX，右键单击“STM32CubeMX”文件夹，选择“删除”。</p>
<h1 id="keil5">keil5</h1>
<h2 id="下载-1">下载</h2>
<p>找好心人（知乎，B站，贴吧。。。）的网盘资源下载，按指令要求安装完后进行注册</p>
<p>然后使用注册机，之前的注册机2020年失效，寻找最新的可以到2032年</p>
<blockquote>
<p>Tips:注册时，注册机和keil的打开都必须以管理员的方式打开</p>
</blockquote>
<h2 id="pack-install">Pack install</h2>
<p>进入keil后点击pack install(一个绿绿的选项)下载必要的pack</p>
<blockquote>
<p>Tips:可以直接在官网上下载（最新），然后双击会自动下载到keil里面</p>
</blockquote>
<h2 id="卸载-1">卸载</h2>
<p>有unstall固然挺好，否则把文件夹卸载后，要在Win+R中输入regedit进入注册表编辑器在里面将HKEY_CLASSES_ROOT目录下的
所有UV开头的文件删除，然后将HKEY_CURRENT_USER</p>
<h1 id="vscode">VSCode</h1>
<p>在keil中配置好后在VSCode中打开：</p>
<p>先在VSCode中下载<code>Keil Assistance</code>,然后在管理扩展中给出<code>MDK UV4.exe path</code>即可</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230817224831344.png"
alt="image-20230817224831344" />
<figcaption aria-hidden="true">image-20230817224831344</figcaption>
</figure>
<blockquote>
<p>看到这一幕好激动！！！</p>
</blockquote>
<h1 id="references">References</h1>
<ul>
<li><a
href="https://wenku.csdn.net/answer/564b100e9b124f08943a2fe894a8c7c4#:~:text=stm32cubemx卸载干净教程%201%20关闭STM32CubeMX软件及其相关的进程。%202%20打开控制面板，选择“程序和功能”。%203%20在已安装的程序列表中，找到并选择“STMicroelectronics%20STM32CubeMX”。,7%20删除Java%20Runtime%20Environment（JRE）中的缓存：%20打开控制面板，选择“Java”。%20...%208%20最后，重新启动计算机。">stm32cubemx卸载干净教程
- CSDN文库</a></li>
<li><a
href="https://blog.csdn.net/Damon_Sandy/article/details/130314186">如何彻底删除keil5_keil卸载_胜折宇的博客-CSDN博客</a></li>
</ul>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>嵌入式</tag>
      </tags>
  </entry>
  <entry>
    <title>基于CubeMX创建的第一个stm32工程</title>
    <url>/2023/08/04/%E5%9F%BA%E4%BA%8EcubeMX%E5%88%9B%E5%BB%BA%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAstm32%E5%B7%A5%E7%A8%8B/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>记录我的基于STM32Cube框架的第一个stm32程序从新建到编译上传全流程，感谢机协学长学姐的帮助！</p>
<span id="more"></span>
<h1 id="流程梳理">流程梳理</h1>
<ul>
<li>通过STM32CubeMX选择芯片、配置外设，并生成代码</li>
<li>在选用的编辑器中编辑代码，编写程序</li>
<li>编译代码，生成二进制文件并上传</li>
<li>调试代码的运行效果</li>
</ul>
<h1 id="芯片配置">芯片配置</h1>
<h2 id="选择芯片开发板">选择芯片/开发板</h2>
<p>但是需要注意，若选择官方开发板作为硬件，则会提供“按照开发板上的电路及布局默认配置硬件”的选项</p>
<h2 id="配置内核与外设硬件">配置内核与外设硬件</h2>
<p><strong>系统配置</strong>：时钟配置+调试配置</p>
<p><strong>时钟配置</strong>（必要）：STM32有四个时钟源：LSI（低速内部时钟）、LSE（低速外部时钟）、HIS（高速内部时钟）和HSE（高速外部时钟）；有的型号仅有其中某几个。默认的配置是采用芯片内部自带的振荡器、主频配置为8MHz。Nucleo
F103RB中芯片外接了8MHz的晶振，故将“HSE”项配置为“Crystal/Ceramic
Resonator”，这就是说使用高速外部时钟，且时钟源为晶振。具体频率则在时钟树界面中配置（在使用内部振荡器时F1系列芯片最高主频是64MHz，在使用8MHz外部晶振时最高主频是72MHz。）</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230605232417189.png"
alt="image-20230605232417189" />
<figcaption aria-hidden="true">image-20230605232417189</figcaption>
</figure>
<p><strong>调试配置</strong>：用于配置调试的类型（如果芯片未被配置为调试模式就强行对其进行调试，则会造成芯片内部启动程序错误而导致之后无法正常烧录程序，此时需擦除其Flash以修复）</p>
<p>主流的调试方式有SWD和JTAG两种，而SWD是更方便的方法。若要使用SWD进行调试，则必须将芯片配置为“Serial
Wire”调试。</p>
<p><strong>外设硬件</strong>：芯片中的所有外设都可以在软件中配置，包括DMA、ADC、定时器等</p>
<h2 id="配置工程生成代码">配置工程，生成代码</h2>
<h4 id="工程名称路径">工程名称，路径</h4>
<h4 id="应用结构"><strong>应用结构</strong>：</h4>
<p>应用结构有“Basic”和“Advanced”两个选项。如果观察仔细的话，会发现STM32CubeIDE工程中的CubeMX项目默认的是“Advanced”结构，而单独使用CubeMX默认的是“Basic”结构</p>
<h6 id="image-20230605232417189"><img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230605232417189.png"
alt="image-20230605232417189" /></h6>
<h4 id="工具链ide">工具链/IDE：</h4>
<p>STM32CubeMX除了配置硬件外，还提供了直接生成工程
的功能，即由该“工具链/IDE”选项确定。STM32CubeMX预先包含了7种
开发方式，分别是：EWARM、MDK-ARM、SW4STM32、TrueStudio、
STM32CubeIDE、Makefile和Other Toolchains(GPDSC)</p>
<p><strong><em>*MDK-ARM*</em></strong>：Keil
uVision采用的开发环境，使用此选项可以直接生成Keil完整工程。</p>
<p><strong><em>*TrueStudio、STM32CubeIDE*</em></strong>：TrueStudio是STM32CubeIDE的前身。TrueStudio本身是以Eclipse为基础配置而成的STM32开发工具，在被ST收购被ST与STM32CubeMX合并，形成了STM32CubeIDE。故该两种选项生成的项目并无较大区别。对于使用Eclipse自行配置来为STM32开发的同学，也可以选择该选项。</p>
<p><strong><em>*Makefile*</em></strong>：Makefile实际上是“make”这个程序为了实现自动化构建工程而读取的一种文件。make从Makefile文件中读取生成的对象、编译的顺序、文件的依赖等信息，然后使用gcc或者g++来编译。Makefile不仅适用于系统下的标准C/C++工程，也适用于嵌入式开发。为Arm架构芯片开发的gcc叫做“arm-none-eabi-gcc”，可以在GNU的官网上下载。PlatformIO使用gcc来编译STM32的程序，故采用Makefile选项更搭配。</p>
<p>但实际上PlatformIO自带一套使用Python来构建工程的方法，因此用不到Makefile；真正需要的只是“Inc”和“Src”两个文件夹中的代码而已。如果有同学有兴趣的话，可以尝试使用gcc搭配make自行搭建一套工具链，这个时候STM32CubeMX生成的Makefile文件就会派上用场。</p>
<h4 id="包管理">包管理：</h4>
<p>包管理有三种选项，翻译过来就是：仅复制用到的库文件、复制所有库文件、仅添加引用。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230605232846792.png"
alt="image-20230605232846792" />
<figcaption aria-hidden="true">image-20230605232846792</figcaption>
</figure>
<ul>
<li>仅复制用到的库文件</li>
<li>复制所有库文件</li>
<li>仅添加引用：最简洁但不能移植</li>
</ul>
<p>当选择了复制库文件到工程时，除了Inc和Src两个文件夹（或Advanced模式下的Core文件夹）外，还会额外生成一个Driver文件夹，其中放置的便是STM32的库文件。当启用了USB或者FreeRTOS等中间件后，也还会额外生成一个Middleware文件夹，其中放置的便是中间件的库文件。文件结构如下所示：</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230605233921565.png"
alt="image-20230605233921565" />
<figcaption aria-hidden="true">image-20230605233921565</figcaption>
</figure>
<h4 id="生成选项">生成选项：</h4>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230605233713820.png"
alt="image-20230605233713820" />
<figcaption aria-hidden="true">image-20230605233713820</figcaption>
</figure>
<blockquote>
<p>Tips:点击.ioc文件可以打开CubeMX重新配置</p>
</blockquote>
<h1 id="程序编写">程序编写</h1>
<p>/* USER CODE BEGIN x <em>/ </em></p>
<p>/* USER CODE END x */</p>
<p>其中的x可以是数字，也可以是别的一些标识符。STM32CubeMX希望用户将自己的代码插入到“BEGIN”和“END”当中，</p>
<p><strong>reason:</strong></p>
<p>之所以要这样做是因为STM32CubeMX在更新代码时不会修改这两句注释之间的内容。比如当用户的需求发生了变动，需要修改硬件配置时，就需要使用STM32CubeMX来修改并重新生成代码。如果将用户代码放在这两句注释之间，STM32CubeMX就不会在重新生成代码的时候覆盖掉这部分。这使得硬件配置的更改变得更加方便</p>
<h1 id="编译上传">编译上传</h1>
<p>单片机、乃至目前一切电脑都不能直接运行代码文件，必须通过编译器将代码文件编译成CPU能够处理的机器语言——即二进制机器指令——才能烧录到芯片执行。STM32主流的编译器——也即arm芯片所用的编译器——有两种：arm-gcc和Arm
Compiler。Keil默认采用Arm
Compiler，而STM32CubeIDE和PlatformIO则采用arm-gcc。二者在编译原理上有差别，但是在代码层面很难体现出来</p>
<h1 id="调试程序">调试程序</h1>
<p>ST-Link不只是程序下载器，还是调试器，能够通过JTAG接口或者SWD接口控制芯片的运行、读取芯片的寄存器、内存等。我们可以观察到芯片中每个寄存器的值、每个变量的值及其变化，可以通过断点让程序运行到指定的位置、检测中断的执行；从而能够方便地调试代码。</p>
<h1 id="代码结构">代码结构</h1>
<h2 id="结构概述">结构概述</h2>
<p>STM32CubeMX软件生成出来的代码具有高度的结构性。按文件予以区分，各个文件的功能如下：</p>
<table>
<thead>
<tr class="header">
<th>文件</th>
<th>简介</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>stm32f1xx_it.h/stm32f1xx_it.c</td>
<td>实现stm32的所有中断程序</td>
</tr>
<tr class="even">
<td>stm32f1xx_hal_conf.h</td>
<td>HAL库配置文件</td>
</tr>
<tr class="odd">
<td>system_stm32f1xx.c</td>
<td>在内核层面上设置系统时钟</td>
</tr>
<tr class="even">
<td>stm32f1xx_hal_msp.c</td>
<td>特定单片机具体配置</td>
</tr>
<tr class="odd">
<td>main.h</td>
<td>包含了应用程序全局的定义</td>
</tr>
<tr class="even">
<td>main.c</td>
<td>实现主程序</td>
</tr>
<tr class="odd">
<td>gpio.h/gpio.c（以及类似的tim、usart等）</td>
<td>专门配置某个外设硬件</td>
</tr>
</tbody>
</table>
<p>接下来将逐个讲解这些文件的功能。</p>
<h2 id="文件与程序功能">文件与程序功能</h2>
<h3 id="stm32f1xx_hal_conf.h">stm32f1xx_hal_conf.h：</h3>
<p>该文件定义了<strong>启用的HAL模块</strong>，并设置了一些宏参数——比如晶振频率等。</p>
<p>C/C++中的宏常用于<strong>选择性编译</strong>的程序，此处即使用了此原理。通过一系列宏来确定需要引用哪些头文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* Includes ----------------------------------------------------------*/</span><br><span class="line"> /**</span><br><span class="line">  \* @brief Include module&#x27;s header file</span><br><span class="line">  */</span><br><span class="line"></span><br><span class="line"> #ifdef HAL_RCC_MODULE_ENABLED</span><br><span class="line"> #include &quot;stm32f1xx_hal_rcc.h&quot;</span><br><span class="line"> #endif /* HAL_RCC_MODULE_ENABLED */</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tips:只有定义了对应的宏，才会引用对应的头文件，对应的模块才能够在应用中使用。这些宏不需要使用者手动定义，STM32CubeMX会自动根据在软件中选择的配置来定义这些宏、启用对应的模块。</p>
</blockquote>
<h3 id="system_stm32f1xx.c">system_stm32f1xx.c</h3>
<p>该文件不涉及任何HAL库中的内容，仅仅从内核上使用寄存器的方式来初始化时钟，并提供了时钟频率值更新的函数。该文件中包含两个函数，如下所示：</p>
<table>
<thead>
<tr class="header">
<th>SystemInit()</th>
<th>按照默认配置设置系统时钟、嵌入式Flash等</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SystemCoreClockUpdate()</td>
<td>根据当前的配置计算芯片主频</td>
</tr>
</tbody>
</table>
<p>这两个函数在代码中都没有显式调用。实际上SystemInit()的调用是写在启动文件中的：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* Call the clock system intitialization function.*/  </span><br><span class="line">bl  SystemInit</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Notes:其调用发生在复位后、进入主函数前。其实本来可以通过修改该函数的参数就能实现时钟树的配置，但是HAL库选择了以自己的方法实现时钟配置，因此SystemInit()函数仅仅实现了默认的时钟配置，也就是采用内部时钟、主频为8MHz。<strong>真正的时钟配置是在主函数中进行的。</strong></p>
</blockquote>
<h3 id="stm32f1xx_it.hstm32f1xx_it.c">stm32f1xx_it.h/stm32f1xx_it.c</h3>
<p>这两个文件包含了单片机用到的所有中断服务程序，主要分为两个部分：内核中断和外设中断。</p>
<h4 id="内核中断">内核中断</h4>
<p>在代码中内核中断以以下注释作为开始：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**********************************************************************/ /*    Cortex-M3 Processor Interruption and Exception Handlers     */  /**********************************************************************/</span><br></pre></td></tr></table></figure>
<p>内核中断指的是那些由STM32芯片中内核部分——包括F1系列采用的Cortex-M3内核、F4系列采用的Cortex-M4内核等——产生的中断。这些中断多是一些通用的、系统性的中断，如SysTick_Handler（系统滴答定时器中断）、HardFault_Handler（硬件错误中断）等。STM32CubeMX将其自动列出来，方便使用者修改。比如HardFault_Handler，当系统出现硬件错误的时候便会跳转到这里，可以利用这一中断函数很快定位bug的来源。</p>
<p>注意，内核中断中的SysTick_Handler默认被HAL库用于计时。如果没有实现该中断函数则会使HAL库失去计时功能。当然这也是已经由STM32CubeMX软件自动完成了，可以在SysTick_Handler函数中看见被调用的库函数HAL_IncTick。</p>
<p>系统滴答定时器中断：由系统滴答定时器产生</p>
<p>硬件错误中断：当发生内存溢出、访问越界、堆栈溢出时进入</p>
<p>HAL库计时功能默认采用系统滴答定时器来进行计时，但也可以换用TIM1、TIM2等外设计时器：可在STM32CubeMX的SYS部分配置</p>
<h4 id="外设中断">外设中断</h4>
<p>在代码中外设中断以以下注释作为开始：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**********************************************************************/ /* STM32F1xx Peripheral Interrupt Handlers                 */ /* Add here the Interrupt Handlers for the used peripherals.      */ /* For the available peripheral interrupt handler names,         */ /* please refer to the startup file (startup_stm32f1xx.s).        */ /**********************************************************************/</span><br></pre></td></tr></table></figure>
<p>外设中断指的是由单片机内非内核部分的外设硬件产生的中断，如定时器中断、外部中断、串口中断等。当在STM32CubeMX中选择了相应的中断时便会自动在此处添加中断服务函数。</p>
<h3 id="stm32f1xx_hal_msp.c">stm32f1xx_hal_msp.c</h3>
<p>MSP指的是MCU Specific
Package，即单片机具体方案。HAL库体系下，初始化分为两个步骤：抽象层初始化+MSP初始化。</p>
<p>以串口为例。串口的属性包括波特率、数据位、校验位等；但是这些属性属于抽象属性，无论这个串口是STM32单片机的串口1还是串口2，或者是Arduino上的甚至51单片机上的串口，都拥有这些属性。抽象属性的初始化即为抽象层的初始化。但是要让串口真正工作起来，仅仅告诉它波特率多少、数据位多少、有无校验位是不够的，还要配置串口的时钟、串口的DMA、串口的复用引脚等，而这些属性在不同单片机上是不一样的。这些初始化即为MSP初始化。只有经过了这两层初始化，开发者才能按照需求使用抽象硬件。</p>
<p>该文件实现的即是单片机全局的MSP初始化函数：HAL_MspInit()。如下所示，实现了复用引脚和电源的时钟使能，并且关闭了JTAG调试而改用SWD调试：</p>
<blockquote>
<p>Tips:因为在CubeMX中的配置是SWD</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> \* Initializes the Global MSP.</span><br><span class="line"> */</span><br><span class="line">void HAL_MspInit(void)</span><br><span class="line">&#123;</span><br><span class="line"> __HAL_RCC_AFIO_CLK_ENABLE();</span><br><span class="line"> __HAL_RCC_PWR_CLK_ENABLE();</span><br><span class="line"></span><br><span class="line"> /* System interrupt init*/</span><br><span class="line"></span><br><span class="line"> /** NOJTAG: JTAG-DP Disabled and SW-DP Enabled</span><br><span class="line"> */</span><br><span class="line"> __HAL_AFIO_REMAP_SWJ_NOJTAG();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该函数并非在源文件中进行调用，而是在库文件中进行调用。HAL库的初始化函数在进行完毕抽象层的初始化后便会调用相应的MSP初始化函数。</p>
<h3 id="main.h">main.h</h3>
<p>该文件包含了全局的宏定义，并且包含了单片机的库文件。从STM32Cube的设计上来看，官方希望开发者将全局的定义、包含、常量等都写在该文件中，并在各个源文件中都包含该main.h</p>
<p>文件中为开发者预留了填写包含（Private includes）、类型（Exported
types）、常量（Exported constants）、宏函数（Exported
macro）、函数原型（Exported functions prototypes）和宏定义（Private
defines）。</p>
<h3 id="main.c">main.c</h3>
<ul>
<li>在main函数中，首先初始化了HAL库：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* Reset of all peripherals, Initializes the Flash interface and the Systick. */</span><br><span class="line">HAL_Init();</span><br></pre></td></tr></table></figure>
<ul>
<li>然后配置了系统时钟。此处的时钟配置和之前的SystemInit函数不一样，SystemInit函数中直接修改寄存器配置时钟，而此处则使用HAL库的库函数来配置；该函数也在main.c文件中实现，将单片机的时钟配置成软件中时钟树所配置成的样子。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* Configure the system clock */ SystemClock_Config();</span><br></pre></td></tr></table></figure>
<ul>
<li>其次初始化了所有外设。本例中仅有GPIO进行了初始化，因此此处也仅有GPIO的初始化函数。以后若有其他外设需要初始化，CubeMX也会将其放在该位置。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* Initialize all configured peripherals */ MX_GPIO_Init();</span><br></pre></td></tr></table></figure>
<ul>
<li>接下来便进入死循环。单片机上的程序不像我们电脑上的程序；电脑上的程序运行结束后就由操作系统回收资源了，单片机上的程序则会一直运行，从主函数返回后就回到了汇编启动文件中，接下来单片机的行为就不是我们在C语言代码中可以控制的了。因此在main函数中写入一个死循环，程序就不会从main函数退出。而实际的应用场景中，我们需要实现的功能很多时候也正是需要写在死循环中不断去执行。（callback
function）</li>
</ul>
<h2 id="代码组织">代码组织</h2>
<p>stm32的工程为C语言工程，编译时不会产生元数据，全靠头文件的包含和源文件的编译链接来实现工程组成，因此尤其需要开发者设计好合适的工程结构。</p>
<p>关于C语言工程的结构，网上有许多的文章都提供了如何组织代码的方法。实际上代码的组织并没有一个非常统一的方案，大多都是按照开发者自己的喜好来设计。此处也不会要求同学们使用某种代码组织方法，仅仅提供笔者使用的代码结构供参考。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230606131555059.png"
alt="image-20230606131555059" />
<figcaption aria-hidden="true">image-20230606131555059</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230606131609394.png"
alt="image-20230606131609394" />
<figcaption aria-hidden="true">image-20230606131609394</figcaption>
</figure>
<p>当程序的逻辑逐渐复杂的时候，也可以不仅仅使用一对App.h/c文件来实现全部逻辑，而可以使用多个文件分别实现一部分，此处不详述。</p>
<h4 id="一些别的原则">一些别的原则</h4>
<ul>
<li><p>不要包含源文件，而是包含头文件；头文件中也不要包含函数或者全局变量的定义，而仅仅包含其声明。将函数的定义放在源文件里，函数的声明放在头文件中；变量的定义放在源文件里，再在头文件中将其extern</p></li>
<li><figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/image-20230606131804276.png"
alt="image-20230606131804276" />
<figcaption aria-hidden="true">image-20230606131804276</figcaption>
</figure></li>
<li><p>使用易理解函数、类型、变量名称。杜绝使用意义不明的命名，如a、b、l、m等，而要使用意义明确的名字，如使用单词或者易于理解的缩写来描述。此处不推荐使用拼音进行命名。如下展示的是STM32的HAL库中的一个函数命名作为示例</p>
<table>
<colgroup>
<col style="width: 46%" />
<col style="width: 21%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="header">
<th><strong><em>*函数名：HAL_GPIO_WritePin*</em></strong></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong><em>*HAL*</em></strong></td>
<td><strong><em>*GPIO*</em></strong></td>
<td><strong><em>*WritePin*</em></strong></td>
</tr>
<tr class="even">
<td>该函数隶属于HAL库</td>
<td>该函数与GPIO相关</td>
<td>该函数的功能是写引脚的值</td>
</tr>
</tbody>
</table></li>
<li><p>使用规律的命名规则。常见的几种基础的命名规则如下：</p></li>
</ul>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="header">
<th>驼峰命名</th>
<th>组成变量名的第一个单词的首字母小写，其余的首字母大写。Arduino采用的便是驼峰命名规则，如analogWrite，attachInterrupt等。</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>帕斯卡命名</td>
<td>组成变量名的各个单词的首字母均大写。C#就常用帕斯卡命名规则，如Console.WriteLine，XmlSerializer等。</td>
</tr>
<tr class="even">
<td>下划线命名</td>
<td>组成变量名的单词均为小写，其间使用下划线连接。树莓派Pico的SDK采用的便是下划线命名，如hw_set_bits、sleep_ms</td>
</tr>
</tbody>
</table>
<p>这些命名规则仅仅作为参考，实际上可以使用混合的命名规则，比如公共成员使用帕斯卡命名、私有成员使用驼峰命名，或者在一个变量中使用组合式的命名规则。但是在整个工程中对象的命名规则务必有迹可循。</p>
]]></content>
      <categories>
        <category>嵌入式</category>
      </categories>
      <tags>
        <tag>robomaster</tag>
        <tag>嵌入式</tag>
      </tags>
  </entry>
  <entry>
    <title>旅游日记——丽水、温州</title>
    <url>/2023/08/16/%E6%97%85%E6%B8%B8%E6%97%A5%E8%AE%B0%EF%BC%881%EF%BC%89/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>记录本人赴丽江与亮哥携行之游，结果美景没看（在丽江是一点没出门，温州至少出了门），纯在恰饭。</p>
<p>与其说是旅游日记，不如说是美食日记！</p>
<span id="more"></span>
<h1 id="启程">启程</h1>
<p>白天赶忙订了杭州到丽江的火车票，可惜只有无座票9：15——10.27，虽然车程只有1H，但站在两车厢之间也确实折磨。。。（不想再买无座票了）</p>
<blockquote>
<p>Tips:<无座票>无固定座位，如果有空位是可以坐的，还可以看每个座位上的指示灯看该位置是否有人or下一站是否有人，但价格和二等座是一样的。</p>
</blockquote>
<h1 id="在丽江">在丽江</h1>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/ac81ee0fed88a2f3e4b56b8b5cf4402.jpg"
alt="在丽江的第一晚夜宵" />
<figcaption aria-hidden="true">在丽江的第一晚夜宵</figcaption>
</figure>
<p>u1s1这个镇上的烧烤肉质一般，但奈不住啤酒配烧烤</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/2aa5d4c64ea9a591e08db87223d8d9c.jpg"
alt="第二日中午的烤鱼" />
<figcaption aria-hidden="true">第二日中午的烤鱼</figcaption>
</figure>
<p>听说是海鲈鱼，肉确实要嫩一点，不过感觉没太入味。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/a387a1249b6ed1ba586188999aa4907.jpg"
alt="第二日晚餐" />
<figcaption aria-hidden="true">第二日晚餐</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/034763f0401551e174052ff5f96fe9a.jpg"
alt="第三日午餐" />
<figcaption aria-hidden="true">第三日午餐</figcaption>
</figure>
<p>家常川菜赛高！</p>
<h1 id="在温州">在温州</h1>
<p>下午驱车两小时到达温州，下车即食。</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/83af4592116791dc0e8c1d53b684fa0.jpg"
alt="83af4592116791dc0e8c1d53b684fa0" />
<figcaption
aria-hidden="true">83af4592116791dc0e8c1d53b684fa0</figcaption>
</figure>
<p>温州餐厅选菜原来是这样选的：一个人跟着你做记录，你只管看需要什么（海鲜选，其他菜也是有样品的）</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/5a5a55fd4ad0d5949844b7e4a78d3ee.jpg"
alt="5a5a55fd4ad0d5949844b7e4a78d3ee" />
<figcaption
aria-hidden="true">5a5a55fd4ad0d5949844b7e4a78d3ee</figcaption>
</figure>
<p>虽然菜还没上齐。。。</p>
<blockquote>
<p>Tips:温州有条瓯江，于是诞生了一种饮品叫瓯萌瓯柑饮料，味道还行</p>
</blockquote>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/image_host/main/blog/42f5fb709dec2a8ffd1f7d5a99935a1.jpg"
alt="温州猪脏粉" />
<figcaption aria-hidden="true">温州猪脏粉</figcaption>
</figure>
<p>温州猪脏粉，味道一般，可惜。</p>
<h1 id="ending">Ending</h1>
<p>虽然有几顿忘拍照，但总算是吃了一路！</p>
<p>记得来尝尝三鲜面/粉：小黄鱼、虾、蛏(cheng)子。虽然味道有点淡，但是还是很鲜的。</p>
]]></content>
      <categories>
        <category>life</category>
      </categories>
      <tags>
        <tag>life</tag>
        <tag>journey</tag>
      </tags>
  </entry>
  <entry>
    <title>推文制作</title>
    <url>/2023/08/23/%E6%8E%A8%E6%96%87%E5%88%B6%E4%BD%9C/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>在太极拳社团中我常被安排写一些推文，开始直接上手（有点丑），现在还是花点时间学习一下这个有用的技能。</p>
<p><strong>推文 = 文案 + 排版</strong></p>
<blockquote>
<p>Tips:学习制作推文还是建议大家看看References中的视频，看这篇blog并不能让你学会制作推文，自己做一篇就懂了。</p>
</blockquote>
<span id="more"></span>
<h1 id="文案">文案</h1>
<p>推文的一大特点就是图文并茂：</p>
<ul>
<li>标题+摘要</li>
<li>上半部分：直接使用的段落</li>
<li>下半部分：素材</li>
</ul>
<p>建议直接chat+bing</p>
<h1 id="排版">排版</h1>
<p>使用<strong>秀米编辑器</strong>（highly recommended）</p>
<blockquote>
<p>Tips:135编辑器:开始我用的135，免费的就东摘西选，不能成为一套。还是秀米好用</p>
</blockquote>
<h2 id="关注我们">关注我们</h2>
<p>使用情形：社团纳新</p>
<p>位置：组件-&gt;关注原文</p>
<blockquote>
<p>Tips:</p>
</blockquote>
<h2 id="正文">正文</h2>
<p>位置：卡片-&gt;选择即可</p>
<p>右键可查看标签，然后多标签搜索，可以查到整套模板；</p>
<p>可以保存卡片底色到调色板，更改其他的底色就可以保持颜色一致</p>
<h2 id="美观">美观</h2>
<ul>
<li>位置：组件-&gt;分割线/分隔符</li>
</ul>
<h2 id="二维码">二维码</h2>
<p>直接放卡片，然后更改二维码即可</p>
<h1 id="references">References</h1>
<ul>
<li>【【芝芝子】微信公众号推文制作，20分钟包教包会】https://www.bilibili.com/video/BV1KS4y1j7dv?vd_source=93bb338120537438ee9180881deab9c1</li>
</ul>
]]></content>
      <categories>
        <category>奇技淫巧</category>
      </categories>
      <tags>
        <tag>奇技淫巧</tag>
      </tags>
  </entry>
  <entry>
    <title>正则表达式</title>
    <url>/2023/08/23/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>根据<a
href="https://deerchao.cn/tutorials/regex/regex.htm">正则表达式30分钟入门教程
(deerchao.cn)</a>这篇文章来学习的正则表达式，文章介绍的是 .Net
下的正则表达式，其它环境下的具体情况可以在读完本文后去参考官方文档，或者查看<a
href="https://deerchao.cn/tutorials/regex/diffs.html">正则表达式引擎特性对比</a>。</p>
<blockquote>
<p>Tips:正则表达式学不了一点，看得头疼，偶的建议是了解点基础语法即可。有需要的时候再回头来看。</p>
</blockquote>
<span id="more"></span>
<h1 id="简介">简介</h1>
<p>正则表达式就是记录文本规则的代码。常用于查找符合某些复杂规则的字符串的需要。</p>
<p>比<strong>通配符</strong>（wildcard:*和?）更精确，也更复杂</p>
<h1 id="测试正则表达式">测试正则表达式</h1>
<p>.Net下的工具 <a
href="https://deerchao.cn/tools/regester/">Regester</a>，直接测试</p>
<p>也可以试试这个在线测试工具：<a
href="https://deerchao.cn/tools/wegester/">Wegester,
JavaScript正则表达式测试器。</a></p>
<p><strong>常用的处理选项</strong>：</p>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="header">
<th>名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>IgnoreCase(忽略大小写)</td>
<td>匹配时不区分大小写。</td>
</tr>
<tr class="even">
<td>Multiline(多行模式)</td>
<td>更改^和<span
class="math inline">\(的含义，使它们分别在任意一行的行首和行尾匹配，而不仅仅在整个字符串的开头和结尾匹配。(在此模式下,\)</span>的精确含意是:匹配.)</td>
</tr>
<tr class="odd">
<td>Singleline(单行模式)</td>
<td>更改.的含义，使它与每一个字符匹配（包括换行符）。</td>
</tr>
<tr class="even">
<td>IgnorePatternWhitespace(忽略空白)</td>
<td>忽略表达式中的非转义空白并启用由#标记的注释。</td>
</tr>
<tr class="odd">
<td>ExplicitCapture(显式捕获)</td>
<td>仅捕获已被显式命名的组。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Tips<处理多行>:如果选中了这个选项，^和$的意义就变成了匹配行的开始处和结束处。</p>
<p>多行模式和单行模式没任何关系，可以同时使用</p>
</blockquote>
<h1 id="注释">注释</h1>
<p>学习任何一样工具，我认为最首要的是学会如何写注释：</p>
<p>通过语法<code>(?#comment)</code>来包含注释</p>
<p>要包含注释的话，最好是启用“忽略模式里的空白符”选项，这样在编写表达式时能任意的添加空格，Tab，换行，而实际使用时这些都将被忽略。启用这个选项后，在#后面到这一行结束的所有文本都将被当成注释忽略掉。</p>
<h1 id="元字符">元字符</h1>
<p>metacharater</p>
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr class="header">
<th>代码</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>.</td>
<td>匹配除换行符以外的任意字符</td>
</tr>
<tr class="even">
<td></td>
<td>匹配字母或数字或下划线或汉字</td>
</tr>
<tr class="odd">
<td></td>
<td>匹配任意的空白符（包括空格，制表符(Tab)，换行符，中文全角空格等）</td>
</tr>
<tr class="even">
<td> 匹配数字</td>
<td></td>
</tr>
<tr class="odd">
<td> 匹配单词的开始或结束(只匹配一个位置，不匹配字符)</td>
<td></td>
</tr>
<tr class="even">
<td>^</td>
<td>匹配字符串的开始</td>
</tr>
<tr class="odd">
<td>$</td>
<td>匹配字符串的结束</td>
</tr>
</tbody>
</table>
<ul>
<li>避免重复书写：0-。这里({8})的意思是前面2次(8次)。</li>
</ul>
<blockquote>
<p>Tips:{5,12}和{2}是类似的，只不过{2}匹配只能不多不少重复2次，{5,12}则是重复的次数不能少于5次，不能多于12次，否则都不匹配。</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th>代码/语法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>*</td>
<td>重复零次或更多次</td>
</tr>
<tr class="even">
<td>+</td>
<td>重复一次或更多次</td>
</tr>
<tr class="odd">
<td>?</td>
<td>重复零次或一次</td>
</tr>
<tr class="even">
<td>{n}</td>
<td>重复n次</td>
</tr>
<tr class="odd">
<td>{n,}</td>
<td>重复n次或更多次</td>
</tr>
<tr class="even">
<td>{n,m}</td>
<td>重复n到m次</td>
</tr>
</tbody>
</table>
<ul>
<li><p>字符转义：使用\.和\*来查找.和*。当然，要查找，你也得用\.</p></li>
<li><p>字符类：在方括号里列出想匹配的字符集合即可</p>
<blockquote>
<p>Tips:[aeiou]就匹配任何一个英文元音字母，[.?!]匹配标点符号(.或?或!)。</p>
</blockquote></li>
<li><p>反义：有时需要查找不属于某个能简单定义的字符类的字符。比如想查找除了数字以外，其它任意字符都行的情况，这时需要用到<strong>反义</strong></p></li>
</ul>
<table>
<thead>
<tr class="header">
<th>代码/语法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>匹配任意不是字母，数字，下划线，汉字的字符</td>
</tr>
<tr class="even">
<td></td>
<td>匹配任意不是空白符的字符</td>
</tr>
<tr class="odd">
<td></td>
<td>匹配任意非数字的字符</td>
</tr>
<tr class="even">
<td></td>
<td>匹配不是单词开头或结束的位置</td>
</tr>
<tr class="odd">
<td>[^x]</td>
<td>匹配除了x以外的任意字符</td>
</tr>
<tr class="even">
<td>[^aeiou]</td>
<td>匹配除了aeiou这几个字母以外的任意字符</td>
</tr>
</tbody>
</table>
<h1 id="分枝条件">分枝条件</h1>
<p>用|把不同的规则分隔开，如果满足其中任意一种规则都应该当成匹配:</p>
<p><strong>eg</strong>:<code>0\d&#123;2&#125;-\d&#123;8&#125;|0\d&#123;3&#125;-\d&#123;7&#125;</code>这个表达式能匹配两种以连字号分隔的电话号码：一种是三位区号，8位本地号(如010-12345678)，一种是4位区号，7位本地号(0376-2233445)。</p>
<blockquote>
<p>Tips:<strong>使用分枝条件时，要注意各个条件的顺序</strong>。如果你把它改成|-的话，那么就只会匹配5位的邮编(以及9位邮编的前5位)。原因是匹配分枝条件时，将会从左到右地测试每个条件，如果满足了某个分枝的话，就不会去再管其它的条件了。</p>
</blockquote>
<h1 id="分组">分组</h1>
<p>想要重复多个字符，可以用小括号来指定<strong>子表达式</strong>(也叫做<strong>分组</strong>)，然后你就可以指定这个子表达式的重复次数了。</p>
<p>eg:<code>(\d&#123;1,3&#125;\.)&#123;3&#125;\d&#123;1,3&#125;</code></p>
<h2 id="后向引用">后向引用</h2>
<p>默认情况下，每个分组会自动拥有一个<strong>组号</strong>，规则是：从左向右，以分组的左括号为标志，第一个出现的分组的组号为1，第二个为2，以此类推。</p>
<p><strong>后向引用</strong>用于重复搜索前面某个分组匹配的文本。例如，\1代表分组1匹配的文本。</p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 45%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="header">
<th>分类</th>
<th>代码/语法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>捕获</td>
<td>(exp)</td>
<td>匹配exp,并捕获文本到自动命名的组里</td>
</tr>
<tr class="even">
<td>(?<name>exp)</td>
<td>匹配exp,并捕获文本到名称为name的组里，也可以写成(?'name'exp)</td>
<td></td>
</tr>
<tr class="odd">
<td>(?:exp)</td>
<td>匹配exp,不捕获匹配的文本，也不给此分组分配组号</td>
<td></td>
</tr>
<tr class="even">
<td>零宽断言</td>
<td>(?=exp)</td>
<td>匹配exp前面的位置</td>
</tr>
<tr class="odd">
<td>(?&lt;=exp)</td>
<td>匹配exp后面的位置</td>
<td></td>
</tr>
<tr class="even">
<td>(?!exp)</td>
<td>匹配后面跟的不是exp的位置</td>
<td></td>
</tr>
<tr class="odd">
<td>(?&lt;!exp)</td>
<td>匹配前面不是exp的位置</td>
<td></td>
</tr>
<tr class="even">
<td>注释</td>
<td>(?#comment)</td>
<td>这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读</td>
</tr>
</tbody>
</table>
<h1 id="贪婪与懒惰">贪婪与懒惰</h1>
<ul>
<li>贪婪匹配：当正则表达式中包含能接受重复的限定符时，通常的行为是（在使整个表达式能得到匹配的前提下）匹配<strong>尽可能多</strong>的字符。以这个表达式为例：a.*b，它将会匹配最长的以a开始，以b结束的字符串。</li>
<li>懒惰匹配：<strong>尽可能少</strong>的字符。前面给出的限定符都可以被转化为懒惰匹配模式，只要在它后面加上一个问号?。这样.*?就意味着匹配任意数量的重复，但是在能使整个匹配成功的前提下使用最少的重复。</li>
</ul>
<p>懒惰限定符：</p>
<table>
<thead>
<tr class="header">
<th>代码/语法</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>*?</td>
<td>重复任意次，但尽可能少重复</td>
</tr>
<tr class="even">
<td>+?</td>
<td>重复1次或更多次，但尽可能少重复</td>
</tr>
<tr class="odd">
<td>??</td>
<td>重复0次或1次，但尽可能少重复</td>
</tr>
<tr class="even">
<td>{n,m}?</td>
<td>重复n到m次，但尽可能少重复</td>
</tr>
<tr class="odd">
<td>{n,}?</td>
<td>重复n次以上，但尽可能少重复</td>
</tr>
</tbody>
</table>
<h1 id="bonus">Bonus</h1>
<p>文章中还有零宽断言、负向零宽断言、平衡组/递归匹配等知识我并未做记录，或许得等到我真正需要用到的时候再使用吧。</p>
<h1 id="references">References</h1>
<ul>
<li><a
href="https://github.com/jackfrued/Python-100-Days/blob/master/Day01-15/12.字符串和正则表达式.md">Python-100-Days/Day01-15/12.字符串和正则表达式.md
at master · jackfrued/Python-100-Days (github.com)</a></li>
<li><a
href="https://deerchao.cn/tutorials/regex/regex.htm">正则表达式30分钟入门教程
(deerchao.cn)</a></li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>桌面美化</title>
    <url>/2023/08/10/%E6%A1%8C%E9%9D%A2%E7%BE%8E%E5%8C%96/</url>
    <content><![CDATA[<h1 id="main-takeaway">Main Takeaway</h1>
<p>美化桌面，愉悦心情</p>
<span id="more"></span>
<h1 id="任务栏美化">任务栏美化</h1>
<p>微软商店安装<strong>TranslucentTB</strong>使任务栏透明</p>
<p>任务栏设置中隐藏任务栏</p>
<h1 id="桌面美化">桌面美化</h1>
<h2 id="rainmeter">Rainmeter</h2>
<p>桌面时钟、音乐频谱、电脑监控等</p>
<h3 id="加载主题">加载主题</h3>
<p>在<a href="https://zhutix.com/">致美化 - 最专业的视觉美化交流平台
(zhutix.com)</a>的Rainmeter中下载即可</p>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230810220256059.png"
alt="image-20230810220256059" />
<figcaption aria-hidden="true">image-20230810220256059</figcaption>
</figure>
<h3 id="设置">设置</h3>
<ul>
<li>点击穿透</li>
<li>允许拖动</li>
<li>总在底层</li>
</ul>
<h3 id="参数设置">参数设置</h3>
<p>右上角可以直接该参数eg:rgb值,links等</p>
<h3 id="主题保存">主题保存</h3>
<p>自己自定义了组件，在主题中保存为新主题即可。</p>
<h2 id="鼠标指针">鼠标指针</h2>
<p>在致美化下载鼠标指针样式，解压后找到后缀.inf的文件右键安装</p>
<p>在设置——个性化——主题——鼠标光标中切换方案即可</p>
<h1 id="开始菜单美化">开始菜单美化</h1>
<p>主要使用Start11给“开始”添加图片</p>
<h1 id="wallpaper-engine">Wallpaper Engine</h1>
<ul>
<li><p>性能：开机时启动（设为最高优先级）；其他应用最大化时改为停止（释放内存）</p></li>
<li><p>常规：打开覆盖壁纸图像+覆盖锁屏图像</p></li>
<li><p>可以创建文件夹</p></li>
<li><p>壁纸音量调为0；跟随鼠标晃动的壁纸：鼠标视差关闭即可</p></li>
<li><p>彩蛋：设置-&gt;关于（英文大写输入）上上下下左右左右BA回车，获得星空主题</p></li>
</ul>
<h1 id="结果展示">结果展示</h1>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230810235722677.png"
alt="image-20230810235722677" />
<figcaption aria-hidden="true">image-20230810235722677</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230810235744577.png"
alt="image-20230810235744577" />
<figcaption aria-hidden="true">image-20230810235744577</figcaption>
</figure>
<figure>
<img
src="https://raw.githubusercontent.com/Immortal-Fates/figure_Bed/main/blog/image-20230815103141441.png"
alt="image-20230815103141441" />
<figcaption aria-hidden="true">image-20230815103141441</figcaption>
</figure>
<h1 id="references">References</h1>
<ul>
<li><p>【【Wallpaper
Engine】迄今为止最详细的使用教程】https://www.bilibili.com/video/BV1dX4y1E7vF?vd_source=93bb338120537438ee9180881deab9c1</p></li>
<li><p><a
href="https://zhuanlan.zhihu.com/p/563088705">程序员教你十分钟做出炫酷桌面
- 知乎 (zhihu.com)</a></p></li>
<li><p>【雨滴桌面教程|深度打造你的自定义桌面（Rainmeter教程）】https://www.bilibili.com/video/BV1N5411x7KP?vd_source=93bb338120537438ee9180881deab9c1</p></li>
</ul>
]]></content>
      <categories>
        <category>奇技淫巧</category>
      </categories>
      <tags>
        <tag>奇技淫巧</tag>
      </tags>
  </entry>
</search>
